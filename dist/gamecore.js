;(function(e,t,n){function i(n,s){if(!t[n]){if(!e[n]){var o=typeof require=="function"&&require;if(!s&&o)return o(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=t[n]={exports:{}};e[n][0].call(u.exports,function(t){var r=e[n][1][t];return i(r?r:t)},u,u.exports)}return t[n].exports}var r=typeof require=="function"&&require;for(var s=0;s<n.length;s++)i(n[s]);return i})({1:[function(require,module,exports){
(function(){// Generated by CoffeeScript 1.6.3
var GameCore, Stage, UUID, context2d, support;

context2d = require("./core/context/2d");

support = require("./core/support");

UUID = require("./math/uuid");

Stage = require("./ui/stage");

/*
Game Core base class

@property {Stage} stage
@property {Boolean} fullScreen
@property {Boolean} paused
@property {Context} context
@property {Int} width
@property {Int} heigth
@property {DOMElement} renderer

@example How to create an game core 
    gc = new GameCore() # Creating core
    gc.renderer = document.body # Appends new canvas element to documents body

@example Making canvas full-sized
    gc = new GameCore() # Creating core
    gc.fullScreen = true
*/


GameCore = (function() {
  /*
  GameCore instancec archive
  */

  GameCore.cores = {};

  /*
  Start your application from here.
  
  @param {Object} options
  */


  function GameCore(options) {
    var error, _i, _len, _ref;
    this.options = options != null ? options : {};
    /*
    In the first case we need to generate id for new instance, if it not
     present in options.
    */

    this.id = this.options.id || UUID.generateUniqueId();
    /*
    Checing for runtime errors
    */

    if (support.ERRORS) {
      _ref = support.ERRORS;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        error = _ref[_i];
        throw error;
      }
    }
    /*
    Setting up a canvas.
    If canvas doesn't present in options then create it.
    */

    this.options.canvas = this.options.canvas || this.createCanvas();
    /*
    Registrating GameCore instance in canvas ang GameCore global.
    */

    this.options.canvas.core = this;
    GameCore.cores[this.id] = this;
    /*
    Setting up framerate
    */

    this.setFramerate();
    /*
    Render tick hooks
    */

    this._render_tick_hooks = {};
    /*
    Stages map
    */

    this._stages = {};
    Object.defineProperty(this, "stage", {
      get: function() {
        var stage;
        if (this._current_stage_id) {
          return this._stages[this._current_stage_id];
        } else {
          stage = new Stage;
          this._current_stage_id = stage.id;
          this.addStage(stage);
          return stage;
        }
      },
      set: function(stage) {
        if (!this._stages[stage.id]) {
          this.addStage(stage);
        }
        return this._current_stage_id = stage.id;
      }
    });
    /*
    */

    Object.defineProperty(this, "fullScreen", {
      get: function() {
        return this._in_the_fullscreen_now;
      },
      set: function(b) {
        if (b === true) {
          window.addEventListener("resize", this._fullScreen_resizer);
          this._in_the_fullscreen_now = true;
          return this.setSize(document.width, document.height);
        } else {
          window.removeEventListener("resize", this._fullScreen_resizer);
          this._in_the_fullscreen_now = false;
          return this.setSize(this.options.width, this.options.height);
        }
      }
    });
    this.fullScreen = this.options.fullScreen;
    /*
    */

    Object.defineProperty(this, "width", {
      get: function() {
        return this.options.canvas.width;
      },
      set: function(width) {
        this.options.canvas.width = width;
        return this.options.canvas.style.width = width + "px";
      }
    });
    /*
    */

    Object.defineProperty(this, "height", {
      get: function() {
        return this.options.canvas.height;
      },
      set: function(height) {
        this.options.canvas.height = height;
        return this.options.canvas.style.height = height + "px";
      }
    });
    if (this.fullScreen) {
      this.options.width = window.width;
      this.options.height = window.height;
    }
    this.setSize(this.options.width, this.options.height);
    /*
    Context element.
    Currently support only Context2d
    */

    Object.defineProperty(this, "context", {
      get: function() {
        if (!this._context) {
          this._context = new context2d({
            canvas: this.options.canvas
          });
        }
        return this._context;
      }
    });
    /*
    */

    Object.defineProperty(this, "paused", {
      get: function() {
        return this._paused || false;
      },
      set: function(paused) {
        return this._paused = paused ? true : false;
      }
    });
    /*
    Renderer element.
    */

    Object.defineProperty(this, "renderer", {
      get: function() {
        return this._parent_node || 'undefined';
      },
      set: function(node) {
        if (!node.tagName) {
          throw Error("Can render only on document elements");
        }
        node.appendChild(this.options.canvas);
        return this._parent_node = node;
      }
    });
    this._onEnterFrame();
  }

  /*
  */


  GameCore.prototype.addStage = function(stage, setCurrent) {
    if (setCurrent == null) {
      setCurrent = false;
    }
    this._stages[stage.id] = stage;
    if (setCurrent) {
      return this.stage = stage.id;
    }
  };

  /*
  Switch pause state
  */


  GameCore.prototype.pause = function() {
    return this.paused = !this.paused;
  };

  /*
  Set's framerate. Not usable at the moment...
  @param {Int} framerate
  @method setFramerate
  */


  GameCore.prototype.setFramerate = function(framerate) {
    if (framerate == null) {
      framerate = 60;
    }
    return window._FPS = framerate;
  };

  /*
  Set size of an canvas element.
  @param {Int} width
  @param {Int} height
  @method setSize
  */


  GameCore.prototype.setSize = function(width, height) {
    if (width == null) {
      width = 400;
    }
    if (height == null) {
      height = 300;
    }
    this.width = width;
    return this.height = height;
  };

  GameCore.prototype._fullScreen_resizer = function() {
    var gci;
    gci = this;
    return function(e) {
      return gci.setSize(window.width, window.height);
    };
  };

  /*
  Creates a canvas element
  @method createCanvas
  */


  GameCore.prototype.createCanvas = function() {
    var canvas;
    canvas = document.createElement('canvas');
    return canvas;
  };

  /*
  Add render tick hook
  
  @method addRenderTickHook
  @param {String} name
  @param {Function} functor
  
  @note Render tick hooks calls after stage was rendered
  */


  GameCore.prototype.addRenderTickHook = function(name, functor) {
    return this._render_tick_hooks[name] = functor;
  };

  /*
  Removes render tick hook
  @method removeRenderTickHook
  @param {String} name
  */


  GameCore.prototype.removeRenderTickHook = function(name) {
    return delete this._render_tick_hooks[name];
  };

  /*
  Call window's requestAnimationFrame.
  @method _onEnterFrame
  */


  GameCore.prototype._onEnterFrame = function(gci) {
    if (gci == null) {
      gci = this;
    }
    if (!this.paused) {
      gci._render(gci.stage);
    }
    return window.onEnterFrame(function() {
      return gci._onEnterFrame(gci);
    });
  };

  GameCore.prototype._render = function() {
    var hook, name, _ref, _results;
    this.context.render([this.stage]);
    _ref = this._render_tick_hooks;
    _results = [];
    for (name in _ref) {
      hook = _ref[name];
      _results.push(hook.call());
    }
    return _results;
  };

  return GameCore;

})();

window.GameCore = window.GameCore || GameCore;

GameCore.exports = {
  UI: require("./ui/exports"),
  Math: require("./math/exports"),
  Utils: require("./utils/exports")
};

module.exports = GameCore;

/*
//@ sourceMappingURL=core.map
*/

})()
},{"./core/context/2d":2,"./core/support":3,"./math/exports":4,"./math/uuid":7,"./ui/exports":10,"./ui/stage":14,"./utils/exports":18}],2:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var Context2d;

Context2d = (function() {
  function Context2d(options) {
    this.setCanvas(options.canvas);
  }

  Context2d.prototype.setCanvas = function(canvas) {
    this.canvas = canvas;
    this.ctx = this.canvas.getContext('2d');
    return this;
  };

  Context2d.prototype.clear = function() {
    this.ctx.clearRect(0, 0, this.ctx.canvas.width, this.ctx.canvas.height);
    return this;
  };

  Context2d.prototype.render = function(layers) {
    var layer, _i, _len, _results;
    if (layers == null) {
      layers = [];
    }
    this.clear();
    _results = [];
    for (_i = 0, _len = layers.length; _i < _len; _i++) {
      layer = layers[_i];
      _results.push(layer.render(this.ctx));
    }
    return _results;
  };

  return Context2d;

})();

module.exports = Context2d;

/*
//@ sourceMappingURL=2d.map
*/

},{}],3:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var ERRORS, browserPrefix, prefix, userAgent;

prefix = function(name) {
  if (browserPrefix !== "") {
    name = name.charAt(0).toUpperCase() + name.slice(1);
  }
  return browserPrefix + name;
};

userAgent = navigator.userAgent;

browserPrefix = (userAgent.match(/opera/i) && "o") || (userAgent.match(/webkit/i) && "webkit") || (userAgent.match(/msie/i) && "ms") || (userAgent.match(/mozilla/i) && "moz") || "";

Function.prototype.property = function(prop, desc) {
  return Object.defineProperty(this.prototype, prop, desc);
};

if (typeof window.addEventListener !== "function") {
  HTMLElement.prototype.addEventListener = function(type, callback, useCapture) {
    return attachEvent("on" + type, callback);
  };
}

/*
window.onEnterFrame
*/


window.onEnterFrame = (function() {
  return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function(callback) {
    return window.setTimeout(callback, 1000 / window._FPS);
  };
})();

/*
Checking for ability to work
*/


ERRORS = [];

if (!Object.defineProperty) {
  ERRORS.append("Browser doesnt support Object.defineProperty.");
}

if (!document.createElement("canvas").getContext) {
  ERRORS.append("Browser doesnt support <canvas> and the Canvas2D API.");
}

module.exports = {
  /*
  */

  ERRORS: ERRORS,
  /*
  Browser's user-agent string
  @attribute userAgent
  @type {String}
  @static
  @readonly
  */

  userAgent: userAgent,
  /*
  Device supports touch events?
  @attribute touch
  @type {Boolean}
  @static
  @readonly
  */

  touch: "ontouchstart" in window,
  /*
  Device supports Retina Display?
  @attribute retina
  @type {Boolean}
  @static
  @readonly
  */

  retina: window.devicePixelRatio > 1 || window.matchMedia("(min-resolution: 1.1dppx)").matches,
  imageSmoothingEnabled: prefix("imageSmoothingEnabled")
};

/*
//@ sourceMappingURL=support.map
*/

},{}],4:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
module.exports = {
  Matrix2D: require("./matrix2d"),
  Vector2D: require("./vector2d"),
  UUID: require("./uuid"),
  Math: require("./math")
};

/*
//@ sourceMappingURL=exports.map
*/

},{"./math":5,"./matrix2d":6,"./uuid":7,"./vector2d":8}],5:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
/*
Mathematical functions

@note GameCore.exports.Math.Math

@see http://docs.closure-library.googlecode.com/git-history/418ef20b29e8f3ebb5121266ec7206ae6943d28d/closure_goog_math_math.js.source.html
*/

var Mathematics;

Mathematics = (function() {
  function Mathematics() {}

  /*
  Clamping a number into a limits
  
  @method clamp
  @param {Number} num
  @param {Number} min
  @param {Number} max
  @return {Number}
  */


  Mathematics.clamp = function(num, min, max) {
    return Math.min(Math.max(num, min), max);
  };

  /*
  Alias to @clamp(num, 0, 1)
  
  @method clamp01
  @param {Number} num
  @return {Number}
  */


  Mathematics.clamp01 = function(num) {
    return this.clamp(num, 0, 1);
  };

  /*
  Returns a random integer greater than or equal to $min and less than $max.
  
  @param {Number} a  The lower bound for the random integer inclusive (default=0).
  @param {Number} a  The upper bound for the random integer exlusive (default=1000).
  @return {Number} A random integer N such that $min <= N < $max.
  */


  Mathematics.randomInt = function(min, max) {
    if (min == null) {
      min = 0;
    }
    if (max == null) {
      max = 100;
    }
    return Math.floor(min + Math.random() * (max - min));
  };

  /*
  The % operator in JavaScript returns the remainder of a / b, but differs from
  some other languages in that the result will have the same sign as the
  dividend. For example, -1 % 8 == -1, whereas in some other languages
  (such as Python) the result would be 7. This function emulates the more
  correct modulo behavior, which is useful for certain applications such as
  calculating an offset index in a circular list.
   
  @param {number} a The dividend.
  @param {number} b The divisor.
  @return {number} a % b where the result is between 0 and b (either 0 <= x < b
    or b < x <= 0, depending on the sign of b).
  */


  Mathematics.modulo = function(a, b) {
    var r;
    r = a % b;
    if (r * b < 0) {
      return r + b;
    } else {
      return r;
    }
  };

  /*
  Performs linear interpolation between values a and b. Returns the value
  between a and b proportional to x (when x is between 0 and 1. When x is
  outside this range, the return value is a linear extrapolation).
  
  @param {number} a A number.
  @param {number} b A number.
  @param {number} x The proportion between a and b.
  @return {number} The interpolated value between a and b.
  */


  Mathematics.lerp = function(a, b, x) {
    return a + x * (b - a);
  };

  /*
  Tests whether the two values are equal to each other, within a certain
  tolerance to adjust for floating pount errors.
  
  @param {Number} a A number.
  @param {Number} b A number.
  @param {Number=} opt_tolerance Optional tolerance range.
      Defaults to 0.000001. If specified, should be greater than 0.
  @return {Boolean} Whether $a and $b are nearly equal.
  */


  Mathematics.nearlyEquals = function(a, b, opt_tolerance) {
    if (opt_tolerance == null) {
      opt_tolerance = 0.000001;
    }
    return Math.abs(a - b) <= opt_tolerance;
  };

  return Mathematics;

})();

module.exports = Mathematics;

/*
//@ sourceMappingURL=math.map
*/

},{}],6:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
/*
2D Matrix manipulations

@note GameCore.exports.Math.Matrix2D
*/

var Matrix2D;

Matrix2D = (function() {
  /*
  Based on [EaselJS](https://github.com/CreateJS/EaselJS/) Matrix2D implementation.
  
  @class Matrix2D
  @constructor
  
  @param {Number} m11
  @param {Number} m12
  @param {Number} m21
  @param {Number} m22
  @param {Number} dx
  @param {Number} dy
  */

  function Matrix2D(m11, m12, m21, m22, dx, dy) {
    if (m11 !== null) {
      this.m11 = m11;
    }
    this.m12 = m12 || 0;
    this.m21 = m21 || 0;
    if (m22 !== null) {
      this.m22 = m22;
    }
    this.dx = dx || 0;
    this.dy = dy || 0;
  }

  /*
  Generates matrix properties from the specified display object transform properties, and appends them with this matrix.
  For example, you can use this to generate m11 matrix from m11 display object: var mtx = new Matrix2D();
  mtx.appendTransform(o.x, o.y, o.scaleX, o.scaleY, o.rotation);
  @method appendTransform
  @param {Number} x
  @param {Number} y
  @param {Number} scaleX
  @param {Number} scaleY
  @param {Number} rotation
  @param {Number} skewX
  @param {Number} skewY
  @param {Number} pivotX Optional.
  @param {Number} pivotY Optional.
  @return {Matrix2D} This matrix. Useful for chaining method calls.
  */


  Matrix2D.prototype.appendTransform = function(x, y, scaleX, scaleY, rotation, skewX, skewY, pivotX, pivotY) {
    var cos, r, sin;
    cos = void 0;
    sin = void 0;
    r = void 0;
    if (rotation % 360) {
      r = rotation * Matrix2D.DEG_TO_RAD;
      cos = Math.cos(r);
      sin = Math.sin(r);
    } else {
      cos = 1;
      sin = 0;
    }
    if (skewX || skewY) {
      skewX *= Matrix2D.DEG_TO_RAD;
      skewY *= Matrix2D.DEG_TO_RAD;
      this.append(Math.cos(skewY), Math.sin(skewY), -Math.sin(skewX), Math.cos(skewX), x, y);
      this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, 0, 0);
    } else {
      this.append(cos * scaleX, sin * scaleX, -sin * scaleY, cos * scaleY, x, y);
    }
    if (pivotX || pivotY) {
      this.dx -= pivotX * this.m11 + pivotY * this.m21;
      this.dy -= pivotX * this.m12 + pivotY * this.m22;
    }
    return this;
  };

  /*
  Appends the specified matrix properties with this matrix. All parameters are required.
  @method append
  @param {Number} m11
  @param {Number} m12
  @param {Number} m21
  @param {Number} m22
  @param {Number} dx
  @param {Number} dy
  @return {Matrix2D} This matrix. Useful for chaining method calls.
  */


  Matrix2D.prototype.append = function(m11, m12, m21, m22, dx, dy) {
    var a1, b1, c1, d1;
    a1 = this.m11;
    b1 = this.m12;
    c1 = this.m21;
    d1 = this.m22;
    this.m11 = m11 * a1 + m12 * c1;
    this.m12 = m11 * b1 + m12 * d1;
    this.m21 = m21 * a1 + m22 * c1;
    this.m22 = m21 * b1 + m22 * d1;
    this.dx = dx * a1 + dy * c1 + this.dx;
    this.dy = dx * b1 + dy * d1 + this.dy;
    return this;
  };

  /*
  Inverts the matrix, causing it to perform the opposite transformation.
  @method invert
  @return {Matrix2D} this
  */


  Matrix2D.prototype.invert = function() {
    var a1, b1, c1, d1, n, tx1;
    a1 = this.m11;
    b1 = this.m12;
    c1 = this.m21;
    d1 = this.m22;
    tx1 = this.dx;
    n = a1 * d1 - b1 * c1;
    this.m11 = d1 / n;
    this.m12 = -b1 / n;
    this.m21 = -c1 / n;
    this.m22 = a1 / n;
    this.dx = (c1 * this.dy - d1 * tx1) / n;
    this.dy = -(a1 * this.dy - b1 * tx1) / n;
    return this;
  };

  /*
  Clone Matrix2D instance
  @return {Matrix2D}
  */


  Matrix2D.prototype.clone = function() {
    return new Matrix2D(this.m11, this.m12, this.m21, this.m22, this.dx, this.dy);
  };

  /*
  Reset matrix to it's identity
  @return {Matrix2D} this
  */


  Matrix2D.prototype.identity = function() {
    this.m11 = this.m22 = 1;
    this.m12 = this.m21 = this.dx = this.dy = 0;
    return this;
  };

  /*           
  Multiplier for converting degrees to radians. Used internally by Matrix2D.
  
  @attribute DEG_TO_RAD
  @static
  @readonly
  @return {Number}
  */


  Matrix2D.DEG_TO_RAD = Math.PI / 180;

  Matrix2D.identity = new Matrix2D(1, 0, 0, 1, 0, 0);

  return Matrix2D;

})();

module.exports = Matrix2D;

/*
//@ sourceMappingURL=matrix2d.map
*/

},{}],7:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
/*
Unique ID generator

@note GameCore.exports.Math.UUID
*/

var UUID;

UUID = (function() {
  function UUID() {}

  /*
  @method generateUniqueId
  @return {String}
  */


  UUID.generateUniqueId = function() {
    return "gc-" + this.uuid();
  };

  /*
  @method uuid
  @return {String}
  */


  UUID.uuid = function() {
    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
      var r, v;
      r = Math.random() * 16 | 0;
      v = c === 'x' ? r : r & 0x3 | 0x8;
      return v.toString(16);
    });
  };

  return UUID;

})();

module.exports = UUID;

/*
//@ sourceMappingURL=uuid.map
*/

},{}],8:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
/*
2D Vector manipulations

@note GameCore.exports.Math.Vector2D
*/

var Vector2d;

Vector2d = (function() {
  function Vector2d(x, y) {
    this.x = x != null ? x : 0;
    this.y = y != null ? y : 0;
    /*
    Get the magnitude of this vector
    @attribute length
    @readonly
    */

    Object.defineProperty(this, "length", {
      get: function() {
        return Math.sqrt((this.x * this.x) + (this.y * this.y));
      },
      configurable: true
    });
    /*
    Get this vector with a magnitude of 1.
    @attribute normalized
    @readonly
    */

    Object.defineProperty(this, "normalized", {
      get: function() {
        var magnitude;
        magnitude = this.length;
        return new Vector2d(this.x / magnitude, this.y / magnitude);
      },
      configurable: true
    });
  }

  /*
  @method set
  @param {Number} x
  @param {Number} y
  @return {Vector2d}
  */


  Vector2d.prototype.set = function(x, y) {
    this.x = x;
    this.y = y;
  };

  /*
  @method sum
  @param {Vector2d} vector2d
  @return {Vector2d}
  */


  Vector2d.prototype.subtract = function(vector2d) {
    this.x -= vector2d.x;
    return this.y -= vector2d.y;
  };

  /*
  @method sum
  @param {Vector2d} vector2d
  @return {Vector2d}
  */


  Vector2d.prototype.sum = function(vector2d) {
    this.x += vector2d.x;
    return this.y += vector2d.y;
  };

  /*
  @method scale
  @param {Number} x (or x y)
  @param {Number} y
  @return {Vector2d}
  */


  Vector2d.prototype.scale = function(x, y) {
    this.x *= x;
    return this.y *= y || x;
  };

  /*
  @method clone
  @return {Vector2d}
  */


  Vector2d.prototype.clone = function() {
    return new Vector2d(this.x, this.y);
  };

  /*
  Return unit vector
  @return {Vector2d}
  */


  Vector2d.prototype.unit = function() {
    return new Vector2d(Math.cos(this.x), Math.sin(this.y));
  };

  /*
  Normalize this vector
  @return {Vector2d}
  */


  Vector2d.prototype.normalize = function() {
    var normal;
    normal = this.normalized;
    this.x = normal.x;
    return this.y = normal.y;
  };

  /*
  Get the distance between this vector and the argument vector
  @param {Vector2d} vector
  @return {Number}
  */


  Vector2d.distance = function(v1, v2) {
    var xdiff, ydiff;
    xdiff = v1.x - v2.x;
    ydiff = v1.y - v2.y;
    return Math.sqrt(xdiff * xdiff + ydiff * ydiff);
  };

  /*
  @method toString
  @return {String}
  */


  Vector2d.prototype.toString = function() {
    return "#<Vector2d @x=" + this.x + ", @y=" + this.y + ">";
  };

  Vector2d.LEFT = new Vector2d(-1, 0);

  Vector2d.RIGHT = new Vector2d(1, 0);

  Vector2d.TOP = new Vector2d(0, -1);

  Vector2d.BOTTOM = new Vector2d(0, 1);

  return Vector2d;

})();

module.exports = Vector2d;

/*
//@ sourceMappingURL=vector2d.map
*/

},{}],9:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var Container, Widget,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Widget = require("./widget");

/*
Base widgets container
@note GameCore.exports.ui.Container
*/


Container = (function(_super) {
  __extends(Container, _super);

  function Container(options) {
    if (options == null) {
      options = {};
    }
    Container.__super__.constructor.call(this, options);
    this.children = {};
  }

  Container.prototype.addChild = function(child) {
    if (child.parent === !this) {
      return child.parent = this;
    } else {
      return this.children[child.id] = child;
    }
  };

  Container.prototype.render = function(ctx) {
    var child, cid, _ref, _results;
    Container.__super__.render.call(this, ctx);
    _ref = this.children;
    _results = [];
    for (cid in _ref) {
      child = _ref[cid];
      _results.push(child.render(ctx));
    }
    return _results;
  };

  return Container;

})(Widget);

module.exports = Container;

/*
//@ sourceMappingURL=container.map
*/

},{"./widget":16}],10:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
module.exports = {
  Widget: require("./widget"),
  Stage: require("./stage"),
  Container: require("./container"),
  Text: require("./text"),
  geometry: require("./geometry/exports")
};

/*
//@ sourceMappingURL=exports.map
*/

},{"./container":9,"./geometry/exports":12,"./stage":14,"./text":15,"./widget":16}],11:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var Circle, Widget,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Widget = require("../widget");

Circle = (function(_super) {
  __extends(Circle, _super);

  function Circle(options) {
    if (options == null) {
      options = {};
    }
    Circle.__super__.constructor.call(this, options);
  }

  return Circle;

})(Widget);

/*
//@ sourceMappingURL=circle.map
*/

},{"../widget":16}],12:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
module.exports = {
  Circle: require("./circle"),
  Rect: require("./rect")
};

/*
//@ sourceMappingURL=exports.map
*/

},{"./circle":11,"./rect":13}],13:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var Rect, Widget,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Widget = require("../widget");

Rect = (function(_super) {
  __extends(Rect, _super);

  function Rect(options) {
    if (options == null) {
      options = {};
    }
    Rect.__super__.constructor.call(this, options);
  }

  return Rect;

})(Widget);

/*
//@ sourceMappingURL=rect.map
*/

},{"../widget":16}],14:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var Stage, container,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

container = require("../ui/container");

/*
Stage container
@note GameCore.exports.ui.Stage
*/


Stage = (function(_super) {
  __extends(Stage, _super);

  function Stage(options) {
    if (options == null) {
      options = {};
    }
    Stage.__super__.constructor.call(this, options);
    this.x = 0;
    this.y = 0;
  }

  Stage.prototype.render = function(ctx) {
    this.width = ctx.canvas.width;
    this.height = ctx.canvas.height;
    return Stage.__super__.render.call(this, ctx);
  };

  return Stage;

})(container);

module.exports = Stage;

/*
//@ sourceMappingURL=stage.map
*/

},{"../ui/container":9}],15:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var BASELINE, Color, DEFAULT_ALIGN, DEFAULT_BASELINE, DEFAULT_COLOR, DEFAULT_FONT, Text, Widget,
  __hasProp = {}.hasOwnProperty,
  __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };

Widget = require("./widget");

Color = require("../utils/color");

/*
Object.defineProperty this, BASELINE
@static
*/


BASELINE = {
  /*
  Object.defineProperty this, BASELINE.TOP
  @type {String}
  @static
  */

  TOP: "top",
  /*
  Object.defineProperty this, BASELINE.HANGING
  @type {String}
  @static
  */

  HANGING: "hanging",
  /*
  Object.defineProperty this, BASELINE.MIDDLE
  @type {String}
  @static
  */

  MIDDLE: "middle",
  /*
  Object.defineProperty this, BASELINE.ALPHABETIC
  @type {String}
  @static
  */

  ALPHABETIC: "alphabetic",
  /*
  Object.defineProperty this, BASELINE.IDEOGRAPHIC
  @type {String}
  @static
  */

  IDEOGRAPHIC: "ideographic",
  /*
  Object.defineProperty this, BASELINE.BOTTOM
  @type {String}
  @static
  */

  BOTTOM: "bottom"
};

DEFAULT_FONT = "Normal 12px Verdana";

DEFAULT_COLOR = new Color("purple");

DEFAULT_ALIGN = "left";

DEFAULT_BASELINE = BASELINE.TOP;

/*
Base Text widget
@note GameCore.exports.ui.Text
*/


Text = (function(_super) {
  __extends(Text, _super);

  /*
  @class Text
  @extends DisplayObject
  
  @param {Object} options any attribute may be initialized by option
  @param {String} [options.text] default - ""
  @param {String} [options.font] default - "Normal 12px Verdana"
  @param {String} [options.align] default - "left"
  @param {String} [options.baseline] default - Joy.Text.BASELINE.TOP
  @param {String} [options.color] default - #000000
  
  @constructor
  */


  function Text(options) {
    if (options == null) {
      options = {};
    }
    Text.__super__.constructor.call(this, options);
    /*
    Text to be displayed
    @attribute text
    @default ""
    @type {String}
    */

    this.text = options.text || "";
    /*
    Font family and size
    @attribute font
    @default "Normal 12px Verdana"
    @type {String}
    */

    this.font = options.font || DEFAULT_FONT;
    /*
    Text horizontal alignment
    @attribute align
    @default "left"
    @type {String}
    */

    this.align = options.align || DEFAULT_ALIGN;
    /*
    Text vertical baseline
    @attribute baseline
    @default Joy.Text.BASELINE.TOP
    @type {String}
    */

    this.baseline = options.baseline || DEFAULT_BASELINE;
    /*
    Color of the text
    @attribute color
    @default "#000000"
    @type {String, Color}
    */

    Object.defineProperty(this, "color", {
      get: function() {
        if (!this._color) {
          this.color = options.color || DEFAULT_COLOR;
        }
        return this._color;
      },
      set: function(color) {
        return this._color = color.toString();
      },
      configurable: true
    });
    if (options.stroke) {
      this.useStroke();
    } else {
      this.useFill();
    }
    Object.defineProperty(this, "width", {
      get: function() {
        if (this.__measure) {
          return this.__measure.width;
        } else {
          return 0;
        }
      }
    });
    Object.defineProperty(this, "height", {
      get: function() {
        if (this.__measure) {
          return this.__measure.height;
        } else {
          return 0;
        }
      }
    });
  }

  /*
  @method useStroke
  */


  Text.prototype.useStroke = function() {
    this.stroke = true;
    this.fillMethod = "strokeText";
    return this.styleMethod = "strokeStyle";
  };

  /*
  @method useFill
  */


  Text.prototype.useFill = function() {
    this.stroke = false;
    this.fillMethod = "fillText";
    return this.styleMethod = "fillStyle";
  };

  Text.prototype._render = function(ctx) {
    ctx.font = this.font;
    ctx.textAlign = this.align;
    ctx.textBaseline = this.baseline;
    ctx[this.styleMethod] = this.color;
    ctx[this.fillMethod](this.text, 0, 0);
    return this.getMeasure(ctx);
  };

  /*
  @method getMeasure
  @return {TextMetrics} text metrics
  */


  Text.prototype.getMeasure = function(ctx) {
    var m;
    this.__measure = {};
    m = Text.MeasureText(this.text, this.font);
    this.__measure.width = m[0];
    return this.__measure.height = m[1];
  };

  Text.BASELINE = BASELINE;

  Text.MeasureText = function(text, font) {
    var div, size, str;
    str = text + ":" + font;
    if (typeof this.__measuretext_cache__ === "object" && this.__measuretext_cache__[str]) {
      return this.__measuretext_cache__[str];
    }
    div = document.createElement("DIV");
    div.innerHTML = text;
    div.style.position = "absolute";
    div.style.top = "-100px";
    div.style.left = "-100px";
    div.style.font = font;
    document.body.appendChild(div);
    size = [div.offsetWidth, div.offsetHeight];
    document.body.removeChild(div);
    if (typeof this.__measuretext_cache__ !== "object") {
      this.__measuretext_cache__ = {};
    }
    this.__measuretext_cache__[str] = size;
    return size;
  };

  return Text;

})(Widget);

module.exports = Text;

/*
//@ sourceMappingURL=text.map
*/

},{"../utils/color":17,"./widget":16}],16:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
var Color, Core, Matrix2d, Support, UUID, Vector2d, Widget;

Core = require("../core");

UUID = require("../math/uuid");

Vector2d = require("../math/vector2d");

Matrix2d = require("../math/matrix2d");

Support = require("../core/support");

Color = require("../utils/color");

/*
Base renderable element

@note GameCore.exports.ui.Widget
*/


Widget = (function() {
  function Widget(options) {
    if (options == null) {
      options = {};
    }
    this.id = UUID.generateUniqueId();
    /*
    @attribute pivot
    @type {Vector2d}
    @default 0,0
    */

    this.pivot = options.pivot || new Vector2d(options.pivotX || 0, options.pivotY || 0);
    /*
    @attribute skewX
    @type {Number}
    @default 0
    */

    this.skew = options.skew || new Vector2d(options.skewX || 0, options.skewY || 0);
    /*
    @attribute scale
    @type {Vector2d}
    @default 1,1
    */

    this.scale = options.scale || new Vector2d(options.scaleX || 1, options.scaleY || 1);
    /*
    @attribute alpha
    @type {Number}
    @default 1
    */

    this.alpha = (typeof options.alpha === "undefined" ? 1 : options.alpha);
    /*
    @attribute rotation
    @type {Number}
    @default 0
    */

    this.rotation = options.rotation || 0;
    /*
    @attribute smooth
    @type {Boolean}
    @default false
    */

    this.smooth = (typeof options.smooth === "undefined" ? true : options.smooth);
    this._matrix = Matrix2d.identity.clone();
    Object.defineProperty(this, "position", {
      get: function() {
        if (!this._position) {
          this._position = new Vector2d(0, 0);
        }
        return this._position;
      },
      set: function(vector) {
        return this._position = vector.clone();
      }
    });
    Object.defineProperty(this, "x", {
      get: function() {
        return this.position.x || 0;
      },
      set: function(x) {
        return this.position.x = x;
      }
    });
    if (options.x) {
      this.x = options.x;
    }
    Object.defineProperty(this, "y", {
      get: function() {
        return this.position.y || 0;
      },
      set: function(y) {
        return this.position.y = y;
      }
    });
    if (options.y) {
      this.y = options.y;
    }
    Object.defineProperty(this, "width", {
      get: function() {
        return this._width || 10;
      },
      set: function(w) {
        return this._width = w;
      },
      configurable: true
    });
    if (options.width) {
      this.width = options.width;
    }
    Object.defineProperty(this, "height", {
      get: function() {
        return this._height || 10;
      },
      set: function(h) {
        return this._height = h;
      },
      configurable: true
    });
    if (options.height) {
      this.height = options.height;
    }
    Object.defineProperty(this, "parent", {
      get: function() {
        return this._parent || 'undefined';
      },
      set: function(parent) {
        this._parent = parent;
        return this._parent.addChild(this);
      }
    });
    if (options.parent) {
      this.parent = options.parent;
    }
    Object.defineProperty(this, "drawBoundingBox", {
      get: function() {
        return this._bounding_box || false;
      },
      set: function(boool) {
        return this._bounding_box = boool || false;
      }
    });
    if (options.bbox) {
      this.drawBoundingBox = options.bbox;
    }
  }

  Widget.prototype.render = function(ctx) {
    var bit, mtx;
    bit = {
      "false": -1,
      "true": 1
    };
    mtx = this._matrix.clone().identity().appendTransform(this.position.x + this.width * (this.flipX + 0), this.position.y + this.height * (this.flipY + 0), this.scale.x * bit[!this.flipX], this.scale.y * bit[!this.flipY], this.rotation, this.skew.x, this.skew.y, this.pivot.x, this.pivot.y);
    ctx.beginPath();
    ctx.scale(this.scale.x, this.scale.y);
    ctx.translate(this.position.x, this.position.y);
    ctx.transform(mtx.m11, mtx.m12, mtx.m21, mtx.m22, mtx.dx, mtx.dy);
    ctx.setAlpha(this.alpha);
    if (this.compositeOperation) {
      ctx.globalCompositeOperation = this.compositeOperation;
    }
    ctx[Support.imageSmoothingEnabled] = this.smooth;
    if (this.drawBoundingBox === true) {
      ctx.setAlpha(1);
      ctx.rect(0, 0, this.width, this.height);
    }
    ctx.setAlpha(this.alpha);
    if (this._render) {
      this._render(ctx);
    }
    ctx.scale(1 / this.scale.x, 1 / this.scale.y);
    ctx.translate(-this.position.x, -this.position.y);
    return ctx.closePath();
  };

  return Widget;

})();

module.exports = Widget;

/*
//@ sourceMappingURL=widget.map
*/

},{"../core":1,"../core/support":3,"../math/matrix2d":6,"../math/uuid":7,"../math/vector2d":8,"../utils/color":17}],17:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
/*
Inspired by TinyColor
@see https://github.com/bgrins/TinyColor
*/

var COLOR_NAMES, COLOR_NAMES_F, CSS_INTEGER, CSS_NUMBER, CSS_UNIT, Color, Mathmetics, PERMISSIVE_MATCH3, PERMISSIVE_MATCH4, bound01, convertToPercentage, flip, isOnePointZero, isPercentage, matchers, pad2, parseHex, stringInputToObject, trimLeft, trimRight;

Mathmetics = require("../math/math");

/*
*/


COLOR_NAMES = {
  aliceblue: "f0f8ff",
  antiquewhite: "faebd7",
  aqua: "0ff",
  aquamarine: "7fffd4",
  azure: "f0ffff",
  beige: "f5f5dc",
  bisque: "ffe4c4",
  black: "000",
  blanchedalmond: "ffebcd",
  blue: "00f",
  blueviolet: "8a2be2",
  brown: "a52a2a",
  burlywood: "deb887",
  burntsienna: "ea7e5d",
  cadetblue: "5f9ea0",
  chartreuse: "7fff00",
  chocolate: "d2691e",
  coral: "ff7f50",
  cornflowerblue: "6495ed",
  cornsilk: "fff8dc",
  crimson: "dc143c",
  cyan: "0ff",
  darkblue: "00008b",
  darkcyan: "008b8b",
  darkgoldenrod: "b8860b",
  darkgray: "a9a9a9",
  darkgreen: "006400",
  darkgrey: "a9a9a9",
  darkkhaki: "bdb76b",
  darkmagenta: "8b008b",
  darkolivegreen: "556b2f",
  darkorange: "ff8c00",
  darkorchid: "9932cc",
  darkred: "8b0000",
  darksalmon: "e9967a",
  darkseagreen: "8fbc8f",
  darkslateblue: "483d8b",
  darkslategray: "2f4f4f",
  darkslategrey: "2f4f4f",
  darkturquoise: "00ced1",
  darkviolet: "9400d3",
  deeppink: "ff1493",
  deepskyblue: "00bfff",
  dimgray: "696969",
  dimgrey: "696969",
  dodgerblue: "1e90ff",
  firebrick: "b22222",
  floralwhite: "fffaf0",
  forestgreen: "228b22",
  fuchsia: "f0f",
  gainsboro: "dcdcdc",
  ghostwhite: "f8f8ff",
  gold: "ffd700",
  goldenrod: "daa520",
  gray: "808080",
  green: "008000",
  greenyellow: "adff2f",
  grey: "808080",
  honeydew: "f0fff0",
  hotpink: "ff69b4",
  indianred: "cd5c5c",
  indigo: "4b0082",
  ivory: "fffff0",
  khaki: "f0e68c",
  lavender: "e6e6fa",
  lavenderblush: "fff0f5",
  lawngreen: "7cfc00",
  lemonchiffon: "fffacd",
  lightblue: "add8e6",
  lightcoral: "f08080",
  lightcyan: "e0ffff",
  lightgoldenrodyellow: "fafad2",
  lightgray: "d3d3d3",
  lightgreen: "90ee90",
  lightgrey: "d3d3d3",
  lightpink: "ffb6c1",
  lightsalmon: "ffa07a",
  lightseagreen: "20b2aa",
  lightskyblue: "87cefa",
  lightslategray: "789",
  lightslategrey: "789",
  lightsteelblue: "b0c4de",
  lightyellow: "ffffe0",
  lime: "0f0",
  limegreen: "32cd32",
  linen: "faf0e6",
  magenta: "f0f",
  maroon: "800000",
  mediumaquamarine: "66cdaa",
  mediumblue: "0000cd",
  mediumorchid: "ba55d3",
  mediumpurple: "9370db",
  mediumseagreen: "3cb371",
  mediumslateblue: "7b68ee",
  mediumspringgreen: "00fa9a",
  mediumturquoise: "48d1cc",
  mediumvioletred: "c71585",
  midnightblue: "191970",
  mintcream: "f5fffa",
  mistyrose: "ffe4e1",
  moccasin: "ffe4b5",
  navajowhite: "ffdead",
  navy: "000080",
  oldlace: "fdf5e6",
  olive: "808000",
  olivedrab: "6b8e23",
  orange: "ffa500",
  orangered: "ff4500",
  orchid: "da70d6",
  palegoldenrod: "eee8aa",
  palegreen: "98fb98",
  paleturquoise: "afeeee",
  palevioletred: "db7093",
  papayawhip: "ffefd5",
  peachpuff: "ffdab9",
  peru: "cd853f",
  pink: "ffc0cb",
  plum: "dda0dd",
  powderblue: "b0e0e6",
  purple: "800080",
  red: "f00",
  rosybrown: "bc8f8f",
  royalblue: "4169e1",
  saddlebrown: "8b4513",
  salmon: "fa8072",
  sandybrown: "f4a460",
  seagreen: "2e8b57",
  seashell: "fff5ee",
  sienna: "a0522d",
  silver: "c0c0c0",
  skyblue: "87ceeb",
  slateblue: "6a5acd",
  slategray: "708090",
  slategrey: "708090",
  snow: "fffafa",
  springgreen: "00ff7f",
  steelblue: "4682b4",
  tan: "d2b48c",
  teal: "008080",
  thistle: "d8bfd8",
  tomato: "ff6347",
  turquoise: "40e0d0",
  violet: "ee82ee",
  wheat: "f5deb3",
  white: "fff",
  whitesmoke: "f5f5f5",
  yellow: "ff0",
  yellowgreen: "9acd32"
};

trimLeft = /^[\s,#]+/;

trimRight = /\s+$/;

flip = function(o) {
  var flipped, k, v;
  flipped = {};
  for (k in o) {
    v = o[k];
    flipped[v] = k;
  }
  return flipped;
};

bound01 = function(n, max) {
  var processPercent;
  if (isOnePointZero(n)) {
    n = "100%";
  }
  processPercent = isPercentage(n);
  n = Math.min(max, Math.max(0, parseFloat(n)));
  if (processPercent) {
    n = parseInt(n * max, 10) / 100;
  }
  if (Math.abs(n - max) < 0.000001) {
    return 1;
  }
  return (n % max) / parseFloat(max);
};

parseHex = function(val) {
  return parseInt(val, 16);
};

isOnePointZero = function(n) {
  return typeof n === "string" && n.indexOf(".") !== -1 && parseFloat(n) === 1;
};

isPercentage = function(n) {
  return typeof n === "string" && n.indexOf("%") !== -1;
};

pad2 = function(c) {
  if (c.length === 1) {
    return "0" + c;
  } else {
    return "" + c;
  }
};

convertToPercentage = function(n) {
  if (n <= 1) {
    n = (n * 100) + "%";
  }
  return n;
};

COLOR_NAMES_F = flip(COLOR_NAMES);

CSS_INTEGER = "[-\\+]?\\d+%?";

CSS_NUMBER = "[-\\+]?\\d*\\.\\d+%?";

CSS_UNIT = "(?:" + CSS_NUMBER + ")|(?:" + CSS_INTEGER + ")";

PERMISSIVE_MATCH3 = "[\\s|\\(]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")\\s*\\)?";

PERMISSIVE_MATCH4 = "[\\s|\\(]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")[,|\\s]+(" + CSS_UNIT + ")\\s*\\)?";

matchers = {
  rgb: new RegExp("rgb" + PERMISSIVE_MATCH3),
  rgba: new RegExp("rgba" + PERMISSIVE_MATCH4),
  hsl: new RegExp("hsl" + PERMISSIVE_MATCH3),
  hsla: new RegExp("hsla" + PERMISSIVE_MATCH4),
  hsv: new RegExp("hsv" + PERMISSIVE_MATCH3),
  hex3: /^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,
  hex6: /^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/
};

/*
Color operations

@note GameCore.exports.utils.Color
*/


Color = (function() {
  /*
  @param {String | Color} hex color string or color name or Color instance
  @param {Object} options
  */

  function Color(color, opts) {
    var format, rgb;
    if (color == null) {
      color = "";
    }
    if (opts == null) {
      opts = {};
    }
    rgb = Color.inputToRGB(color);
    this.r = rgb.r;
    this.g = rgb.g;
    this.b = rgb.b;
    this.a = rgb.a;
    this.roundA = Math.round(100 * this.a) / 100;
    format = opts.format || rgb.format || false;
    if (this.r < 1) {
      this.r = Math.round(this.r);
    }
    if (this.g < 1) {
      this.g = Math.round(this.g);
    }
    if (this.b < 1) {
      this.b = Math.round(this.b);
    }
  }

  /*
  @method toHsv
  @return {Object} {h,s,v,a}
  */


  Color.prototype.toHsv = function() {
    var hsv;
    hsv = Color.rgbToHsv(this.r, this.g, this.b);
    return {
      h: hsv.h * 360,
      s: hsv.s,
      v: hsv.v,
      a: this.a
    };
  };

  /*
  @method toHsvString
  @return {String}
  */


  Color.prototype.toHsvString = function() {
    var h, hsv, s, v;
    hsv = Color.rgbToHsv(this.r, this.g, this.b);
    h = Math.round(hsv.h * 360);
    s = Math.round(hsv.s * 100);
    v = Math.round(hsv.v * 100);
    if (this.a === 1) {
      return "hsv(" + h + ", " + s + "%, " + v + "%)";
    } else {
      return "hsva(" + h + ", " + s + "%, " + v + "%, " + this.roundA + ")";
    }
  };

  /*
  @method toHsl
  @return {Object} {h,s,l,a}
  */


  Color.prototype.toHsl = function() {
    var hsl;
    hsl = Color.rgbToHsl(this.r, this.g, this.b);
    return {
      h: hsl.h * 360,
      s: hsl.s,
      l: hsl.l,
      a: this.a
    };
  };

  /*
  @method toHslString
  @return {String}
  */


  Color.prototype.toHslString = function() {
    var h, hsl, l, s;
    hsl = Color.rgbToHsl(this.r, this.g, this.b);
    h = Math.round(hsl.h * 360);
    s = Math.round(hsl.s * 100);
    l = Math.round(hsl.l * 100);
    if (this.a === 1) {
      return "hsl(" + h + ", " + s + "%, " + l + "%)";
    } else {
      return "hsla(" + h + ", " + s + "%, " + l + "%, " + this.roundA + ")";
    }
  };

  /*
  @method toHex
  @param {Boolean} allow3Char defaults=false
  @return {String}
  */


  Color.prototype.toHex = function(allow3Char) {
    if (allow3Char == null) {
      allow3Char = false;
    }
    return Color.rgbToHex(this.r, this.g, this.b, allow3Char);
  };

  /*
  @method toHexString
  @param {Boolean} allow3Char defaults=false
  @return {String} # + toHex()
  */


  Color.prototype.toHexString = function(allow3Char) {
    if (allow3Char == null) {
      allow3Char = false;
    }
    return "#" + this.toHex(allow3Char);
  };

  /*
  @method toRgb
  @return {Object} {r,g,b,a}
  */


  Color.prototype.toRgb = function() {
    return {
      r: Math.round(this.r),
      g: Math.round(this.g),
      b: Math.round(this.b),
      a: this.a
    };
  };

  /*
  @method toRgbString
  @return {String}
  */


  Color.prototype.toRgbString = function() {
    if (this.a === 1) {
      return "rgb(" + Math.round(this.r) + ", " + Math.round(this.g) + ", " + Math.round(this.b) + ")";
    } else {
      return "rgba(" + Math.round(this.r) + ", " + Math.round(this.g) + ", " + Math.round(this.b) + ", " + this.roundA + ")";
    }
  };

  Color.prototype.toPercentageRgb = function() {
    return {
      r: Math.round(bound01(this.r, 255) * 100) + "%",
      g: Math.round(bound01(this.g, 255) * 100) + "%",
      b: Math.round(bound01(this.b, 255) * 100) + "%",
      a: this.a
    };
  };

  Color.prototype.toPercentageRgbString = function() {
    if (this.a === 1) {
      return "rgb(" + Math.round(bound01(this.r, 255) * 100) + "%, " + Math.round(bound01(this.g, 255) * 100) + "%, " + Math.round(bound01(this.b, 255) * 100) + "%)";
    } else {
      return "rgba(" + Math.round(bound01(this.r, 255) * 100) + "%, " + Math.round(bound01(this.g, 255) * 100) + "%, " + Math.round(bound01(this.b, 255) * 100) + "%, " + this.a + ")";
    }
  };

  Color.prototype.toName = function() {
    if (this.a === 0) {
      return "transparent";
    }
    return COLOR_NAMES_F[Color.rgbToHex(this.r, this.g, this.b, true)] || false;
  };

  /*
  Outputing current color as string
  */


  Color.prototype.toString = function(format) {
    var formatSet, formatWithAlpha, formattedString, hasAlphaAndFormatNotSet;
    formatSet = !!format;
    format = format || this.format;
    formattedString = false;
    hasAlphaAndFormatNotSet = !formatSet && this.a < 1 && this.a > 0;
    formatWithAlpha = hasAlphaAndFormatNotSet && (format === "hex" || format === "hex6" || format === "hex3" || format === "name");
    if (format === "rgb") {
      formattedString = this.toRgbString();
    }
    if (format === "prgb") {
      formattedString = this.toPercentageRgbString();
    }
    if (format === "hex" || format === "hex6") {
      formattedString = this.toHexString();
    }
    if (format === "hex3") {
      formattedString = this.toHexString(true);
    }
    if (format === "name") {
      formattedString = this.toName();
    }
    if (format === "hsl") {
      formattedString = this.toHslString();
    }
    if (format === "hsv") {
      formattedString = this.toHsvString();
    }
    if (formatWithAlpha) {
      return this.toRgbString();
    } else {
      return formattedString || this.toHexString();
    }
  };

  /*
  If input is an object, force 1 into "1.0" to handle ratios properly
  String input requires "1.0" as input, so 1 will be treated as 1
  
  Given a string or object, convert that input to RGB
  Possible string inputs:
  
  "red"
  "#f00" or "f00"
  "#ff0000" or "ff0000"
  "rgb 255 0 0" or "rgb (255, 0, 0)"
  "rgb 1.0 0 0" or "rgb (1, 0, 0)"
  "rgba (255, 0, 0, 1)" or "rgba 255, 0, 0, 1"
  "rgba (1.0, 0, 0, 1)" or "rgba 1.0, 0, 0, 1"
  "hsl(0, 100%, 50%)" or "hsl 0 100% 50%"
  "hsla(0, 100%, 50%, 1)" or "hsla 0 100% 50%, 1"
  "hsv(0, 100%, 100%)" or "hsv 0 100% 100%"
  
  @param {String | Color} color
  */


  Color.inputToRGB = function(color) {
    var a, format, ok, rgb;
    rgb = {
      r: 0,
      g: 0,
      b: 0
    };
    a = 1;
    ok = false;
    format = false;
    if (typeof color === "string") {
      color = stringInputToObject(color);
    }
    if (typeof color === "object") {
      if (color.hasOwnProperty("r") && color.hasOwnProperty("g") && color.hasOwnProperty("b")) {
        rgb = Color.rgbToRgb(color.r, color.g, color.b);
        ok = true;
        format = (String(color.r).substr(-1) === "%" ? "prgb" : "rgb");
      } else if (color.hasOwnProperty("h") && color.hasOwnProperty("s") && color.hasOwnProperty("v")) {
        color.s = convertToPercentage(color.s);
        color.v = convertToPercentage(color.v);
        rgb = Color.hsvToRgb(color.h, color.s, color.v);
        ok = true;
        format = "hsv";
      } else if (color.hasOwnProperty("h") && color.hasOwnProperty("s") && color.hasOwnProperty("l")) {
        color.s = convertToPercentage(color.s);
        color.l = convertToPercentage(color.l);
        rgb = Color.hslToRgb(color.h, color.s, color.l);
        ok = true;
        format = "hsl";
      }
      if (color.hasOwnProperty("a")) {
        a = color.a;
      }
    }
    a = parseFloat(a);
    if (isNaN(a) || a < 0 || a > 1) {
      a = 1;
    }
    return {
      ok: ok,
      format: color.format || format,
      r: Math.min(255, Math.max(rgb.r, 0)),
      g: Math.min(255, Math.max(rgb.g, 0)),
      b: Math.min(255, Math.max(rgb.b, 0)),
      a: a
    };
  };

  /*
  Handle bounds / percentage checking to conform to CSS color spec
  <http://www.w3.org/TR/css3-color/>
  
  @method rgbToRgb
  
  @param {Integer} r in 0..255 or 0..1
  @param {Integer} g in 0..255 or 0..1
  @param {Integer} b in 0..255 or 0..1
  
  @return {Object} { r, g, b } in 0..255
  */


  Color.rgbToRgb = function(r, g, b) {
    return {
      r: bound01(r, 255) * 255,
      g: bound01(g, 255) * 255,
      b: bound01(b, 255) * 255
    };
  };

  /*
  Converts an RGB color value to HSL.
  
  @method rgbToHsl
  
  @param {Integer} r in 0..255 or 0..1
  @param {Integer} g in 0..255 or 0..1
  @param {Integer} b in 0..255 or 0..1
  
  @return {Object} { h, s, l } in 0..1
  */


  Color.rgbToHsl = function(r, g, b) {
    var d, h, l, max, min, s;
    r = bound01(r, 255);
    g = bound01(g, 255);
    b = bound01(b, 255);
    max = Math.max(r, g, b);
    min = Math.min(r, g, b);
    h = void 0;
    s = void 0;
    l = (max + min) / 2;
    if (max === min) {
      h = s = 0;
    } else {
      d = max - min;
      s = (l > 0.5 ? d / (2 - max - min) : d / (max + min));
      switch (max) {
        case r:
          h = (g - b) / d + (g < b ? 6 : 0);
          break;
        case g:
          h = (b - r) / d + 2;
          break;
        case b:
          h = (r - g) / d + 4;
      }
      h /= 6;
    }
    return {
      h: h,
      s: s,
      l: l
    };
  };

  /*
  Converts an HSL color value to RGB.
  
  @method hslToRgb
  @param {Integer} h in 0..360 or 0..1
  @param {Integer} s in 0..100 or 0..1
  @param {Integer} l in 0..100 or 0..1
  @return {Object} { r, g, b } in 0..255
  */


  Color.hslToRgb = function(h, s, l) {
    var b, g, hue2rgb, p, q, r;
    hue2rgb = function(p, q, t) {
      if (t < 0) {
        t += 1;
      }
      if (t > 1) {
        t -= 1;
      }
      if (t < 1 / 6) {
        return p + (q - p) * 6 * t;
      }
      if (t < 1 / 2) {
        return q;
      }
      if (t < 2 / 3) {
        return p + (q - p) * (2 / 3 - t) * 6;
      }
      return p;
    };
    r = void 0;
    g = void 0;
    b = void 0;
    h = bound01(h, 360);
    s = bound01(s, 100);
    l = bound01(l, 100);
    if (s === 0) {
      r = g = b = l;
    } else {
      q = (l < 0.5 ? l * (1 + s) : l + s - l * s);
      p = 2 * l - q;
      r = hue2rgb(p, q, h + 1 / 3);
      g = hue2rgb(p, q, h);
      b = hue2rgb(p, q, h - 1 / 3);
    }
    return {
      r: r * 255,
      g: g * 255,
      b: b * 255
    };
  };

  /*
  Converts an RGB color value to HSV
  
  @method rgbToHsv
  @param {Integer} r in 0..255 or 0..1
  @param {Integer} g in 0..255 or 0..1
  @param {Integer} b in 0..255 or 0..1
  @return {Object} { h, s, v } in 0..1
  */


  Color.rgbToHsv = function(r, g, b) {
    var d, h, max, min, s, v;
    r = bound01(r, 255);
    g = bound01(g, 255);
    b = bound01(b, 255);
    max = Math.max(r, g, b);
    min = Math.min(r, g, b);
    h = void 0;
    s = void 0;
    v = max;
    d = max - min;
    s = (max === 0 ? 0 : d / max);
    if (max === min) {
      h = 0;
    } else {
      switch (max) {
        case r:
          h = (g - b) / d + (g < b ? 6 : 0);
          break;
        case g:
          h = (b - r) / d + 2;
          break;
        case b:
          h = (r - g) / d + 4;
      }
      h /= 6;
    }
    return {
      h: h,
      s: s,
      v: v
    };
  };

  /*
  Converts an HSV color value to RGB.
  
  @method hsvToRgb
  @param {Integer} h in 0..360 or 0..1
  @param {Integer} s in 0..100 or 0..1
  @param {Integer} v in 0..100 or 0..1
  @return {Object} { r, g, b } in 0..255
  */


  Color.hsvToRgb = function(h, s, v) {
    var b, f, g, i, mod, p, q, r, t;
    h = bound01(h, 360) * 6;
    s = bound01(s, 100);
    v = bound01(v, 100);
    i = Math.floor(h);
    f = h - i;
    p = v * (1 - s);
    q = v * (1 - f * s);
    t = v * (1 - (1 - f) * s);
    mod = i % 6;
    r = [v, q, p, p, t, v][mod];
    g = [t, v, v, q, p, p][mod];
    b = [p, p, t, v, v, q][mod];
    return {
      r: r * 255,
      g: g * 255,
      b: b * 255
    };
  };

  /*
  Converts an RGB color to hex
  
  @method rgbToHex
  @param {Integer} r in 0..255
  @param {Integer} g in 0..255
  @param {Integer} b in 0..255
  @param {Boolean} allow3Char
  @return {String} 3 or 6 character hex
  */


  Color.rgbToHex = function(r, g, b, allow3Char) {
    var hex;
    if (allow3Char == null) {
      allow3Char = false;
    }
    hex = [pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16))];
    if (allow3Char && hex[0].charAt(0) === hex[0].charAt(1) && hex[1].charAt(0) === hex[1].charAt(1) && hex[2].charAt(0) === hex[2].charAt(1)) {
      return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);
    }
    return hex.join("");
  };

  return Color;

})();

/*
Permissive string parsing. Take in a number of formats, and output an object
based on detected format.
@method stringInputToObject
@param {String | Color} color
@return {Object} `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`
*/


stringInputToObject = function(color) {
  var match, named;
  color = color.replace(trimLeft, "").replace(trimRight, "").toLowerCase();
  named = false;
  if (COLOR_NAMES[color]) {
    color = COLOR_NAMES[color];
    named = true;
  } else if (color === "transparent") {
    ({
      r: 0,
      g: 0,
      b: 0,
      a: 0,
      format: "name"
    });
  }
  match = void 0;
  if (match = matchers.rgb.exec(color)) {
    return {
      r: match[1],
      g: match[2],
      b: match[3]
    };
  }
  if (match = matchers.rgba.exec(color)) {
    return {
      r: match[1],
      g: match[2],
      b: match[3],
      a: match[4]
    };
  }
  if (match = matchers.hsl.exec(color)) {
    return {
      h: match[1],
      s: match[2],
      l: match[3]
    };
  }
  if (match = matchers.hsla.exec(color)) {
    return {
      h: match[1],
      s: match[2],
      l: match[3],
      a: match[4]
    };
  }
  if (match = matchers.hsv.exec(color)) {
    return {
      h: match[1],
      s: match[2],
      v: match[3]
    };
  }
  if (match = matchers.hex6.exec(color)) {
    return {
      r: parseHex(match[1]),
      g: parseHex(match[2]),
      b: parseHex(match[3]),
      format: (named ? "name" : "hex")
    };
  }
  if (match = matchers.hex3.exec(color)) {
    return {
      r: parseHex(match[1] + "" + match[1]),
      g: parseHex(match[2] + "" + match[2]),
      b: parseHex(match[3] + "" + match[3]),
      format: (named ? "name" : "hex")
    };
  }
  return false;
};

Color.fromRatio = function(color, opts) {
  var i, newColor;
  if (opts == null) {
    opts = {};
  }
  if (typeof color === "object") {
    newColor = {};
    for (i in color) {
      if (color.hasOwnProperty(i)) {
        if (i === "a") {
          newColor[i] = color[i];
        } else {
          newColor[i] = convertToPercentage(color[i]);
        }
      }
    }
    color = newColor;
  }
  return new Color(color, opts);
};

Color.equals = function(color1, color2) {
  if (!color1 || !color2) {
    return false;
  }
  return (new Color(color1)).toRgbString() === (new Color(color2)).toRgbString();
};

Color.random = function() {
  return Color.fromRatio({
    r: Math.random(),
    g: Math.random(),
    b: Math.random()
  });
};

Color.desaturate = function(color, amount) {
  var hsl;
  if (amount == null) {
    amount = 10;
  }
  hsl = (new Color(color)).toHsl();
  hsl.s -= amount / 100;
  hsl.s = Mathematic.clamp01(hsl.s);
  return new Color(hsl);
};

Color.saturate = function(color, amount) {
  var hsl;
  if (amount == null) {
    amount = 10;
  }
  hsl = (new Color(color)).toHsl();
  hsl.s += amount / 100;
  hsl.s = Mathematic.clamp01(hsl.s);
  return new Color(hsl);
};

Color.greyscale = function(color) {
  return Color.desaturate(color, 100);
};

Color.lighten = function(color, amount) {
  var hsl;
  if (amount == null) {
    amount = 10;
  }
  hsl = (new Color(color)).toHsl();
  hsl.l += amount / 100;
  hsl.l = Mathematic.clamp01(hsl.l);
  return new Color(hsl);
};

Color.darken = function(color, amount) {
  var hsl;
  if (amount == null) {
    amount = 10;
  }
  hsl = (new Color(color)).toHsl();
  hsl.l -= amount / 100;
  hsl.l = Mathematic.clamp01(hsl.l);
  return new Color(hsl);
};

Color.complement = function(color) {
  var hsl;
  hsl = (new Color(color)).toHsl();
  hsl.h = (hsl.h + 180) % 360;
  return new Color(hsl);
};

Color.triad = function(color) {
  var h, hsl;
  hsl = (new Color(color)).toHsl();
  h = hsl.h;
  return [
    new Color(color), new Color({
      h: (h + 120) % 360,
      s: hsl.s,
      l: hsl.l
    }), new Color({
      h: (h + 240) % 360,
      s: hsl.s,
      l: hsl.l
    })
  ];
};

Color.tetrad = function(color) {
  var h, hsl;
  hsl = (new Color(color)).toHsl();
  h = hsl.h;
  return [
    new Color(color), new Color({
      h: (h + 90) % 360,
      s: hsl.s,
      l: hsl.l
    }), new Color({
      h: (h + 180) % 360,
      s: hsl.s,
      l: hsl.l
    }), new Color({
      h: (h + 270) % 360,
      s: hsl.s,
      l: hsl.l
    })
  ];
};

Color.splitcomplement = function(color) {
  var h, hsl;
  hsl = (new Color(color)).toHsl();
  h = hsl.h;
  return [
    new Color(color), new Color({
      h: (h + 72) % 360,
      s: hsl.s,
      l: hsl.l
    }), new Color({
      h: (h + 216) % 360,
      s: hsl.s,
      l: hsl.l
    })
  ];
};

Color.analogous = function(color, results, slices) {
  var hsl, part, ret;
  if (results == null) {
    results = 6;
  }
  if (slices == null) {
    slices = 30;
  }
  hsl = (new Color(color)).toHsl();
  part = 360 / slices;
  ret = [new Color(color)];
  hsl.h = ((hsl.h - (part * results >> 1)) + 720) % 360;
  while (--results) {
    hsl.h = (hsl.h + part) % 360;
    ret.push(new Color(hsl));
  }
  return ret;
};

Color.monochromatic = function(color, results) {
  var h, hsv, modification, ret, s, v;
  if (results == null) {
    results = 6;
  }
  hsv = (new Color(color)).toHsv();
  h = hsv.h;
  s = hsv.s;
  v = hsv.v;
  ret = [];
  modification = 1 / results;
  while (results--) {
    ret.push(Color({
      h: h,
      s: s,
      v: v
    }));
    v = (v + modification) % 1;
  }
  return ret;
};

Color.readability = function(color1, color2) {
  var a, b, brightnessA, brightnessB, colorDiff;
  a = (new Color(color1)).toRgb();
  b = (new Color(color2)).toRgb();
  brightnessA = (a.r * 299 + a.g * 587 + a.b * 114) / 1000;
  brightnessB = (b.r * 299 + b.g * 587 + b.b * 114) / 1000;
  colorDiff = Math.max(a.r, b.r) - Math.min(a.r, b.r) + Math.max(a.g, b.g) - Math.min(a.g, b.g) + Math.max(a.b, b.b) - Math.min(a.b, b.b);
  return {
    brightness: Math.abs(brightnessA - brightnessB),
    color: colorDiff
  };
};

Color.readable = function(color1, color2) {
  var readability;
  readability = Color.readability(color1, color2);
  return readability.brightness > 125 && readability.color > 500;
};

Color.mostReadable = function(baseColor, colorList) {
  var bestColor, bestIsReadable, bestScore, i, readability, readable, score;
  bestColor = null;
  bestScore = 0;
  bestIsReadable = false;
  i = 0;
  while (i < colorList.length) {
    readability = Color.readability(baseColor, colorList[i]);
    readable = readability.brightness > 125 && readability.color > 500;
    score = 3 * (readability.brightness / 125) + (readability.color / 500);
    if ((readable && !bestIsReadable) || (readable && bestIsReadable && score > bestScore) || ((!readable) && (!bestIsReadable) && score > bestScore)) {
      bestIsReadable = readable;
      bestScore = score;
      bestColor = new Color(colorList[i]);
    }
    i++;
  }
  return bestColor;
};

module.exports = Color;

/*
//@ sourceMappingURL=color.map
*/

},{"../math/math":5}],18:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
module.exports = {
  Color: require("./color"),
  Font: require("./font")
};

/*
//@ sourceMappingURL=exports.map
*/

},{"./color":17,"./font":19}],19:[function(require,module,exports){
// Generated by CoffeeScript 1.6.3
/*
Inspired by Font.js by  Mike "Pomax" Kamermans
@see http://github.com/Pomax/Font.js
*/

var FONT_CACHE, Font, Mathmetics;

Mathmetics = require("../math/math");

FONT_CACHE = {};

/*
Font manipulations and measurement

@note GameCore.exports.Utils.Font
*/


Font = (function() {
  function Font() {
    this.fontFamily = "font" + Mathmetics.randomInt(0, 999999);
  }

  return Font;

})();

/*
//@ sourceMappingURL=font.map
*/

},{"../math/math":5}]},{},[1])
//@ sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyIvVXNlcnMvYWxleC9Db2RpbmcvR2FtZUNvcmUvLnRtcC9jb3JlLmpzIiwiL1VzZXJzL2FsZXgvQ29kaW5nL0dhbWVDb3JlLy50bXAvY29yZS9jb250ZXh0LzJkLmpzIiwiL1VzZXJzL2FsZXgvQ29kaW5nL0dhbWVDb3JlLy50bXAvY29yZS9zdXBwb3J0LmpzIiwiL1VzZXJzL2FsZXgvQ29kaW5nL0dhbWVDb3JlLy50bXAvbWF0aC9leHBvcnRzLmpzIiwiL1VzZXJzL2FsZXgvQ29kaW5nL0dhbWVDb3JlLy50bXAvbWF0aC9tYXRoLmpzIiwiL1VzZXJzL2FsZXgvQ29kaW5nL0dhbWVDb3JlLy50bXAvbWF0aC9tYXRyaXgyZC5qcyIsIi9Vc2Vycy9hbGV4L0NvZGluZy9HYW1lQ29yZS8udG1wL21hdGgvdXVpZC5qcyIsIi9Vc2Vycy9hbGV4L0NvZGluZy9HYW1lQ29yZS8udG1wL21hdGgvdmVjdG9yMmQuanMiLCIvVXNlcnMvYWxleC9Db2RpbmcvR2FtZUNvcmUvLnRtcC91aS9jb250YWluZXIuanMiLCIvVXNlcnMvYWxleC9Db2RpbmcvR2FtZUNvcmUvLnRtcC91aS9leHBvcnRzLmpzIiwiL1VzZXJzL2FsZXgvQ29kaW5nL0dhbWVDb3JlLy50bXAvdWkvZ2VvbWV0cnkvY2lyY2xlLmpzIiwiL1VzZXJzL2FsZXgvQ29kaW5nL0dhbWVDb3JlLy50bXAvdWkvZ2VvbWV0cnkvZXhwb3J0cy5qcyIsIi9Vc2Vycy9hbGV4L0NvZGluZy9HYW1lQ29yZS8udG1wL3VpL2dlb21ldHJ5L3JlY3QuanMiLCIvVXNlcnMvYWxleC9Db2RpbmcvR2FtZUNvcmUvLnRtcC91aS9zdGFnZS5qcyIsIi9Vc2Vycy9hbGV4L0NvZGluZy9HYW1lQ29yZS8udG1wL3VpL3RleHQuanMiLCIvVXNlcnMvYWxleC9Db2RpbmcvR2FtZUNvcmUvLnRtcC91aS93aWRnZXQuanMiLCIvVXNlcnMvYWxleC9Db2RpbmcvR2FtZUNvcmUvLnRtcC91dGlscy9jb2xvci5qcyIsIi9Vc2Vycy9hbGV4L0NvZGluZy9HYW1lQ29yZS8udG1wL3V0aWxzL2V4cG9ydHMuanMiLCIvVXNlcnMvYWxleC9Db2RpbmcvR2FtZUNvcmUvLnRtcC91dGlscy9mb250LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcFdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDWEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcExBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ1pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0xBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7Ly8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjYuM1xudmFyIEdhbWVDb3JlLCBTdGFnZSwgVVVJRCwgY29udGV4dDJkLCBzdXBwb3J0O1xuXG5jb250ZXh0MmQgPSByZXF1aXJlKFwiLi9jb3JlL2NvbnRleHQvMmRcIik7XG5cbnN1cHBvcnQgPSByZXF1aXJlKFwiLi9jb3JlL3N1cHBvcnRcIik7XG5cblVVSUQgPSByZXF1aXJlKFwiLi9tYXRoL3V1aWRcIik7XG5cblN0YWdlID0gcmVxdWlyZShcIi4vdWkvc3RhZ2VcIik7XG5cbi8qXG5HYW1lIENvcmUgYmFzZSBjbGFzc1xuXG5AcHJvcGVydHkge1N0YWdlfSBzdGFnZVxuQHByb3BlcnR5IHtCb29sZWFufSBmdWxsU2NyZWVuXG5AcHJvcGVydHkge0Jvb2xlYW59IHBhdXNlZFxuQHByb3BlcnR5IHtDb250ZXh0fSBjb250ZXh0XG5AcHJvcGVydHkge0ludH0gd2lkdGhcbkBwcm9wZXJ0eSB7SW50fSBoZWlndGhcbkBwcm9wZXJ0eSB7RE9NRWxlbWVudH0gcmVuZGVyZXJcblxuQGV4YW1wbGUgSG93IHRvIGNyZWF0ZSBhbiBnYW1lIGNvcmUgXG4gICAgZ2MgPSBuZXcgR2FtZUNvcmUoKSAjIENyZWF0aW5nIGNvcmVcbiAgICBnYy5yZW5kZXJlciA9IGRvY3VtZW50LmJvZHkgIyBBcHBlbmRzIG5ldyBjYW52YXMgZWxlbWVudCB0byBkb2N1bWVudHMgYm9keVxuXG5AZXhhbXBsZSBNYWtpbmcgY2FudmFzIGZ1bGwtc2l6ZWRcbiAgICBnYyA9IG5ldyBHYW1lQ29yZSgpICMgQ3JlYXRpbmcgY29yZVxuICAgIGdjLmZ1bGxTY3JlZW4gPSB0cnVlXG4qL1xuXG5cbkdhbWVDb3JlID0gKGZ1bmN0aW9uKCkge1xuICAvKlxuICBHYW1lQ29yZSBpbnN0YW5jZWMgYXJjaGl2ZVxuICAqL1xuXG4gIEdhbWVDb3JlLmNvcmVzID0ge307XG5cbiAgLypcbiAgU3RhcnQgeW91ciBhcHBsaWNhdGlvbiBmcm9tIGhlcmUuXG4gIFxuICBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICAqL1xuXG5cbiAgZnVuY3Rpb24gR2FtZUNvcmUob3B0aW9ucykge1xuICAgIHZhciBlcnJvciwgX2ksIF9sZW4sIF9yZWY7XG4gICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucyAhPSBudWxsID8gb3B0aW9ucyA6IHt9O1xuICAgIC8qXG4gICAgSW4gdGhlIGZpcnN0IGNhc2Ugd2UgbmVlZCB0byBnZW5lcmF0ZSBpZCBmb3IgbmV3IGluc3RhbmNlLCBpZiBpdCBub3RcbiAgICAgcHJlc2VudCBpbiBvcHRpb25zLlxuICAgICovXG5cbiAgICB0aGlzLmlkID0gdGhpcy5vcHRpb25zLmlkIHx8IFVVSUQuZ2VuZXJhdGVVbmlxdWVJZCgpO1xuICAgIC8qXG4gICAgQ2hlY2luZyBmb3IgcnVudGltZSBlcnJvcnNcbiAgICAqL1xuXG4gICAgaWYgKHN1cHBvcnQuRVJST1JTKSB7XG4gICAgICBfcmVmID0gc3VwcG9ydC5FUlJPUlM7XG4gICAgICBmb3IgKF9pID0gMCwgX2xlbiA9IF9yZWYubGVuZ3RoOyBfaSA8IF9sZW47IF9pKyspIHtcbiAgICAgICAgZXJyb3IgPSBfcmVmW19pXTtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgfVxuICAgIC8qXG4gICAgU2V0dGluZyB1cCBhIGNhbnZhcy5cbiAgICBJZiBjYW52YXMgZG9lc24ndCBwcmVzZW50IGluIG9wdGlvbnMgdGhlbiBjcmVhdGUgaXQuXG4gICAgKi9cblxuICAgIHRoaXMub3B0aW9ucy5jYW52YXMgPSB0aGlzLm9wdGlvbnMuY2FudmFzIHx8IHRoaXMuY3JlYXRlQ2FudmFzKCk7XG4gICAgLypcbiAgICBSZWdpc3RyYXRpbmcgR2FtZUNvcmUgaW5zdGFuY2UgaW4gY2FudmFzIGFuZyBHYW1lQ29yZSBnbG9iYWwuXG4gICAgKi9cblxuICAgIHRoaXMub3B0aW9ucy5jYW52YXMuY29yZSA9IHRoaXM7XG4gICAgR2FtZUNvcmUuY29yZXNbdGhpcy5pZF0gPSB0aGlzO1xuICAgIC8qXG4gICAgU2V0dGluZyB1cCBmcmFtZXJhdGVcbiAgICAqL1xuXG4gICAgdGhpcy5zZXRGcmFtZXJhdGUoKTtcbiAgICAvKlxuICAgIFJlbmRlciB0aWNrIGhvb2tzXG4gICAgKi9cblxuICAgIHRoaXMuX3JlbmRlcl90aWNrX2hvb2tzID0ge307XG4gICAgLypcbiAgICBTdGFnZXMgbWFwXG4gICAgKi9cblxuICAgIHRoaXMuX3N0YWdlcyA9IHt9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInN0YWdlXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGFnZTtcbiAgICAgICAgaWYgKHRoaXMuX2N1cnJlbnRfc3RhZ2VfaWQpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fc3RhZ2VzW3RoaXMuX2N1cnJlbnRfc3RhZ2VfaWRdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHN0YWdlID0gbmV3IFN0YWdlO1xuICAgICAgICAgIHRoaXMuX2N1cnJlbnRfc3RhZ2VfaWQgPSBzdGFnZS5pZDtcbiAgICAgICAgICB0aGlzLmFkZFN0YWdlKHN0YWdlKTtcbiAgICAgICAgICByZXR1cm4gc3RhZ2U7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uKHN0YWdlKSB7XG4gICAgICAgIGlmICghdGhpcy5fc3RhZ2VzW3N0YWdlLmlkXSkge1xuICAgICAgICAgIHRoaXMuYWRkU3RhZ2Uoc3RhZ2UpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJyZW50X3N0YWdlX2lkID0gc3RhZ2UuaWQ7XG4gICAgICB9XG4gICAgfSk7XG4gICAgLypcbiAgICAqL1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiZnVsbFNjcmVlblwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faW5fdGhlX2Z1bGxzY3JlZW5fbm93O1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24oYikge1xuICAgICAgICBpZiAoYiA9PT0gdHJ1ZSkge1xuICAgICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMuX2Z1bGxTY3JlZW5fcmVzaXplcik7XG4gICAgICAgICAgdGhpcy5faW5fdGhlX2Z1bGxzY3JlZW5fbm93ID0gdHJ1ZTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5zZXRTaXplKGRvY3VtZW50LndpZHRoLCBkb2N1bWVudC5oZWlnaHQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMuX2Z1bGxTY3JlZW5fcmVzaXplcik7XG4gICAgICAgICAgdGhpcy5faW5fdGhlX2Z1bGxzY3JlZW5fbm93ID0gZmFsc2U7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuc2V0U2l6ZSh0aGlzLm9wdGlvbnMud2lkdGgsIHRoaXMub3B0aW9ucy5oZWlnaHQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5mdWxsU2NyZWVuID0gdGhpcy5vcHRpb25zLmZ1bGxTY3JlZW47XG4gICAgLypcbiAgICAqL1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwid2lkdGhcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5jYW52YXMud2lkdGg7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbih3aWR0aCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMuY2FudmFzLndpZHRoID0gd2lkdGg7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuY2FudmFzLnN0eWxlLndpZHRoID0gd2lkdGggKyBcInB4XCI7XG4gICAgICB9XG4gICAgfSk7XG4gICAgLypcbiAgICAqL1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwiaGVpZ2h0XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnMuY2FudmFzLmhlaWdodDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uKGhlaWdodCkge1xuICAgICAgICB0aGlzLm9wdGlvbnMuY2FudmFzLmhlaWdodCA9IGhlaWdodDtcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5jYW52YXMuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgXCJweFwiO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmICh0aGlzLmZ1bGxTY3JlZW4pIHtcbiAgICAgIHRoaXMub3B0aW9ucy53aWR0aCA9IHdpbmRvdy53aWR0aDtcbiAgICAgIHRoaXMub3B0aW9ucy5oZWlnaHQgPSB3aW5kb3cuaGVpZ2h0O1xuICAgIH1cbiAgICB0aGlzLnNldFNpemUodGhpcy5vcHRpb25zLndpZHRoLCB0aGlzLm9wdGlvbnMuaGVpZ2h0KTtcbiAgICAvKlxuICAgIENvbnRleHQgZWxlbWVudC5cbiAgICBDdXJyZW50bHkgc3VwcG9ydCBvbmx5IENvbnRleHQyZFxuICAgICovXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjb250ZXh0XCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghdGhpcy5fY29udGV4dCkge1xuICAgICAgICAgIHRoaXMuX2NvbnRleHQgPSBuZXcgY29udGV4dDJkKHtcbiAgICAgICAgICAgIGNhbnZhczogdGhpcy5vcHRpb25zLmNhbnZhc1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzLl9jb250ZXh0O1xuICAgICAgfVxuICAgIH0pO1xuICAgIC8qXG4gICAgKi9cblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInBhdXNlZFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGF1c2VkIHx8IGZhbHNlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24ocGF1c2VkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYXVzZWQgPSBwYXVzZWQgPyB0cnVlIDogZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gICAgLypcbiAgICBSZW5kZXJlciBlbGVtZW50LlxuICAgICovXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJyZW5kZXJlclwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGFyZW50X25vZGUgfHwgJ3VuZGVmaW5lZCc7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIGlmICghbm9kZS50YWdOYW1lKSB7XG4gICAgICAgICAgdGhyb3cgRXJyb3IoXCJDYW4gcmVuZGVyIG9ubHkgb24gZG9jdW1lbnQgZWxlbWVudHNcIik7XG4gICAgICAgIH1cbiAgICAgICAgbm9kZS5hcHBlbmRDaGlsZCh0aGlzLm9wdGlvbnMuY2FudmFzKTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhcmVudF9ub2RlID0gbm9kZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLl9vbkVudGVyRnJhbWUoKTtcbiAgfVxuXG4gIC8qXG4gICovXG5cblxuICBHYW1lQ29yZS5wcm90b3R5cGUuYWRkU3RhZ2UgPSBmdW5jdGlvbihzdGFnZSwgc2V0Q3VycmVudCkge1xuICAgIGlmIChzZXRDdXJyZW50ID09IG51bGwpIHtcbiAgICAgIHNldEN1cnJlbnQgPSBmYWxzZTtcbiAgICB9XG4gICAgdGhpcy5fc3RhZ2VzW3N0YWdlLmlkXSA9IHN0YWdlO1xuICAgIGlmIChzZXRDdXJyZW50KSB7XG4gICAgICByZXR1cm4gdGhpcy5zdGFnZSA9IHN0YWdlLmlkO1xuICAgIH1cbiAgfTtcblxuICAvKlxuICBTd2l0Y2ggcGF1c2Ugc3RhdGVcbiAgKi9cblxuXG4gIEdhbWVDb3JlLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnBhdXNlZCA9ICF0aGlzLnBhdXNlZDtcbiAgfTtcblxuICAvKlxuICBTZXQncyBmcmFtZXJhdGUuIE5vdCB1c2FibGUgYXQgdGhlIG1vbWVudC4uLlxuICBAcGFyYW0ge0ludH0gZnJhbWVyYXRlXG4gIEBtZXRob2Qgc2V0RnJhbWVyYXRlXG4gICovXG5cblxuICBHYW1lQ29yZS5wcm90b3R5cGUuc2V0RnJhbWVyYXRlID0gZnVuY3Rpb24oZnJhbWVyYXRlKSB7XG4gICAgaWYgKGZyYW1lcmF0ZSA9PSBudWxsKSB7XG4gICAgICBmcmFtZXJhdGUgPSA2MDtcbiAgICB9XG4gICAgcmV0dXJuIHdpbmRvdy5fRlBTID0gZnJhbWVyYXRlO1xuICB9O1xuXG4gIC8qXG4gIFNldCBzaXplIG9mIGFuIGNhbnZhcyBlbGVtZW50LlxuICBAcGFyYW0ge0ludH0gd2lkdGhcbiAgQHBhcmFtIHtJbnR9IGhlaWdodFxuICBAbWV0aG9kIHNldFNpemVcbiAgKi9cblxuXG4gIEdhbWVDb3JlLnByb3RvdHlwZS5zZXRTaXplID0gZnVuY3Rpb24od2lkdGgsIGhlaWdodCkge1xuICAgIGlmICh3aWR0aCA9PSBudWxsKSB7XG4gICAgICB3aWR0aCA9IDQwMDtcbiAgICB9XG4gICAgaWYgKGhlaWdodCA9PSBudWxsKSB7XG4gICAgICBoZWlnaHQgPSAzMDA7XG4gICAgfVxuICAgIHRoaXMud2lkdGggPSB3aWR0aDtcbiAgICByZXR1cm4gdGhpcy5oZWlnaHQgPSBoZWlnaHQ7XG4gIH07XG5cbiAgR2FtZUNvcmUucHJvdG90eXBlLl9mdWxsU2NyZWVuX3Jlc2l6ZXIgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgZ2NpO1xuICAgIGdjaSA9IHRoaXM7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKGUpIHtcbiAgICAgIHJldHVybiBnY2kuc2V0U2l6ZSh3aW5kb3cud2lkdGgsIHdpbmRvdy5oZWlnaHQpO1xuICAgIH07XG4gIH07XG5cbiAgLypcbiAgQ3JlYXRlcyBhIGNhbnZhcyBlbGVtZW50XG4gIEBtZXRob2QgY3JlYXRlQ2FudmFzXG4gICovXG5cblxuICBHYW1lQ29yZS5wcm90b3R5cGUuY3JlYXRlQ2FudmFzID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGNhbnZhcztcbiAgICBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICByZXR1cm4gY2FudmFzO1xuICB9O1xuXG4gIC8qXG4gIEFkZCByZW5kZXIgdGljayBob29rXG4gIFxuICBAbWV0aG9kIGFkZFJlbmRlclRpY2tIb29rXG4gIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gIEBwYXJhbSB7RnVuY3Rpb259IGZ1bmN0b3JcbiAgXG4gIEBub3RlIFJlbmRlciB0aWNrIGhvb2tzIGNhbGxzIGFmdGVyIHN0YWdlIHdhcyByZW5kZXJlZFxuICAqL1xuXG5cbiAgR2FtZUNvcmUucHJvdG90eXBlLmFkZFJlbmRlclRpY2tIb29rID0gZnVuY3Rpb24obmFtZSwgZnVuY3Rvcikge1xuICAgIHJldHVybiB0aGlzLl9yZW5kZXJfdGlja19ob29rc1tuYW1lXSA9IGZ1bmN0b3I7XG4gIH07XG5cbiAgLypcbiAgUmVtb3ZlcyByZW5kZXIgdGljayBob29rXG4gIEBtZXRob2QgcmVtb3ZlUmVuZGVyVGlja0hvb2tcbiAgQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAgKi9cblxuXG4gIEdhbWVDb3JlLnByb3RvdHlwZS5yZW1vdmVSZW5kZXJUaWNrSG9vayA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICByZXR1cm4gZGVsZXRlIHRoaXMuX3JlbmRlcl90aWNrX2hvb2tzW25hbWVdO1xuICB9O1xuXG4gIC8qXG4gIENhbGwgd2luZG93J3MgcmVxdWVzdEFuaW1hdGlvbkZyYW1lLlxuICBAbWV0aG9kIF9vbkVudGVyRnJhbWVcbiAgKi9cblxuXG4gIEdhbWVDb3JlLnByb3RvdHlwZS5fb25FbnRlckZyYW1lID0gZnVuY3Rpb24oZ2NpKSB7XG4gICAgaWYgKGdjaSA9PSBudWxsKSB7XG4gICAgICBnY2kgPSB0aGlzO1xuICAgIH1cbiAgICBpZiAoIXRoaXMucGF1c2VkKSB7XG4gICAgICBnY2kuX3JlbmRlcihnY2kuc3RhZ2UpO1xuICAgIH1cbiAgICByZXR1cm4gd2luZG93Lm9uRW50ZXJGcmFtZShmdW5jdGlvbigpIHtcbiAgICAgIHJldHVybiBnY2kuX29uRW50ZXJGcmFtZShnY2kpO1xuICAgIH0pO1xuICB9O1xuXG4gIEdhbWVDb3JlLnByb3RvdHlwZS5fcmVuZGVyID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIGhvb2ssIG5hbWUsIF9yZWYsIF9yZXN1bHRzO1xuICAgIHRoaXMuY29udGV4dC5yZW5kZXIoW3RoaXMuc3RhZ2VdKTtcbiAgICBfcmVmID0gdGhpcy5fcmVuZGVyX3RpY2tfaG9va3M7XG4gICAgX3Jlc3VsdHMgPSBbXTtcbiAgICBmb3IgKG5hbWUgaW4gX3JlZikge1xuICAgICAgaG9vayA9IF9yZWZbbmFtZV07XG4gICAgICBfcmVzdWx0cy5wdXNoKGhvb2suY2FsbCgpKTtcbiAgICB9XG4gICAgcmV0dXJuIF9yZXN1bHRzO1xuICB9O1xuXG4gIHJldHVybiBHYW1lQ29yZTtcblxufSkoKTtcblxud2luZG93LkdhbWVDb3JlID0gd2luZG93LkdhbWVDb3JlIHx8IEdhbWVDb3JlO1xuXG5HYW1lQ29yZS5leHBvcnRzID0ge1xuICBVSTogcmVxdWlyZShcIi4vdWkvZXhwb3J0c1wiKSxcbiAgTWF0aDogcmVxdWlyZShcIi4vbWF0aC9leHBvcnRzXCIpLFxuICBVdGlsczogcmVxdWlyZShcIi4vdXRpbHMvZXhwb3J0c1wiKVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBHYW1lQ29yZTtcblxuLypcbi8vQCBzb3VyY2VNYXBwaW5nVVJMPWNvcmUubWFwXG4qL1xuXG59KSgpIiwiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjYuM1xudmFyIENvbnRleHQyZDtcblxuQ29udGV4dDJkID0gKGZ1bmN0aW9uKCkge1xuICBmdW5jdGlvbiBDb250ZXh0MmQob3B0aW9ucykge1xuICAgIHRoaXMuc2V0Q2FudmFzKG9wdGlvbnMuY2FudmFzKTtcbiAgfVxuXG4gIENvbnRleHQyZC5wcm90b3R5cGUuc2V0Q2FudmFzID0gZnVuY3Rpb24oY2FudmFzKSB7XG4gICAgdGhpcy5jYW52YXMgPSBjYW52YXM7XG4gICAgdGhpcy5jdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIENvbnRleHQyZC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmN0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jdHguY2FudmFzLndpZHRoLCB0aGlzLmN0eC5jYW52YXMuaGVpZ2h0KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICBDb250ZXh0MmQucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKGxheWVycykge1xuICAgIHZhciBsYXllciwgX2ksIF9sZW4sIF9yZXN1bHRzO1xuICAgIGlmIChsYXllcnMgPT0gbnVsbCkge1xuICAgICAgbGF5ZXJzID0gW107XG4gICAgfVxuICAgIHRoaXMuY2xlYXIoKTtcbiAgICBfcmVzdWx0cyA9IFtdO1xuICAgIGZvciAoX2kgPSAwLCBfbGVuID0gbGF5ZXJzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XG4gICAgICBsYXllciA9IGxheWVyc1tfaV07XG4gICAgICBfcmVzdWx0cy5wdXNoKGxheWVyLnJlbmRlcih0aGlzLmN0eCkpO1xuICAgIH1cbiAgICByZXR1cm4gX3Jlc3VsdHM7XG4gIH07XG5cbiAgcmV0dXJuIENvbnRleHQyZDtcblxufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBDb250ZXh0MmQ7XG5cbi8qXG4vL0Agc291cmNlTWFwcGluZ1VSTD0yZC5tYXBcbiovXG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4zXG52YXIgRVJST1JTLCBicm93c2VyUHJlZml4LCBwcmVmaXgsIHVzZXJBZ2VudDtcblxucHJlZml4ID0gZnVuY3Rpb24obmFtZSkge1xuICBpZiAoYnJvd3NlclByZWZpeCAhPT0gXCJcIikge1xuICAgIG5hbWUgPSBuYW1lLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgbmFtZS5zbGljZSgxKTtcbiAgfVxuICByZXR1cm4gYnJvd3NlclByZWZpeCArIG5hbWU7XG59O1xuXG51c2VyQWdlbnQgPSBuYXZpZ2F0b3IudXNlckFnZW50O1xuXG5icm93c2VyUHJlZml4ID0gKHVzZXJBZ2VudC5tYXRjaCgvb3BlcmEvaSkgJiYgXCJvXCIpIHx8ICh1c2VyQWdlbnQubWF0Y2goL3dlYmtpdC9pKSAmJiBcIndlYmtpdFwiKSB8fCAodXNlckFnZW50Lm1hdGNoKC9tc2llL2kpICYmIFwibXNcIikgfHwgKHVzZXJBZ2VudC5tYXRjaCgvbW96aWxsYS9pKSAmJiBcIm1velwiKSB8fCBcIlwiO1xuXG5GdW5jdGlvbi5wcm90b3R5cGUucHJvcGVydHkgPSBmdW5jdGlvbihwcm9wLCBkZXNjKSB7XG4gIHJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcy5wcm90b3R5cGUsIHByb3AsIGRlc2MpO1xufTtcblxuaWYgKHR5cGVvZiB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lciAhPT0gXCJmdW5jdGlvblwiKSB7XG4gIEhUTUxFbGVtZW50LnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24odHlwZSwgY2FsbGJhY2ssIHVzZUNhcHR1cmUpIHtcbiAgICByZXR1cm4gYXR0YWNoRXZlbnQoXCJvblwiICsgdHlwZSwgY2FsbGJhY2spO1xuICB9O1xufVxuXG4vKlxud2luZG93Lm9uRW50ZXJGcmFtZVxuKi9cblxuXG53aW5kb3cub25FbnRlckZyYW1lID0gKGZ1bmN0aW9uKCkge1xuICByZXR1cm4gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fCB3aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IHdpbmRvdy5tb3pSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm9SZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHwgd2luZG93Lm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8IGZ1bmN0aW9uKGNhbGxiYWNrKSB7XG4gICAgcmV0dXJuIHdpbmRvdy5zZXRUaW1lb3V0KGNhbGxiYWNrLCAxMDAwIC8gd2luZG93Ll9GUFMpO1xuICB9O1xufSkoKTtcblxuLypcbkNoZWNraW5nIGZvciBhYmlsaXR5IHRvIHdvcmtcbiovXG5cblxuRVJST1JTID0gW107XG5cbmlmICghT2JqZWN0LmRlZmluZVByb3BlcnR5KSB7XG4gIEVSUk9SUy5hcHBlbmQoXCJCcm93c2VyIGRvZXNudCBzdXBwb3J0IE9iamVjdC5kZWZpbmVQcm9wZXJ0eS5cIik7XG59XG5cbmlmICghZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKS5nZXRDb250ZXh0KSB7XG4gIEVSUk9SUy5hcHBlbmQoXCJCcm93c2VyIGRvZXNudCBzdXBwb3J0IDxjYW52YXM+IGFuZCB0aGUgQ2FudmFzMkQgQVBJLlwiKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIC8qXG4gICovXG5cbiAgRVJST1JTOiBFUlJPUlMsXG4gIC8qXG4gIEJyb3dzZXIncyB1c2VyLWFnZW50IHN0cmluZ1xuICBAYXR0cmlidXRlIHVzZXJBZ2VudFxuICBAdHlwZSB7U3RyaW5nfVxuICBAc3RhdGljXG4gIEByZWFkb25seVxuICAqL1xuXG4gIHVzZXJBZ2VudDogdXNlckFnZW50LFxuICAvKlxuICBEZXZpY2Ugc3VwcG9ydHMgdG91Y2ggZXZlbnRzP1xuICBAYXR0cmlidXRlIHRvdWNoXG4gIEB0eXBlIHtCb29sZWFufVxuICBAc3RhdGljXG4gIEByZWFkb25seVxuICAqL1xuXG4gIHRvdWNoOiBcIm9udG91Y2hzdGFydFwiIGluIHdpbmRvdyxcbiAgLypcbiAgRGV2aWNlIHN1cHBvcnRzIFJldGluYSBEaXNwbGF5P1xuICBAYXR0cmlidXRlIHJldGluYVxuICBAdHlwZSB7Qm9vbGVhbn1cbiAgQHN0YXRpY1xuICBAcmVhZG9ubHlcbiAgKi9cblxuICByZXRpbmE6IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvID4gMSB8fCB3aW5kb3cubWF0Y2hNZWRpYShcIihtaW4tcmVzb2x1dGlvbjogMS4xZHBweClcIikubWF0Y2hlcyxcbiAgaW1hZ2VTbW9vdGhpbmdFbmFibGVkOiBwcmVmaXgoXCJpbWFnZVNtb290aGluZ0VuYWJsZWRcIilcbn07XG5cbi8qXG4vL0Agc291cmNlTWFwcGluZ1VSTD1zdXBwb3J0Lm1hcFxuKi9cbiIsIi8vIEdlbmVyYXRlZCBieSBDb2ZmZWVTY3JpcHQgMS42LjNcbm1vZHVsZS5leHBvcnRzID0ge1xuICBNYXRyaXgyRDogcmVxdWlyZShcIi4vbWF0cml4MmRcIiksXG4gIFZlY3RvcjJEOiByZXF1aXJlKFwiLi92ZWN0b3IyZFwiKSxcbiAgVVVJRDogcmVxdWlyZShcIi4vdXVpZFwiKSxcbiAgTWF0aDogcmVxdWlyZShcIi4vbWF0aFwiKVxufTtcblxuLypcbi8vQCBzb3VyY2VNYXBwaW5nVVJMPWV4cG9ydHMubWFwXG4qL1xuIiwiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjYuM1xuLypcbk1hdGhlbWF0aWNhbCBmdW5jdGlvbnNcblxuQG5vdGUgR2FtZUNvcmUuZXhwb3J0cy5NYXRoLk1hdGhcblxuQHNlZSBodHRwOi8vZG9jcy5jbG9zdXJlLWxpYnJhcnkuZ29vZ2xlY29kZS5jb20vZ2l0LWhpc3RvcnkvNDE4ZWYyMGIyOWU4ZjNlYmI1MTIxMjY2ZWM3MjA2YWU2OTQzZDI4ZC9jbG9zdXJlX2dvb2dfbWF0aF9tYXRoLmpzLnNvdXJjZS5odG1sXG4qL1xuXG52YXIgTWF0aGVtYXRpY3M7XG5cbk1hdGhlbWF0aWNzID0gKGZ1bmN0aW9uKCkge1xuICBmdW5jdGlvbiBNYXRoZW1hdGljcygpIHt9XG5cbiAgLypcbiAgQ2xhbXBpbmcgYSBudW1iZXIgaW50byBhIGxpbWl0c1xuICBcbiAgQG1ldGhvZCBjbGFtcFxuICBAcGFyYW0ge051bWJlcn0gbnVtXG4gIEBwYXJhbSB7TnVtYmVyfSBtaW5cbiAgQHBhcmFtIHtOdW1iZXJ9IG1heFxuICBAcmV0dXJuIHtOdW1iZXJ9XG4gICovXG5cblxuICBNYXRoZW1hdGljcy5jbGFtcCA9IGZ1bmN0aW9uKG51bSwgbWluLCBtYXgpIHtcbiAgICByZXR1cm4gTWF0aC5taW4oTWF0aC5tYXgobnVtLCBtaW4pLCBtYXgpO1xuICB9O1xuXG4gIC8qXG4gIEFsaWFzIHRvIEBjbGFtcChudW0sIDAsIDEpXG4gIFxuICBAbWV0aG9kIGNsYW1wMDFcbiAgQHBhcmFtIHtOdW1iZXJ9IG51bVxuICBAcmV0dXJuIHtOdW1iZXJ9XG4gICovXG5cblxuICBNYXRoZW1hdGljcy5jbGFtcDAxID0gZnVuY3Rpb24obnVtKSB7XG4gICAgcmV0dXJuIHRoaXMuY2xhbXAobnVtLCAwLCAxKTtcbiAgfTtcblxuICAvKlxuICBSZXR1cm5zIGEgcmFuZG9tIGludGVnZXIgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICRtaW4gYW5kIGxlc3MgdGhhbiAkbWF4LlxuICBcbiAgQHBhcmFtIHtOdW1iZXJ9IGEgIFRoZSBsb3dlciBib3VuZCBmb3IgdGhlIHJhbmRvbSBpbnRlZ2VyIGluY2x1c2l2ZSAoZGVmYXVsdD0wKS5cbiAgQHBhcmFtIHtOdW1iZXJ9IGEgIFRoZSB1cHBlciBib3VuZCBmb3IgdGhlIHJhbmRvbSBpbnRlZ2VyIGV4bHVzaXZlIChkZWZhdWx0PTEwMDApLlxuICBAcmV0dXJuIHtOdW1iZXJ9IEEgcmFuZG9tIGludGVnZXIgTiBzdWNoIHRoYXQgJG1pbiA8PSBOIDwgJG1heC5cbiAgKi9cblxuXG4gIE1hdGhlbWF0aWNzLnJhbmRvbUludCA9IGZ1bmN0aW9uKG1pbiwgbWF4KSB7XG4gICAgaWYgKG1pbiA9PSBudWxsKSB7XG4gICAgICBtaW4gPSAwO1xuICAgIH1cbiAgICBpZiAobWF4ID09IG51bGwpIHtcbiAgICAgIG1heCA9IDEwMDtcbiAgICB9XG4gICAgcmV0dXJuIE1hdGguZmxvb3IobWluICsgTWF0aC5yYW5kb20oKSAqIChtYXggLSBtaW4pKTtcbiAgfTtcblxuICAvKlxuICBUaGUgJSBvcGVyYXRvciBpbiBKYXZhU2NyaXB0IHJldHVybnMgdGhlIHJlbWFpbmRlciBvZiBhIC8gYiwgYnV0IGRpZmZlcnMgZnJvbVxuICBzb21lIG90aGVyIGxhbmd1YWdlcyBpbiB0aGF0IHRoZSByZXN1bHQgd2lsbCBoYXZlIHRoZSBzYW1lIHNpZ24gYXMgdGhlXG4gIGRpdmlkZW5kLiBGb3IgZXhhbXBsZSwgLTEgJSA4ID09IC0xLCB3aGVyZWFzIGluIHNvbWUgb3RoZXIgbGFuZ3VhZ2VzXG4gIChzdWNoIGFzIFB5dGhvbikgdGhlIHJlc3VsdCB3b3VsZCBiZSA3LiBUaGlzIGZ1bmN0aW9uIGVtdWxhdGVzIHRoZSBtb3JlXG4gIGNvcnJlY3QgbW9kdWxvIGJlaGF2aW9yLCB3aGljaCBpcyB1c2VmdWwgZm9yIGNlcnRhaW4gYXBwbGljYXRpb25zIHN1Y2ggYXNcbiAgY2FsY3VsYXRpbmcgYW4gb2Zmc2V0IGluZGV4IGluIGEgY2lyY3VsYXIgbGlzdC5cbiAgIFxuICBAcGFyYW0ge251bWJlcn0gYSBUaGUgZGl2aWRlbmQuXG4gIEBwYXJhbSB7bnVtYmVyfSBiIFRoZSBkaXZpc29yLlxuICBAcmV0dXJuIHtudW1iZXJ9IGEgJSBiIHdoZXJlIHRoZSByZXN1bHQgaXMgYmV0d2VlbiAwIGFuZCBiIChlaXRoZXIgMCA8PSB4IDwgYlxuICAgIG9yIGIgPCB4IDw9IDAsIGRlcGVuZGluZyBvbiB0aGUgc2lnbiBvZiBiKS5cbiAgKi9cblxuXG4gIE1hdGhlbWF0aWNzLm1vZHVsbyA9IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICB2YXIgcjtcbiAgICByID0gYSAlIGI7XG4gICAgaWYgKHIgKiBiIDwgMCkge1xuICAgICAgcmV0dXJuIHIgKyBiO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcjtcbiAgICB9XG4gIH07XG5cbiAgLypcbiAgUGVyZm9ybXMgbGluZWFyIGludGVycG9sYXRpb24gYmV0d2VlbiB2YWx1ZXMgYSBhbmQgYi4gUmV0dXJucyB0aGUgdmFsdWVcbiAgYmV0d2VlbiBhIGFuZCBiIHByb3BvcnRpb25hbCB0byB4ICh3aGVuIHggaXMgYmV0d2VlbiAwIGFuZCAxLiBXaGVuIHggaXNcbiAgb3V0c2lkZSB0aGlzIHJhbmdlLCB0aGUgcmV0dXJuIHZhbHVlIGlzIGEgbGluZWFyIGV4dHJhcG9sYXRpb24pLlxuICBcbiAgQHBhcmFtIHtudW1iZXJ9IGEgQSBudW1iZXIuXG4gIEBwYXJhbSB7bnVtYmVyfSBiIEEgbnVtYmVyLlxuICBAcGFyYW0ge251bWJlcn0geCBUaGUgcHJvcG9ydGlvbiBiZXR3ZWVuIGEgYW5kIGIuXG4gIEByZXR1cm4ge251bWJlcn0gVGhlIGludGVycG9sYXRlZCB2YWx1ZSBiZXR3ZWVuIGEgYW5kIGIuXG4gICovXG5cblxuICBNYXRoZW1hdGljcy5sZXJwID0gZnVuY3Rpb24oYSwgYiwgeCkge1xuICAgIHJldHVybiBhICsgeCAqIChiIC0gYSk7XG4gIH07XG5cbiAgLypcbiAgVGVzdHMgd2hldGhlciB0aGUgdHdvIHZhbHVlcyBhcmUgZXF1YWwgdG8gZWFjaCBvdGhlciwgd2l0aGluIGEgY2VydGFpblxuICB0b2xlcmFuY2UgdG8gYWRqdXN0IGZvciBmbG9hdGluZyBwb3VudCBlcnJvcnMuXG4gIFxuICBAcGFyYW0ge051bWJlcn0gYSBBIG51bWJlci5cbiAgQHBhcmFtIHtOdW1iZXJ9IGIgQSBudW1iZXIuXG4gIEBwYXJhbSB7TnVtYmVyPX0gb3B0X3RvbGVyYW5jZSBPcHRpb25hbCB0b2xlcmFuY2UgcmFuZ2UuXG4gICAgICBEZWZhdWx0cyB0byAwLjAwMDAwMS4gSWYgc3BlY2lmaWVkLCBzaG91bGQgYmUgZ3JlYXRlciB0aGFuIDAuXG4gIEByZXR1cm4ge0Jvb2xlYW59IFdoZXRoZXIgJGEgYW5kICRiIGFyZSBuZWFybHkgZXF1YWwuXG4gICovXG5cblxuICBNYXRoZW1hdGljcy5uZWFybHlFcXVhbHMgPSBmdW5jdGlvbihhLCBiLCBvcHRfdG9sZXJhbmNlKSB7XG4gICAgaWYgKG9wdF90b2xlcmFuY2UgPT0gbnVsbCkge1xuICAgICAgb3B0X3RvbGVyYW5jZSA9IDAuMDAwMDAxO1xuICAgIH1cbiAgICByZXR1cm4gTWF0aC5hYnMoYSAtIGIpIDw9IG9wdF90b2xlcmFuY2U7XG4gIH07XG5cbiAgcmV0dXJuIE1hdGhlbWF0aWNzO1xuXG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IE1hdGhlbWF0aWNzO1xuXG4vKlxuLy9AIHNvdXJjZU1hcHBpbmdVUkw9bWF0aC5tYXBcbiovXG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4zXG4vKlxuMkQgTWF0cml4IG1hbmlwdWxhdGlvbnNcblxuQG5vdGUgR2FtZUNvcmUuZXhwb3J0cy5NYXRoLk1hdHJpeDJEXG4qL1xuXG52YXIgTWF0cml4MkQ7XG5cbk1hdHJpeDJEID0gKGZ1bmN0aW9uKCkge1xuICAvKlxuICBCYXNlZCBvbiBbRWFzZWxKU10oaHR0cHM6Ly9naXRodWIuY29tL0NyZWF0ZUpTL0Vhc2VsSlMvKSBNYXRyaXgyRCBpbXBsZW1lbnRhdGlvbi5cbiAgXG4gIEBjbGFzcyBNYXRyaXgyRFxuICBAY29uc3RydWN0b3JcbiAgXG4gIEBwYXJhbSB7TnVtYmVyfSBtMTFcbiAgQHBhcmFtIHtOdW1iZXJ9IG0xMlxuICBAcGFyYW0ge051bWJlcn0gbTIxXG4gIEBwYXJhbSB7TnVtYmVyfSBtMjJcbiAgQHBhcmFtIHtOdW1iZXJ9IGR4XG4gIEBwYXJhbSB7TnVtYmVyfSBkeVxuICAqL1xuXG4gIGZ1bmN0aW9uIE1hdHJpeDJEKG0xMSwgbTEyLCBtMjEsIG0yMiwgZHgsIGR5KSB7XG4gICAgaWYgKG0xMSAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5tMTEgPSBtMTE7XG4gICAgfVxuICAgIHRoaXMubTEyID0gbTEyIHx8IDA7XG4gICAgdGhpcy5tMjEgPSBtMjEgfHwgMDtcbiAgICBpZiAobTIyICE9PSBudWxsKSB7XG4gICAgICB0aGlzLm0yMiA9IG0yMjtcbiAgICB9XG4gICAgdGhpcy5keCA9IGR4IHx8IDA7XG4gICAgdGhpcy5keSA9IGR5IHx8IDA7XG4gIH1cblxuICAvKlxuICBHZW5lcmF0ZXMgbWF0cml4IHByb3BlcnRpZXMgZnJvbSB0aGUgc3BlY2lmaWVkIGRpc3BsYXkgb2JqZWN0IHRyYW5zZm9ybSBwcm9wZXJ0aWVzLCBhbmQgYXBwZW5kcyB0aGVtIHdpdGggdGhpcyBtYXRyaXguXG4gIEZvciBleGFtcGxlLCB5b3UgY2FuIHVzZSB0aGlzIHRvIGdlbmVyYXRlIG0xMSBtYXRyaXggZnJvbSBtMTEgZGlzcGxheSBvYmplY3Q6IHZhciBtdHggPSBuZXcgTWF0cml4MkQoKTtcbiAgbXR4LmFwcGVuZFRyYW5zZm9ybShvLngsIG8ueSwgby5zY2FsZVgsIG8uc2NhbGVZLCBvLnJvdGF0aW9uKTtcbiAgQG1ldGhvZCBhcHBlbmRUcmFuc2Zvcm1cbiAgQHBhcmFtIHtOdW1iZXJ9IHhcbiAgQHBhcmFtIHtOdW1iZXJ9IHlcbiAgQHBhcmFtIHtOdW1iZXJ9IHNjYWxlWFxuICBAcGFyYW0ge051bWJlcn0gc2NhbGVZXG4gIEBwYXJhbSB7TnVtYmVyfSByb3RhdGlvblxuICBAcGFyYW0ge051bWJlcn0gc2tld1hcbiAgQHBhcmFtIHtOdW1iZXJ9IHNrZXdZXG4gIEBwYXJhbSB7TnVtYmVyfSBwaXZvdFggT3B0aW9uYWwuXG4gIEBwYXJhbSB7TnVtYmVyfSBwaXZvdFkgT3B0aW9uYWwuXG4gIEByZXR1cm4ge01hdHJpeDJEfSBUaGlzIG1hdHJpeC4gVXNlZnVsIGZvciBjaGFpbmluZyBtZXRob2QgY2FsbHMuXG4gICovXG5cblxuICBNYXRyaXgyRC5wcm90b3R5cGUuYXBwZW5kVHJhbnNmb3JtID0gZnVuY3Rpb24oeCwgeSwgc2NhbGVYLCBzY2FsZVksIHJvdGF0aW9uLCBza2V3WCwgc2tld1ksIHBpdm90WCwgcGl2b3RZKSB7XG4gICAgdmFyIGNvcywgciwgc2luO1xuICAgIGNvcyA9IHZvaWQgMDtcbiAgICBzaW4gPSB2b2lkIDA7XG4gICAgciA9IHZvaWQgMDtcbiAgICBpZiAocm90YXRpb24gJSAzNjApIHtcbiAgICAgIHIgPSByb3RhdGlvbiAqIE1hdHJpeDJELkRFR19UT19SQUQ7XG4gICAgICBjb3MgPSBNYXRoLmNvcyhyKTtcbiAgICAgIHNpbiA9IE1hdGguc2luKHIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb3MgPSAxO1xuICAgICAgc2luID0gMDtcbiAgICB9XG4gICAgaWYgKHNrZXdYIHx8IHNrZXdZKSB7XG4gICAgICBza2V3WCAqPSBNYXRyaXgyRC5ERUdfVE9fUkFEO1xuICAgICAgc2tld1kgKj0gTWF0cml4MkQuREVHX1RPX1JBRDtcbiAgICAgIHRoaXMuYXBwZW5kKE1hdGguY29zKHNrZXdZKSwgTWF0aC5zaW4oc2tld1kpLCAtTWF0aC5zaW4oc2tld1gpLCBNYXRoLmNvcyhza2V3WCksIHgsIHkpO1xuICAgICAgdGhpcy5hcHBlbmQoY29zICogc2NhbGVYLCBzaW4gKiBzY2FsZVgsIC1zaW4gKiBzY2FsZVksIGNvcyAqIHNjYWxlWSwgMCwgMCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYXBwZW5kKGNvcyAqIHNjYWxlWCwgc2luICogc2NhbGVYLCAtc2luICogc2NhbGVZLCBjb3MgKiBzY2FsZVksIHgsIHkpO1xuICAgIH1cbiAgICBpZiAocGl2b3RYIHx8IHBpdm90WSkge1xuICAgICAgdGhpcy5keCAtPSBwaXZvdFggKiB0aGlzLm0xMSArIHBpdm90WSAqIHRoaXMubTIxO1xuICAgICAgdGhpcy5keSAtPSBwaXZvdFggKiB0aGlzLm0xMiArIHBpdm90WSAqIHRoaXMubTIyO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKlxuICBBcHBlbmRzIHRoZSBzcGVjaWZpZWQgbWF0cml4IHByb3BlcnRpZXMgd2l0aCB0aGlzIG1hdHJpeC4gQWxsIHBhcmFtZXRlcnMgYXJlIHJlcXVpcmVkLlxuICBAbWV0aG9kIGFwcGVuZFxuICBAcGFyYW0ge051bWJlcn0gbTExXG4gIEBwYXJhbSB7TnVtYmVyfSBtMTJcbiAgQHBhcmFtIHtOdW1iZXJ9IG0yMVxuICBAcGFyYW0ge051bWJlcn0gbTIyXG4gIEBwYXJhbSB7TnVtYmVyfSBkeFxuICBAcGFyYW0ge051bWJlcn0gZHlcbiAgQHJldHVybiB7TWF0cml4MkR9IFRoaXMgbWF0cml4LiBVc2VmdWwgZm9yIGNoYWluaW5nIG1ldGhvZCBjYWxscy5cbiAgKi9cblxuXG4gIE1hdHJpeDJELnByb3RvdHlwZS5hcHBlbmQgPSBmdW5jdGlvbihtMTEsIG0xMiwgbTIxLCBtMjIsIGR4LCBkeSkge1xuICAgIHZhciBhMSwgYjEsIGMxLCBkMTtcbiAgICBhMSA9IHRoaXMubTExO1xuICAgIGIxID0gdGhpcy5tMTI7XG4gICAgYzEgPSB0aGlzLm0yMTtcbiAgICBkMSA9IHRoaXMubTIyO1xuICAgIHRoaXMubTExID0gbTExICogYTEgKyBtMTIgKiBjMTtcbiAgICB0aGlzLm0xMiA9IG0xMSAqIGIxICsgbTEyICogZDE7XG4gICAgdGhpcy5tMjEgPSBtMjEgKiBhMSArIG0yMiAqIGMxO1xuICAgIHRoaXMubTIyID0gbTIxICogYjEgKyBtMjIgKiBkMTtcbiAgICB0aGlzLmR4ID0gZHggKiBhMSArIGR5ICogYzEgKyB0aGlzLmR4O1xuICAgIHRoaXMuZHkgPSBkeCAqIGIxICsgZHkgKiBkMSArIHRoaXMuZHk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLypcbiAgSW52ZXJ0cyB0aGUgbWF0cml4LCBjYXVzaW5nIGl0IHRvIHBlcmZvcm0gdGhlIG9wcG9zaXRlIHRyYW5zZm9ybWF0aW9uLlxuICBAbWV0aG9kIGludmVydFxuICBAcmV0dXJuIHtNYXRyaXgyRH0gdGhpc1xuICAqL1xuXG5cbiAgTWF0cml4MkQucHJvdG90eXBlLmludmVydCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBhMSwgYjEsIGMxLCBkMSwgbiwgdHgxO1xuICAgIGExID0gdGhpcy5tMTE7XG4gICAgYjEgPSB0aGlzLm0xMjtcbiAgICBjMSA9IHRoaXMubTIxO1xuICAgIGQxID0gdGhpcy5tMjI7XG4gICAgdHgxID0gdGhpcy5keDtcbiAgICBuID0gYTEgKiBkMSAtIGIxICogYzE7XG4gICAgdGhpcy5tMTEgPSBkMSAvIG47XG4gICAgdGhpcy5tMTIgPSAtYjEgLyBuO1xuICAgIHRoaXMubTIxID0gLWMxIC8gbjtcbiAgICB0aGlzLm0yMiA9IGExIC8gbjtcbiAgICB0aGlzLmR4ID0gKGMxICogdGhpcy5keSAtIGQxICogdHgxKSAvIG47XG4gICAgdGhpcy5keSA9IC0oYTEgKiB0aGlzLmR5IC0gYjEgKiB0eDEpIC8gbjtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKlxuICBDbG9uZSBNYXRyaXgyRCBpbnN0YW5jZVxuICBAcmV0dXJuIHtNYXRyaXgyRH1cbiAgKi9cblxuXG4gIE1hdHJpeDJELnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgTWF0cml4MkQodGhpcy5tMTEsIHRoaXMubTEyLCB0aGlzLm0yMSwgdGhpcy5tMjIsIHRoaXMuZHgsIHRoaXMuZHkpO1xuICB9O1xuXG4gIC8qXG4gIFJlc2V0IG1hdHJpeCB0byBpdCdzIGlkZW50aXR5XG4gIEByZXR1cm4ge01hdHJpeDJEfSB0aGlzXG4gICovXG5cblxuICBNYXRyaXgyRC5wcm90b3R5cGUuaWRlbnRpdHkgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm0xMSA9IHRoaXMubTIyID0gMTtcbiAgICB0aGlzLm0xMiA9IHRoaXMubTIxID0gdGhpcy5keCA9IHRoaXMuZHkgPSAwO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qICAgICAgICAgICBcbiAgTXVsdGlwbGllciBmb3IgY29udmVydGluZyBkZWdyZWVzIHRvIHJhZGlhbnMuIFVzZWQgaW50ZXJuYWxseSBieSBNYXRyaXgyRC5cbiAgXG4gIEBhdHRyaWJ1dGUgREVHX1RPX1JBRFxuICBAc3RhdGljXG4gIEByZWFkb25seVxuICBAcmV0dXJuIHtOdW1iZXJ9XG4gICovXG5cblxuICBNYXRyaXgyRC5ERUdfVE9fUkFEID0gTWF0aC5QSSAvIDE4MDtcblxuICBNYXRyaXgyRC5pZGVudGl0eSA9IG5ldyBNYXRyaXgyRCgxLCAwLCAwLCAxLCAwLCAwKTtcblxuICByZXR1cm4gTWF0cml4MkQ7XG5cbn0pKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gTWF0cml4MkQ7XG5cbi8qXG4vL0Agc291cmNlTWFwcGluZ1VSTD1tYXRyaXgyZC5tYXBcbiovXG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4zXG4vKlxuVW5pcXVlIElEIGdlbmVyYXRvclxuXG5Abm90ZSBHYW1lQ29yZS5leHBvcnRzLk1hdGguVVVJRFxuKi9cblxudmFyIFVVSUQ7XG5cblVVSUQgPSAoZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIFVVSUQoKSB7fVxuXG4gIC8qXG4gIEBtZXRob2QgZ2VuZXJhdGVVbmlxdWVJZFxuICBAcmV0dXJuIHtTdHJpbmd9XG4gICovXG5cblxuICBVVUlELmdlbmVyYXRlVW5pcXVlSWQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gXCJnYy1cIiArIHRoaXMudXVpZCgpO1xuICB9O1xuXG4gIC8qXG4gIEBtZXRob2QgdXVpZFxuICBAcmV0dXJuIHtTdHJpbmd9XG4gICovXG5cblxuICBVVUlELnV1aWQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJ3h4eHh4eHh4LXh4eHgtNHh4eC15eHh4LXh4eHh4eHh4eHh4eCcucmVwbGFjZSgvW3h5XS9nLCBmdW5jdGlvbihjKSB7XG4gICAgICB2YXIgciwgdjtcbiAgICAgIHIgPSBNYXRoLnJhbmRvbSgpICogMTYgfCAwO1xuICAgICAgdiA9IGMgPT09ICd4JyA/IHIgOiByICYgMHgzIHwgMHg4O1xuICAgICAgcmV0dXJuIHYudG9TdHJpbmcoMTYpO1xuICAgIH0pO1xuICB9O1xuXG4gIHJldHVybiBVVUlEO1xuXG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFVVSUQ7XG5cbi8qXG4vL0Agc291cmNlTWFwcGluZ1VSTD11dWlkLm1hcFxuKi9cbiIsIi8vIEdlbmVyYXRlZCBieSBDb2ZmZWVTY3JpcHQgMS42LjNcbi8qXG4yRCBWZWN0b3IgbWFuaXB1bGF0aW9uc1xuXG5Abm90ZSBHYW1lQ29yZS5leHBvcnRzLk1hdGguVmVjdG9yMkRcbiovXG5cbnZhciBWZWN0b3IyZDtcblxuVmVjdG9yMmQgPSAoZnVuY3Rpb24oKSB7XG4gIGZ1bmN0aW9uIFZlY3RvcjJkKHgsIHkpIHtcbiAgICB0aGlzLnggPSB4ICE9IG51bGwgPyB4IDogMDtcbiAgICB0aGlzLnkgPSB5ICE9IG51bGwgPyB5IDogMDtcbiAgICAvKlxuICAgIEdldCB0aGUgbWFnbml0dWRlIG9mIHRoaXMgdmVjdG9yXG4gICAgQGF0dHJpYnV0ZSBsZW5ndGhcbiAgICBAcmVhZG9ubHlcbiAgICAqL1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIFwibGVuZ3RoXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBNYXRoLnNxcnQoKHRoaXMueCAqIHRoaXMueCkgKyAodGhpcy55ICogdGhpcy55KSk7XG4gICAgICB9LFxuICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgLypcbiAgICBHZXQgdGhpcyB2ZWN0b3Igd2l0aCBhIG1hZ25pdHVkZSBvZiAxLlxuICAgIEBhdHRyaWJ1dGUgbm9ybWFsaXplZFxuICAgIEByZWFkb25seVxuICAgICovXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJub3JtYWxpemVkXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBtYWduaXR1ZGU7XG4gICAgICAgIG1hZ25pdHVkZSA9IHRoaXMubGVuZ3RoO1xuICAgICAgICByZXR1cm4gbmV3IFZlY3RvcjJkKHRoaXMueCAvIG1hZ25pdHVkZSwgdGhpcy55IC8gbWFnbml0dWRlKTtcbiAgICAgIH0sXG4gICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgfVxuXG4gIC8qXG4gIEBtZXRob2Qgc2V0XG4gIEBwYXJhbSB7TnVtYmVyfSB4XG4gIEBwYXJhbSB7TnVtYmVyfSB5XG4gIEByZXR1cm4ge1ZlY3RvcjJkfVxuICAqL1xuXG5cbiAgVmVjdG9yMmQucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uKHgsIHkpIHtcbiAgICB0aGlzLnggPSB4O1xuICAgIHRoaXMueSA9IHk7XG4gIH07XG5cbiAgLypcbiAgQG1ldGhvZCBzdW1cbiAgQHBhcmFtIHtWZWN0b3IyZH0gdmVjdG9yMmRcbiAgQHJldHVybiB7VmVjdG9yMmR9XG4gICovXG5cblxuICBWZWN0b3IyZC5wcm90b3R5cGUuc3VidHJhY3QgPSBmdW5jdGlvbih2ZWN0b3IyZCkge1xuICAgIHRoaXMueCAtPSB2ZWN0b3IyZC54O1xuICAgIHJldHVybiB0aGlzLnkgLT0gdmVjdG9yMmQueTtcbiAgfTtcblxuICAvKlxuICBAbWV0aG9kIHN1bVxuICBAcGFyYW0ge1ZlY3RvcjJkfSB2ZWN0b3IyZFxuICBAcmV0dXJuIHtWZWN0b3IyZH1cbiAgKi9cblxuXG4gIFZlY3RvcjJkLnByb3RvdHlwZS5zdW0gPSBmdW5jdGlvbih2ZWN0b3IyZCkge1xuICAgIHRoaXMueCArPSB2ZWN0b3IyZC54O1xuICAgIHJldHVybiB0aGlzLnkgKz0gdmVjdG9yMmQueTtcbiAgfTtcblxuICAvKlxuICBAbWV0aG9kIHNjYWxlXG4gIEBwYXJhbSB7TnVtYmVyfSB4IChvciB4IHkpXG4gIEBwYXJhbSB7TnVtYmVyfSB5XG4gIEByZXR1cm4ge1ZlY3RvcjJkfVxuICAqL1xuXG5cbiAgVmVjdG9yMmQucHJvdG90eXBlLnNjYWxlID0gZnVuY3Rpb24oeCwgeSkge1xuICAgIHRoaXMueCAqPSB4O1xuICAgIHJldHVybiB0aGlzLnkgKj0geSB8fCB4O1xuICB9O1xuXG4gIC8qXG4gIEBtZXRob2QgY2xvbmVcbiAgQHJldHVybiB7VmVjdG9yMmR9XG4gICovXG5cblxuICBWZWN0b3IyZC5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbmV3IFZlY3RvcjJkKHRoaXMueCwgdGhpcy55KTtcbiAgfTtcblxuICAvKlxuICBSZXR1cm4gdW5pdCB2ZWN0b3JcbiAgQHJldHVybiB7VmVjdG9yMmR9XG4gICovXG5cblxuICBWZWN0b3IyZC5wcm90b3R5cGUudW5pdCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgVmVjdG9yMmQoTWF0aC5jb3ModGhpcy54KSwgTWF0aC5zaW4odGhpcy55KSk7XG4gIH07XG5cbiAgLypcbiAgTm9ybWFsaXplIHRoaXMgdmVjdG9yXG4gIEByZXR1cm4ge1ZlY3RvcjJkfVxuICAqL1xuXG5cbiAgVmVjdG9yMmQucHJvdG90eXBlLm5vcm1hbGl6ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBub3JtYWw7XG4gICAgbm9ybWFsID0gdGhpcy5ub3JtYWxpemVkO1xuICAgIHRoaXMueCA9IG5vcm1hbC54O1xuICAgIHJldHVybiB0aGlzLnkgPSBub3JtYWwueTtcbiAgfTtcblxuICAvKlxuICBHZXQgdGhlIGRpc3RhbmNlIGJldHdlZW4gdGhpcyB2ZWN0b3IgYW5kIHRoZSBhcmd1bWVudCB2ZWN0b3JcbiAgQHBhcmFtIHtWZWN0b3IyZH0gdmVjdG9yXG4gIEByZXR1cm4ge051bWJlcn1cbiAgKi9cblxuXG4gIFZlY3RvcjJkLmRpc3RhbmNlID0gZnVuY3Rpb24odjEsIHYyKSB7XG4gICAgdmFyIHhkaWZmLCB5ZGlmZjtcbiAgICB4ZGlmZiA9IHYxLnggLSB2Mi54O1xuICAgIHlkaWZmID0gdjEueSAtIHYyLnk7XG4gICAgcmV0dXJuIE1hdGguc3FydCh4ZGlmZiAqIHhkaWZmICsgeWRpZmYgKiB5ZGlmZik7XG4gIH07XG5cbiAgLypcbiAgQG1ldGhvZCB0b1N0cmluZ1xuICBAcmV0dXJuIHtTdHJpbmd9XG4gICovXG5cblxuICBWZWN0b3IyZC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gXCIjPFZlY3RvcjJkIEB4PVwiICsgdGhpcy54ICsgXCIsIEB5PVwiICsgdGhpcy55ICsgXCI+XCI7XG4gIH07XG5cbiAgVmVjdG9yMmQuTEVGVCA9IG5ldyBWZWN0b3IyZCgtMSwgMCk7XG5cbiAgVmVjdG9yMmQuUklHSFQgPSBuZXcgVmVjdG9yMmQoMSwgMCk7XG5cbiAgVmVjdG9yMmQuVE9QID0gbmV3IFZlY3RvcjJkKDAsIC0xKTtcblxuICBWZWN0b3IyZC5CT1RUT00gPSBuZXcgVmVjdG9yMmQoMCwgMSk7XG5cbiAgcmV0dXJuIFZlY3RvcjJkO1xuXG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFZlY3RvcjJkO1xuXG4vKlxuLy9AIHNvdXJjZU1hcHBpbmdVUkw9dmVjdG9yMmQubWFwXG4qL1xuIiwiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjYuM1xudmFyIENvbnRhaW5lciwgV2lkZ2V0LFxuICBfX2hhc1Byb3AgPSB7fS5oYXNPd25Qcm9wZXJ0eSxcbiAgX19leHRlbmRzID0gZnVuY3Rpb24oY2hpbGQsIHBhcmVudCkgeyBmb3IgKHZhciBrZXkgaW4gcGFyZW50KSB7IGlmIChfX2hhc1Byb3AuY2FsbChwYXJlbnQsIGtleSkpIGNoaWxkW2tleV0gPSBwYXJlbnRba2V5XTsgfSBmdW5jdGlvbiBjdG9yKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gY2hpbGQ7IH0gY3Rvci5wcm90b3R5cGUgPSBwYXJlbnQucHJvdG90eXBlOyBjaGlsZC5wcm90b3R5cGUgPSBuZXcgY3RvcigpOyBjaGlsZC5fX3N1cGVyX18gPSBwYXJlbnQucHJvdG90eXBlOyByZXR1cm4gY2hpbGQ7IH07XG5cbldpZGdldCA9IHJlcXVpcmUoXCIuL3dpZGdldFwiKTtcblxuLypcbkJhc2Ugd2lkZ2V0cyBjb250YWluZXJcbkBub3RlIEdhbWVDb3JlLmV4cG9ydHMudWkuQ29udGFpbmVyXG4qL1xuXG5cbkNvbnRhaW5lciA9IChmdW5jdGlvbihfc3VwZXIpIHtcbiAgX19leHRlbmRzKENvbnRhaW5lciwgX3N1cGVyKTtcblxuICBmdW5jdGlvbiBDb250YWluZXIob3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zID09IG51bGwpIHtcbiAgICAgIG9wdGlvbnMgPSB7fTtcbiAgICB9XG4gICAgQ29udGFpbmVyLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIG9wdGlvbnMpO1xuICAgIHRoaXMuY2hpbGRyZW4gPSB7fTtcbiAgfVxuXG4gIENvbnRhaW5lci5wcm90b3R5cGUuYWRkQ2hpbGQgPSBmdW5jdGlvbihjaGlsZCkge1xuICAgIGlmIChjaGlsZC5wYXJlbnQgPT09ICF0aGlzKSB7XG4gICAgICByZXR1cm4gY2hpbGQucGFyZW50ID0gdGhpcztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW5bY2hpbGQuaWRdID0gY2hpbGQ7XG4gICAgfVxuICB9O1xuXG4gIENvbnRhaW5lci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oY3R4KSB7XG4gICAgdmFyIGNoaWxkLCBjaWQsIF9yZWYsIF9yZXN1bHRzO1xuICAgIENvbnRhaW5lci5fX3N1cGVyX18ucmVuZGVyLmNhbGwodGhpcywgY3R4KTtcbiAgICBfcmVmID0gdGhpcy5jaGlsZHJlbjtcbiAgICBfcmVzdWx0cyA9IFtdO1xuICAgIGZvciAoY2lkIGluIF9yZWYpIHtcbiAgICAgIGNoaWxkID0gX3JlZltjaWRdO1xuICAgICAgX3Jlc3VsdHMucHVzaChjaGlsZC5yZW5kZXIoY3R4KSk7XG4gICAgfVxuICAgIHJldHVybiBfcmVzdWx0cztcbiAgfTtcblxuICByZXR1cm4gQ29udGFpbmVyO1xuXG59KShXaWRnZXQpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IENvbnRhaW5lcjtcblxuLypcbi8vQCBzb3VyY2VNYXBwaW5nVVJMPWNvbnRhaW5lci5tYXBcbiovXG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4zXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgV2lkZ2V0OiByZXF1aXJlKFwiLi93aWRnZXRcIiksXG4gIFN0YWdlOiByZXF1aXJlKFwiLi9zdGFnZVwiKSxcbiAgQ29udGFpbmVyOiByZXF1aXJlKFwiLi9jb250YWluZXJcIiksXG4gIFRleHQ6IHJlcXVpcmUoXCIuL3RleHRcIiksXG4gIGdlb21ldHJ5OiByZXF1aXJlKFwiLi9nZW9tZXRyeS9leHBvcnRzXCIpXG59O1xuXG4vKlxuLy9AIHNvdXJjZU1hcHBpbmdVUkw9ZXhwb3J0cy5tYXBcbiovXG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4zXG52YXIgQ2lyY2xlLCBXaWRnZXQsXG4gIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LFxuICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTtcblxuV2lkZ2V0ID0gcmVxdWlyZShcIi4uL3dpZGdldFwiKTtcblxuQ2lyY2xlID0gKGZ1bmN0aW9uKF9zdXBlcikge1xuICBfX2V4dGVuZHMoQ2lyY2xlLCBfc3VwZXIpO1xuXG4gIGZ1bmN0aW9uIENpcmNsZShvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMgPT0gbnVsbCkge1xuICAgICAgb3B0aW9ucyA9IHt9O1xuICAgIH1cbiAgICBDaXJjbGUuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgb3B0aW9ucyk7XG4gIH1cblxuICByZXR1cm4gQ2lyY2xlO1xuXG59KShXaWRnZXQpO1xuXG4vKlxuLy9AIHNvdXJjZU1hcHBpbmdVUkw9Y2lyY2xlLm1hcFxuKi9cbiIsIi8vIEdlbmVyYXRlZCBieSBDb2ZmZWVTY3JpcHQgMS42LjNcbm1vZHVsZS5leHBvcnRzID0ge1xuICBDaXJjbGU6IHJlcXVpcmUoXCIuL2NpcmNsZVwiKSxcbiAgUmVjdDogcmVxdWlyZShcIi4vcmVjdFwiKVxufTtcblxuLypcbi8vQCBzb3VyY2VNYXBwaW5nVVJMPWV4cG9ydHMubWFwXG4qL1xuIiwiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjYuM1xudmFyIFJlY3QsIFdpZGdldCxcbiAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksXG4gIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9O1xuXG5XaWRnZXQgPSByZXF1aXJlKFwiLi4vd2lkZ2V0XCIpO1xuXG5SZWN0ID0gKGZ1bmN0aW9uKF9zdXBlcikge1xuICBfX2V4dGVuZHMoUmVjdCwgX3N1cGVyKTtcblxuICBmdW5jdGlvbiBSZWN0KG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucyA9PSBudWxsKSB7XG4gICAgICBvcHRpb25zID0ge307XG4gICAgfVxuICAgIFJlY3QuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgb3B0aW9ucyk7XG4gIH1cblxuICByZXR1cm4gUmVjdDtcblxufSkoV2lkZ2V0KTtcblxuLypcbi8vQCBzb3VyY2VNYXBwaW5nVVJMPXJlY3QubWFwXG4qL1xuIiwiLy8gR2VuZXJhdGVkIGJ5IENvZmZlZVNjcmlwdCAxLjYuM1xudmFyIFN0YWdlLCBjb250YWluZXIsXG4gIF9faGFzUHJvcCA9IHt9Lmhhc093blByb3BlcnR5LFxuICBfX2V4dGVuZHMgPSBmdW5jdGlvbihjaGlsZCwgcGFyZW50KSB7IGZvciAodmFyIGtleSBpbiBwYXJlbnQpIHsgaWYgKF9faGFzUHJvcC5jYWxsKHBhcmVudCwga2V5KSkgY2hpbGRba2V5XSA9IHBhcmVudFtrZXldOyB9IGZ1bmN0aW9uIGN0b3IoKSB7IHRoaXMuY29uc3RydWN0b3IgPSBjaGlsZDsgfSBjdG9yLnByb3RvdHlwZSA9IHBhcmVudC5wcm90b3R5cGU7IGNoaWxkLnByb3RvdHlwZSA9IG5ldyBjdG9yKCk7IGNoaWxkLl9fc3VwZXJfXyA9IHBhcmVudC5wcm90b3R5cGU7IHJldHVybiBjaGlsZDsgfTtcblxuY29udGFpbmVyID0gcmVxdWlyZShcIi4uL3VpL2NvbnRhaW5lclwiKTtcblxuLypcblN0YWdlIGNvbnRhaW5lclxuQG5vdGUgR2FtZUNvcmUuZXhwb3J0cy51aS5TdGFnZVxuKi9cblxuXG5TdGFnZSA9IChmdW5jdGlvbihfc3VwZXIpIHtcbiAgX19leHRlbmRzKFN0YWdlLCBfc3VwZXIpO1xuXG4gIGZ1bmN0aW9uIFN0YWdlKG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucyA9PSBudWxsKSB7XG4gICAgICBvcHRpb25zID0ge307XG4gICAgfVxuICAgIFN0YWdlLl9fc3VwZXJfXy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMsIG9wdGlvbnMpO1xuICAgIHRoaXMueCA9IDA7XG4gICAgdGhpcy55ID0gMDtcbiAgfVxuXG4gIFN0YWdlLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbihjdHgpIHtcbiAgICB0aGlzLndpZHRoID0gY3R4LmNhbnZhcy53aWR0aDtcbiAgICB0aGlzLmhlaWdodCA9IGN0eC5jYW52YXMuaGVpZ2h0O1xuICAgIHJldHVybiBTdGFnZS5fX3N1cGVyX18ucmVuZGVyLmNhbGwodGhpcywgY3R4KTtcbiAgfTtcblxuICByZXR1cm4gU3RhZ2U7XG5cbn0pKGNvbnRhaW5lcik7XG5cbm1vZHVsZS5leHBvcnRzID0gU3RhZ2U7XG5cbi8qXG4vL0Agc291cmNlTWFwcGluZ1VSTD1zdGFnZS5tYXBcbiovXG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4zXG52YXIgQkFTRUxJTkUsIENvbG9yLCBERUZBVUxUX0FMSUdOLCBERUZBVUxUX0JBU0VMSU5FLCBERUZBVUxUX0NPTE9SLCBERUZBVUxUX0ZPTlQsIFRleHQsIFdpZGdldCxcbiAgX19oYXNQcm9wID0ge30uaGFzT3duUHJvcGVydHksXG4gIF9fZXh0ZW5kcyA9IGZ1bmN0aW9uKGNoaWxkLCBwYXJlbnQpIHsgZm9yICh2YXIga2V5IGluIHBhcmVudCkgeyBpZiAoX19oYXNQcm9wLmNhbGwocGFyZW50LCBrZXkpKSBjaGlsZFtrZXldID0gcGFyZW50W2tleV07IH0gZnVuY3Rpb24gY3RvcigpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGNoaWxkOyB9IGN0b3IucHJvdG90eXBlID0gcGFyZW50LnByb3RvdHlwZTsgY2hpbGQucHJvdG90eXBlID0gbmV3IGN0b3IoKTsgY2hpbGQuX19zdXBlcl9fID0gcGFyZW50LnByb3RvdHlwZTsgcmV0dXJuIGNoaWxkOyB9O1xuXG5XaWRnZXQgPSByZXF1aXJlKFwiLi93aWRnZXRcIik7XG5cbkNvbG9yID0gcmVxdWlyZShcIi4uL3V0aWxzL2NvbG9yXCIpO1xuXG4vKlxuT2JqZWN0LmRlZmluZVByb3BlcnR5IHRoaXMsIEJBU0VMSU5FXG5Ac3RhdGljXG4qL1xuXG5cbkJBU0VMSU5FID0ge1xuICAvKlxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkgdGhpcywgQkFTRUxJTkUuVE9QXG4gIEB0eXBlIHtTdHJpbmd9XG4gIEBzdGF0aWNcbiAgKi9cblxuICBUT1A6IFwidG9wXCIsXG4gIC8qXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSB0aGlzLCBCQVNFTElORS5IQU5HSU5HXG4gIEB0eXBlIHtTdHJpbmd9XG4gIEBzdGF0aWNcbiAgKi9cblxuICBIQU5HSU5HOiBcImhhbmdpbmdcIixcbiAgLypcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5IHRoaXMsIEJBU0VMSU5FLk1JRERMRVxuICBAdHlwZSB7U3RyaW5nfVxuICBAc3RhdGljXG4gICovXG5cbiAgTUlERExFOiBcIm1pZGRsZVwiLFxuICAvKlxuICBPYmplY3QuZGVmaW5lUHJvcGVydHkgdGhpcywgQkFTRUxJTkUuQUxQSEFCRVRJQ1xuICBAdHlwZSB7U3RyaW5nfVxuICBAc3RhdGljXG4gICovXG5cbiAgQUxQSEFCRVRJQzogXCJhbHBoYWJldGljXCIsXG4gIC8qXG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSB0aGlzLCBCQVNFTElORS5JREVPR1JBUEhJQ1xuICBAdHlwZSB7U3RyaW5nfVxuICBAc3RhdGljXG4gICovXG5cbiAgSURFT0dSQVBISUM6IFwiaWRlb2dyYXBoaWNcIixcbiAgLypcbiAgT2JqZWN0LmRlZmluZVByb3BlcnR5IHRoaXMsIEJBU0VMSU5FLkJPVFRPTVxuICBAdHlwZSB7U3RyaW5nfVxuICBAc3RhdGljXG4gICovXG5cbiAgQk9UVE9NOiBcImJvdHRvbVwiXG59O1xuXG5ERUZBVUxUX0ZPTlQgPSBcIk5vcm1hbCAxMnB4IFZlcmRhbmFcIjtcblxuREVGQVVMVF9DT0xPUiA9IG5ldyBDb2xvcihcInB1cnBsZVwiKTtcblxuREVGQVVMVF9BTElHTiA9IFwibGVmdFwiO1xuXG5ERUZBVUxUX0JBU0VMSU5FID0gQkFTRUxJTkUuVE9QO1xuXG4vKlxuQmFzZSBUZXh0IHdpZGdldFxuQG5vdGUgR2FtZUNvcmUuZXhwb3J0cy51aS5UZXh0XG4qL1xuXG5cblRleHQgPSAoZnVuY3Rpb24oX3N1cGVyKSB7XG4gIF9fZXh0ZW5kcyhUZXh0LCBfc3VwZXIpO1xuXG4gIC8qXG4gIEBjbGFzcyBUZXh0XG4gIEBleHRlbmRzIERpc3BsYXlPYmplY3RcbiAgXG4gIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIGFueSBhdHRyaWJ1dGUgbWF5IGJlIGluaXRpYWxpemVkIGJ5IG9wdGlvblxuICBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMudGV4dF0gZGVmYXVsdCAtIFwiXCJcbiAgQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLmZvbnRdIGRlZmF1bHQgLSBcIk5vcm1hbCAxMnB4IFZlcmRhbmFcIlxuICBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMuYWxpZ25dIGRlZmF1bHQgLSBcImxlZnRcIlxuICBAcGFyYW0ge1N0cmluZ30gW29wdGlvbnMuYmFzZWxpbmVdIGRlZmF1bHQgLSBKb3kuVGV4dC5CQVNFTElORS5UT1BcbiAgQHBhcmFtIHtTdHJpbmd9IFtvcHRpb25zLmNvbG9yXSBkZWZhdWx0IC0gIzAwMDAwMFxuICBcbiAgQGNvbnN0cnVjdG9yXG4gICovXG5cblxuICBmdW5jdGlvbiBUZXh0KG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucyA9PSBudWxsKSB7XG4gICAgICBvcHRpb25zID0ge307XG4gICAgfVxuICAgIFRleHQuX19zdXBlcl9fLmNvbnN0cnVjdG9yLmNhbGwodGhpcywgb3B0aW9ucyk7XG4gICAgLypcbiAgICBUZXh0IHRvIGJlIGRpc3BsYXllZFxuICAgIEBhdHRyaWJ1dGUgdGV4dFxuICAgIEBkZWZhdWx0IFwiXCJcbiAgICBAdHlwZSB7U3RyaW5nfVxuICAgICovXG5cbiAgICB0aGlzLnRleHQgPSBvcHRpb25zLnRleHQgfHwgXCJcIjtcbiAgICAvKlxuICAgIEZvbnQgZmFtaWx5IGFuZCBzaXplXG4gICAgQGF0dHJpYnV0ZSBmb250XG4gICAgQGRlZmF1bHQgXCJOb3JtYWwgMTJweCBWZXJkYW5hXCJcbiAgICBAdHlwZSB7U3RyaW5nfVxuICAgICovXG5cbiAgICB0aGlzLmZvbnQgPSBvcHRpb25zLmZvbnQgfHwgREVGQVVMVF9GT05UO1xuICAgIC8qXG4gICAgVGV4dCBob3Jpem9udGFsIGFsaWdubWVudFxuICAgIEBhdHRyaWJ1dGUgYWxpZ25cbiAgICBAZGVmYXVsdCBcImxlZnRcIlxuICAgIEB0eXBlIHtTdHJpbmd9XG4gICAgKi9cblxuICAgIHRoaXMuYWxpZ24gPSBvcHRpb25zLmFsaWduIHx8IERFRkFVTFRfQUxJR047XG4gICAgLypcbiAgICBUZXh0IHZlcnRpY2FsIGJhc2VsaW5lXG4gICAgQGF0dHJpYnV0ZSBiYXNlbGluZVxuICAgIEBkZWZhdWx0IEpveS5UZXh0LkJBU0VMSU5FLlRPUFxuICAgIEB0eXBlIHtTdHJpbmd9XG4gICAgKi9cblxuICAgIHRoaXMuYmFzZWxpbmUgPSBvcHRpb25zLmJhc2VsaW5lIHx8IERFRkFVTFRfQkFTRUxJTkU7XG4gICAgLypcbiAgICBDb2xvciBvZiB0aGUgdGV4dFxuICAgIEBhdHRyaWJ1dGUgY29sb3JcbiAgICBAZGVmYXVsdCBcIiMwMDAwMDBcIlxuICAgIEB0eXBlIHtTdHJpbmcsIENvbG9yfVxuICAgICovXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJjb2xvclwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMuX2NvbG9yKSB7XG4gICAgICAgICAgdGhpcy5jb2xvciA9IG9wdGlvbnMuY29sb3IgfHwgREVGQVVMVF9DT0xPUjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fY29sb3I7XG4gICAgICB9LFxuICAgICAgc2V0OiBmdW5jdGlvbihjb2xvcikge1xuICAgICAgICByZXR1cm4gdGhpcy5fY29sb3IgPSBjb2xvci50b1N0cmluZygpO1xuICAgICAgfSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIGlmIChvcHRpb25zLnN0cm9rZSkge1xuICAgICAgdGhpcy51c2VTdHJva2UoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy51c2VGaWxsKCk7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIndpZHRoXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICh0aGlzLl9fbWVhc3VyZSkge1xuICAgICAgICAgIHJldHVybiB0aGlzLl9fbWVhc3VyZS53aWR0aDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImhlaWdodFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy5fX21lYXN1cmUpIHtcbiAgICAgICAgICByZXR1cm4gdGhpcy5fX21lYXN1cmUuaGVpZ2h0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICAvKlxuICBAbWV0aG9kIHVzZVN0cm9rZVxuICAqL1xuXG5cbiAgVGV4dC5wcm90b3R5cGUudXNlU3Ryb2tlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zdHJva2UgPSB0cnVlO1xuICAgIHRoaXMuZmlsbE1ldGhvZCA9IFwic3Ryb2tlVGV4dFwiO1xuICAgIHJldHVybiB0aGlzLnN0eWxlTWV0aG9kID0gXCJzdHJva2VTdHlsZVwiO1xuICB9O1xuXG4gIC8qXG4gIEBtZXRob2QgdXNlRmlsbFxuICAqL1xuXG5cbiAgVGV4dC5wcm90b3R5cGUudXNlRmlsbCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuc3Ryb2tlID0gZmFsc2U7XG4gICAgdGhpcy5maWxsTWV0aG9kID0gXCJmaWxsVGV4dFwiO1xuICAgIHJldHVybiB0aGlzLnN0eWxlTWV0aG9kID0gXCJmaWxsU3R5bGVcIjtcbiAgfTtcblxuICBUZXh0LnByb3RvdHlwZS5fcmVuZGVyID0gZnVuY3Rpb24oY3R4KSB7XG4gICAgY3R4LmZvbnQgPSB0aGlzLmZvbnQ7XG4gICAgY3R4LnRleHRBbGlnbiA9IHRoaXMuYWxpZ247XG4gICAgY3R4LnRleHRCYXNlbGluZSA9IHRoaXMuYmFzZWxpbmU7XG4gICAgY3R4W3RoaXMuc3R5bGVNZXRob2RdID0gdGhpcy5jb2xvcjtcbiAgICBjdHhbdGhpcy5maWxsTWV0aG9kXSh0aGlzLnRleHQsIDAsIDApO1xuICAgIHJldHVybiB0aGlzLmdldE1lYXN1cmUoY3R4KTtcbiAgfTtcblxuICAvKlxuICBAbWV0aG9kIGdldE1lYXN1cmVcbiAgQHJldHVybiB7VGV4dE1ldHJpY3N9IHRleHQgbWV0cmljc1xuICAqL1xuXG5cbiAgVGV4dC5wcm90b3R5cGUuZ2V0TWVhc3VyZSA9IGZ1bmN0aW9uKGN0eCkge1xuICAgIHZhciBtO1xuICAgIHRoaXMuX19tZWFzdXJlID0ge307XG4gICAgbSA9IFRleHQuTWVhc3VyZVRleHQodGhpcy50ZXh0LCB0aGlzLmZvbnQpO1xuICAgIHRoaXMuX19tZWFzdXJlLndpZHRoID0gbVswXTtcbiAgICByZXR1cm4gdGhpcy5fX21lYXN1cmUuaGVpZ2h0ID0gbVsxXTtcbiAgfTtcblxuICBUZXh0LkJBU0VMSU5FID0gQkFTRUxJTkU7XG5cbiAgVGV4dC5NZWFzdXJlVGV4dCA9IGZ1bmN0aW9uKHRleHQsIGZvbnQpIHtcbiAgICB2YXIgZGl2LCBzaXplLCBzdHI7XG4gICAgc3RyID0gdGV4dCArIFwiOlwiICsgZm9udDtcbiAgICBpZiAodHlwZW9mIHRoaXMuX19tZWFzdXJldGV4dF9jYWNoZV9fID09PSBcIm9iamVjdFwiICYmIHRoaXMuX19tZWFzdXJldGV4dF9jYWNoZV9fW3N0cl0pIHtcbiAgICAgIHJldHVybiB0aGlzLl9fbWVhc3VyZXRleHRfY2FjaGVfX1tzdHJdO1xuICAgIH1cbiAgICBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiRElWXCIpO1xuICAgIGRpdi5pbm5lckhUTUwgPSB0ZXh0O1xuICAgIGRpdi5zdHlsZS5wb3NpdGlvbiA9IFwiYWJzb2x1dGVcIjtcbiAgICBkaXYuc3R5bGUudG9wID0gXCItMTAwcHhcIjtcbiAgICBkaXYuc3R5bGUubGVmdCA9IFwiLTEwMHB4XCI7XG4gICAgZGl2LnN0eWxlLmZvbnQgPSBmb250O1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZGl2KTtcbiAgICBzaXplID0gW2Rpdi5vZmZzZXRXaWR0aCwgZGl2Lm9mZnNldEhlaWdodF07XG4gICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChkaXYpO1xuICAgIGlmICh0eXBlb2YgdGhpcy5fX21lYXN1cmV0ZXh0X2NhY2hlX18gIT09IFwib2JqZWN0XCIpIHtcbiAgICAgIHRoaXMuX19tZWFzdXJldGV4dF9jYWNoZV9fID0ge307XG4gICAgfVxuICAgIHRoaXMuX19tZWFzdXJldGV4dF9jYWNoZV9fW3N0cl0gPSBzaXplO1xuICAgIHJldHVybiBzaXplO1xuICB9O1xuXG4gIHJldHVybiBUZXh0O1xuXG59KShXaWRnZXQpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRleHQ7XG5cbi8qXG4vL0Agc291cmNlTWFwcGluZ1VSTD10ZXh0Lm1hcFxuKi9cbiIsIi8vIEdlbmVyYXRlZCBieSBDb2ZmZWVTY3JpcHQgMS42LjNcbnZhciBDb2xvciwgQ29yZSwgTWF0cml4MmQsIFN1cHBvcnQsIFVVSUQsIFZlY3RvcjJkLCBXaWRnZXQ7XG5cbkNvcmUgPSByZXF1aXJlKFwiLi4vY29yZVwiKTtcblxuVVVJRCA9IHJlcXVpcmUoXCIuLi9tYXRoL3V1aWRcIik7XG5cblZlY3RvcjJkID0gcmVxdWlyZShcIi4uL21hdGgvdmVjdG9yMmRcIik7XG5cbk1hdHJpeDJkID0gcmVxdWlyZShcIi4uL21hdGgvbWF0cml4MmRcIik7XG5cblN1cHBvcnQgPSByZXF1aXJlKFwiLi4vY29yZS9zdXBwb3J0XCIpO1xuXG5Db2xvciA9IHJlcXVpcmUoXCIuLi91dGlscy9jb2xvclwiKTtcblxuLypcbkJhc2UgcmVuZGVyYWJsZSBlbGVtZW50XG5cbkBub3RlIEdhbWVDb3JlLmV4cG9ydHMudWkuV2lkZ2V0XG4qL1xuXG5cbldpZGdldCA9IChmdW5jdGlvbigpIHtcbiAgZnVuY3Rpb24gV2lkZ2V0KG9wdGlvbnMpIHtcbiAgICBpZiAob3B0aW9ucyA9PSBudWxsKSB7XG4gICAgICBvcHRpb25zID0ge307XG4gICAgfVxuICAgIHRoaXMuaWQgPSBVVUlELmdlbmVyYXRlVW5pcXVlSWQoKTtcbiAgICAvKlxuICAgIEBhdHRyaWJ1dGUgcGl2b3RcbiAgICBAdHlwZSB7VmVjdG9yMmR9XG4gICAgQGRlZmF1bHQgMCwwXG4gICAgKi9cblxuICAgIHRoaXMucGl2b3QgPSBvcHRpb25zLnBpdm90IHx8IG5ldyBWZWN0b3IyZChvcHRpb25zLnBpdm90WCB8fCAwLCBvcHRpb25zLnBpdm90WSB8fCAwKTtcbiAgICAvKlxuICAgIEBhdHRyaWJ1dGUgc2tld1hcbiAgICBAdHlwZSB7TnVtYmVyfVxuICAgIEBkZWZhdWx0IDBcbiAgICAqL1xuXG4gICAgdGhpcy5za2V3ID0gb3B0aW9ucy5za2V3IHx8IG5ldyBWZWN0b3IyZChvcHRpb25zLnNrZXdYIHx8IDAsIG9wdGlvbnMuc2tld1kgfHwgMCk7XG4gICAgLypcbiAgICBAYXR0cmlidXRlIHNjYWxlXG4gICAgQHR5cGUge1ZlY3RvcjJkfVxuICAgIEBkZWZhdWx0IDEsMVxuICAgICovXG5cbiAgICB0aGlzLnNjYWxlID0gb3B0aW9ucy5zY2FsZSB8fCBuZXcgVmVjdG9yMmQob3B0aW9ucy5zY2FsZVggfHwgMSwgb3B0aW9ucy5zY2FsZVkgfHwgMSk7XG4gICAgLypcbiAgICBAYXR0cmlidXRlIGFscGhhXG4gICAgQHR5cGUge051bWJlcn1cbiAgICBAZGVmYXVsdCAxXG4gICAgKi9cblxuICAgIHRoaXMuYWxwaGEgPSAodHlwZW9mIG9wdGlvbnMuYWxwaGEgPT09IFwidW5kZWZpbmVkXCIgPyAxIDogb3B0aW9ucy5hbHBoYSk7XG4gICAgLypcbiAgICBAYXR0cmlidXRlIHJvdGF0aW9uXG4gICAgQHR5cGUge051bWJlcn1cbiAgICBAZGVmYXVsdCAwXG4gICAgKi9cblxuICAgIHRoaXMucm90YXRpb24gPSBvcHRpb25zLnJvdGF0aW9uIHx8IDA7XG4gICAgLypcbiAgICBAYXR0cmlidXRlIHNtb290aFxuICAgIEB0eXBlIHtCb29sZWFufVxuICAgIEBkZWZhdWx0IGZhbHNlXG4gICAgKi9cblxuICAgIHRoaXMuc21vb3RoID0gKHR5cGVvZiBvcHRpb25zLnNtb290aCA9PT0gXCJ1bmRlZmluZWRcIiA/IHRydWUgOiBvcHRpb25zLnNtb290aCk7XG4gICAgdGhpcy5fbWF0cml4ID0gTWF0cml4MmQuaWRlbnRpdHkuY2xvbmUoKTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgXCJwb3NpdGlvblwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoIXRoaXMuX3Bvc2l0aW9uKSB7XG4gICAgICAgICAgdGhpcy5fcG9zaXRpb24gPSBuZXcgVmVjdG9yMmQoMCwgMCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX3Bvc2l0aW9uO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24odmVjdG9yKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbiA9IHZlY3Rvci5jbG9uZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInhcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucG9zaXRpb24ueCB8fCAwO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24oeCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wb3NpdGlvbi54ID0geDtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAob3B0aW9ucy54KSB7XG4gICAgICB0aGlzLnggPSBvcHRpb25zLng7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInlcIiwge1xuICAgICAgZ2V0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucG9zaXRpb24ueSB8fCAwO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24oeSkge1xuICAgICAgICByZXR1cm4gdGhpcy5wb3NpdGlvbi55ID0geTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAob3B0aW9ucy55KSB7XG4gICAgICB0aGlzLnkgPSBvcHRpb25zLnk7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcIndpZHRoXCIsIHtcbiAgICAgIGdldDogZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl93aWR0aCB8fCAxMDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGZ1bmN0aW9uKHcpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3dpZHRoID0gdztcbiAgICAgIH0sXG4gICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBpZiAob3B0aW9ucy53aWR0aCkge1xuICAgICAgdGhpcy53aWR0aCA9IG9wdGlvbnMud2lkdGg7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImhlaWdodFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faGVpZ2h0IHx8IDEwO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24oaCkge1xuICAgICAgICByZXR1cm4gdGhpcy5faGVpZ2h0ID0gaDtcbiAgICAgIH0sXG4gICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBpZiAob3B0aW9ucy5oZWlnaHQpIHtcbiAgICAgIHRoaXMuaGVpZ2h0ID0gb3B0aW9ucy5oZWlnaHQ7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcInBhcmVudFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcGFyZW50IHx8ICd1bmRlZmluZWQnO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24ocGFyZW50KSB7XG4gICAgICAgIHRoaXMuX3BhcmVudCA9IHBhcmVudDtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3BhcmVudC5hZGRDaGlsZCh0aGlzKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAob3B0aW9ucy5wYXJlbnQpIHtcbiAgICAgIHRoaXMucGFyZW50ID0gb3B0aW9ucy5wYXJlbnQ7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCBcImRyYXdCb3VuZGluZ0JveFwiLCB7XG4gICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYm91bmRpbmdfYm94IHx8IGZhbHNlO1xuICAgICAgfSxcbiAgICAgIHNldDogZnVuY3Rpb24oYm9vb2wpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2JvdW5kaW5nX2JveCA9IGJvb29sIHx8IGZhbHNlO1xuICAgICAgfVxuICAgIH0pO1xuICAgIGlmIChvcHRpb25zLmJib3gpIHtcbiAgICAgIHRoaXMuZHJhd0JvdW5kaW5nQm94ID0gb3B0aW9ucy5iYm94O1xuICAgIH1cbiAgfVxuXG4gIFdpZGdldC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24oY3R4KSB7XG4gICAgdmFyIGJpdCwgbXR4O1xuICAgIGJpdCA9IHtcbiAgICAgIFwiZmFsc2VcIjogLTEsXG4gICAgICBcInRydWVcIjogMVxuICAgIH07XG4gICAgbXR4ID0gdGhpcy5fbWF0cml4LmNsb25lKCkuaWRlbnRpdHkoKS5hcHBlbmRUcmFuc2Zvcm0odGhpcy5wb3NpdGlvbi54ICsgdGhpcy53aWR0aCAqICh0aGlzLmZsaXBYICsgMCksIHRoaXMucG9zaXRpb24ueSArIHRoaXMuaGVpZ2h0ICogKHRoaXMuZmxpcFkgKyAwKSwgdGhpcy5zY2FsZS54ICogYml0WyF0aGlzLmZsaXBYXSwgdGhpcy5zY2FsZS55ICogYml0WyF0aGlzLmZsaXBZXSwgdGhpcy5yb3RhdGlvbiwgdGhpcy5za2V3LngsIHRoaXMuc2tldy55LCB0aGlzLnBpdm90LngsIHRoaXMucGl2b3QueSk7XG4gICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgIGN0eC5zY2FsZSh0aGlzLnNjYWxlLngsIHRoaXMuc2NhbGUueSk7XG4gICAgY3R4LnRyYW5zbGF0ZSh0aGlzLnBvc2l0aW9uLngsIHRoaXMucG9zaXRpb24ueSk7XG4gICAgY3R4LnRyYW5zZm9ybShtdHgubTExLCBtdHgubTEyLCBtdHgubTIxLCBtdHgubTIyLCBtdHguZHgsIG10eC5keSk7XG4gICAgY3R4LnNldEFscGhhKHRoaXMuYWxwaGEpO1xuICAgIGlmICh0aGlzLmNvbXBvc2l0ZU9wZXJhdGlvbikge1xuICAgICAgY3R4Lmdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9IHRoaXMuY29tcG9zaXRlT3BlcmF0aW9uO1xuICAgIH1cbiAgICBjdHhbU3VwcG9ydC5pbWFnZVNtb290aGluZ0VuYWJsZWRdID0gdGhpcy5zbW9vdGg7XG4gICAgaWYgKHRoaXMuZHJhd0JvdW5kaW5nQm94ID09PSB0cnVlKSB7XG4gICAgICBjdHguc2V0QWxwaGEoMSk7XG4gICAgICBjdHgucmVjdCgwLCAwLCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XG4gICAgfVxuICAgIGN0eC5zZXRBbHBoYSh0aGlzLmFscGhhKTtcbiAgICBpZiAodGhpcy5fcmVuZGVyKSB7XG4gICAgICB0aGlzLl9yZW5kZXIoY3R4KTtcbiAgICB9XG4gICAgY3R4LnNjYWxlKDEgLyB0aGlzLnNjYWxlLngsIDEgLyB0aGlzLnNjYWxlLnkpO1xuICAgIGN0eC50cmFuc2xhdGUoLXRoaXMucG9zaXRpb24ueCwgLXRoaXMucG9zaXRpb24ueSk7XG4gICAgcmV0dXJuIGN0eC5jbG9zZVBhdGgoKTtcbiAgfTtcblxuICByZXR1cm4gV2lkZ2V0O1xuXG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFdpZGdldDtcblxuLypcbi8vQCBzb3VyY2VNYXBwaW5nVVJMPXdpZGdldC5tYXBcbiovXG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4zXG4vKlxuSW5zcGlyZWQgYnkgVGlueUNvbG9yXG5Ac2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9iZ3JpbnMvVGlueUNvbG9yXG4qL1xuXG52YXIgQ09MT1JfTkFNRVMsIENPTE9SX05BTUVTX0YsIENTU19JTlRFR0VSLCBDU1NfTlVNQkVSLCBDU1NfVU5JVCwgQ29sb3IsIE1hdGhtZXRpY3MsIFBFUk1JU1NJVkVfTUFUQ0gzLCBQRVJNSVNTSVZFX01BVENINCwgYm91bmQwMSwgY29udmVydFRvUGVyY2VudGFnZSwgZmxpcCwgaXNPbmVQb2ludFplcm8sIGlzUGVyY2VudGFnZSwgbWF0Y2hlcnMsIHBhZDIsIHBhcnNlSGV4LCBzdHJpbmdJbnB1dFRvT2JqZWN0LCB0cmltTGVmdCwgdHJpbVJpZ2h0O1xuXG5NYXRobWV0aWNzID0gcmVxdWlyZShcIi4uL21hdGgvbWF0aFwiKTtcblxuLypcbiovXG5cblxuQ09MT1JfTkFNRVMgPSB7XG4gIGFsaWNlYmx1ZTogXCJmMGY4ZmZcIixcbiAgYW50aXF1ZXdoaXRlOiBcImZhZWJkN1wiLFxuICBhcXVhOiBcIjBmZlwiLFxuICBhcXVhbWFyaW5lOiBcIjdmZmZkNFwiLFxuICBhenVyZTogXCJmMGZmZmZcIixcbiAgYmVpZ2U6IFwiZjVmNWRjXCIsXG4gIGJpc3F1ZTogXCJmZmU0YzRcIixcbiAgYmxhY2s6IFwiMDAwXCIsXG4gIGJsYW5jaGVkYWxtb25kOiBcImZmZWJjZFwiLFxuICBibHVlOiBcIjAwZlwiLFxuICBibHVldmlvbGV0OiBcIjhhMmJlMlwiLFxuICBicm93bjogXCJhNTJhMmFcIixcbiAgYnVybHl3b29kOiBcImRlYjg4N1wiLFxuICBidXJudHNpZW5uYTogXCJlYTdlNWRcIixcbiAgY2FkZXRibHVlOiBcIjVmOWVhMFwiLFxuICBjaGFydHJldXNlOiBcIjdmZmYwMFwiLFxuICBjaG9jb2xhdGU6IFwiZDI2OTFlXCIsXG4gIGNvcmFsOiBcImZmN2Y1MFwiLFxuICBjb3JuZmxvd2VyYmx1ZTogXCI2NDk1ZWRcIixcbiAgY29ybnNpbGs6IFwiZmZmOGRjXCIsXG4gIGNyaW1zb246IFwiZGMxNDNjXCIsXG4gIGN5YW46IFwiMGZmXCIsXG4gIGRhcmtibHVlOiBcIjAwMDA4YlwiLFxuICBkYXJrY3lhbjogXCIwMDhiOGJcIixcbiAgZGFya2dvbGRlbnJvZDogXCJiODg2MGJcIixcbiAgZGFya2dyYXk6IFwiYTlhOWE5XCIsXG4gIGRhcmtncmVlbjogXCIwMDY0MDBcIixcbiAgZGFya2dyZXk6IFwiYTlhOWE5XCIsXG4gIGRhcmtraGFraTogXCJiZGI3NmJcIixcbiAgZGFya21hZ2VudGE6IFwiOGIwMDhiXCIsXG4gIGRhcmtvbGl2ZWdyZWVuOiBcIjU1NmIyZlwiLFxuICBkYXJrb3JhbmdlOiBcImZmOGMwMFwiLFxuICBkYXJrb3JjaGlkOiBcIjk5MzJjY1wiLFxuICBkYXJrcmVkOiBcIjhiMDAwMFwiLFxuICBkYXJrc2FsbW9uOiBcImU5OTY3YVwiLFxuICBkYXJrc2VhZ3JlZW46IFwiOGZiYzhmXCIsXG4gIGRhcmtzbGF0ZWJsdWU6IFwiNDgzZDhiXCIsXG4gIGRhcmtzbGF0ZWdyYXk6IFwiMmY0ZjRmXCIsXG4gIGRhcmtzbGF0ZWdyZXk6IFwiMmY0ZjRmXCIsXG4gIGRhcmt0dXJxdW9pc2U6IFwiMDBjZWQxXCIsXG4gIGRhcmt2aW9sZXQ6IFwiOTQwMGQzXCIsXG4gIGRlZXBwaW5rOiBcImZmMTQ5M1wiLFxuICBkZWVwc2t5Ymx1ZTogXCIwMGJmZmZcIixcbiAgZGltZ3JheTogXCI2OTY5NjlcIixcbiAgZGltZ3JleTogXCI2OTY5NjlcIixcbiAgZG9kZ2VyYmx1ZTogXCIxZTkwZmZcIixcbiAgZmlyZWJyaWNrOiBcImIyMjIyMlwiLFxuICBmbG9yYWx3aGl0ZTogXCJmZmZhZjBcIixcbiAgZm9yZXN0Z3JlZW46IFwiMjI4YjIyXCIsXG4gIGZ1Y2hzaWE6IFwiZjBmXCIsXG4gIGdhaW5zYm9ybzogXCJkY2RjZGNcIixcbiAgZ2hvc3R3aGl0ZTogXCJmOGY4ZmZcIixcbiAgZ29sZDogXCJmZmQ3MDBcIixcbiAgZ29sZGVucm9kOiBcImRhYTUyMFwiLFxuICBncmF5OiBcIjgwODA4MFwiLFxuICBncmVlbjogXCIwMDgwMDBcIixcbiAgZ3JlZW55ZWxsb3c6IFwiYWRmZjJmXCIsXG4gIGdyZXk6IFwiODA4MDgwXCIsXG4gIGhvbmV5ZGV3OiBcImYwZmZmMFwiLFxuICBob3RwaW5rOiBcImZmNjliNFwiLFxuICBpbmRpYW5yZWQ6IFwiY2Q1YzVjXCIsXG4gIGluZGlnbzogXCI0YjAwODJcIixcbiAgaXZvcnk6IFwiZmZmZmYwXCIsXG4gIGtoYWtpOiBcImYwZTY4Y1wiLFxuICBsYXZlbmRlcjogXCJlNmU2ZmFcIixcbiAgbGF2ZW5kZXJibHVzaDogXCJmZmYwZjVcIixcbiAgbGF3bmdyZWVuOiBcIjdjZmMwMFwiLFxuICBsZW1vbmNoaWZmb246IFwiZmZmYWNkXCIsXG4gIGxpZ2h0Ymx1ZTogXCJhZGQ4ZTZcIixcbiAgbGlnaHRjb3JhbDogXCJmMDgwODBcIixcbiAgbGlnaHRjeWFuOiBcImUwZmZmZlwiLFxuICBsaWdodGdvbGRlbnJvZHllbGxvdzogXCJmYWZhZDJcIixcbiAgbGlnaHRncmF5OiBcImQzZDNkM1wiLFxuICBsaWdodGdyZWVuOiBcIjkwZWU5MFwiLFxuICBsaWdodGdyZXk6IFwiZDNkM2QzXCIsXG4gIGxpZ2h0cGluazogXCJmZmI2YzFcIixcbiAgbGlnaHRzYWxtb246IFwiZmZhMDdhXCIsXG4gIGxpZ2h0c2VhZ3JlZW46IFwiMjBiMmFhXCIsXG4gIGxpZ2h0c2t5Ymx1ZTogXCI4N2NlZmFcIixcbiAgbGlnaHRzbGF0ZWdyYXk6IFwiNzg5XCIsXG4gIGxpZ2h0c2xhdGVncmV5OiBcIjc4OVwiLFxuICBsaWdodHN0ZWVsYmx1ZTogXCJiMGM0ZGVcIixcbiAgbGlnaHR5ZWxsb3c6IFwiZmZmZmUwXCIsXG4gIGxpbWU6IFwiMGYwXCIsXG4gIGxpbWVncmVlbjogXCIzMmNkMzJcIixcbiAgbGluZW46IFwiZmFmMGU2XCIsXG4gIG1hZ2VudGE6IFwiZjBmXCIsXG4gIG1hcm9vbjogXCI4MDAwMDBcIixcbiAgbWVkaXVtYXF1YW1hcmluZTogXCI2NmNkYWFcIixcbiAgbWVkaXVtYmx1ZTogXCIwMDAwY2RcIixcbiAgbWVkaXVtb3JjaGlkOiBcImJhNTVkM1wiLFxuICBtZWRpdW1wdXJwbGU6IFwiOTM3MGRiXCIsXG4gIG1lZGl1bXNlYWdyZWVuOiBcIjNjYjM3MVwiLFxuICBtZWRpdW1zbGF0ZWJsdWU6IFwiN2I2OGVlXCIsXG4gIG1lZGl1bXNwcmluZ2dyZWVuOiBcIjAwZmE5YVwiLFxuICBtZWRpdW10dXJxdW9pc2U6IFwiNDhkMWNjXCIsXG4gIG1lZGl1bXZpb2xldHJlZDogXCJjNzE1ODVcIixcbiAgbWlkbmlnaHRibHVlOiBcIjE5MTk3MFwiLFxuICBtaW50Y3JlYW06IFwiZjVmZmZhXCIsXG4gIG1pc3R5cm9zZTogXCJmZmU0ZTFcIixcbiAgbW9jY2FzaW46IFwiZmZlNGI1XCIsXG4gIG5hdmFqb3doaXRlOiBcImZmZGVhZFwiLFxuICBuYXZ5OiBcIjAwMDA4MFwiLFxuICBvbGRsYWNlOiBcImZkZjVlNlwiLFxuICBvbGl2ZTogXCI4MDgwMDBcIixcbiAgb2xpdmVkcmFiOiBcIjZiOGUyM1wiLFxuICBvcmFuZ2U6IFwiZmZhNTAwXCIsXG4gIG9yYW5nZXJlZDogXCJmZjQ1MDBcIixcbiAgb3JjaGlkOiBcImRhNzBkNlwiLFxuICBwYWxlZ29sZGVucm9kOiBcImVlZThhYVwiLFxuICBwYWxlZ3JlZW46IFwiOThmYjk4XCIsXG4gIHBhbGV0dXJxdW9pc2U6IFwiYWZlZWVlXCIsXG4gIHBhbGV2aW9sZXRyZWQ6IFwiZGI3MDkzXCIsXG4gIHBhcGF5YXdoaXA6IFwiZmZlZmQ1XCIsXG4gIHBlYWNocHVmZjogXCJmZmRhYjlcIixcbiAgcGVydTogXCJjZDg1M2ZcIixcbiAgcGluazogXCJmZmMwY2JcIixcbiAgcGx1bTogXCJkZGEwZGRcIixcbiAgcG93ZGVyYmx1ZTogXCJiMGUwZTZcIixcbiAgcHVycGxlOiBcIjgwMDA4MFwiLFxuICByZWQ6IFwiZjAwXCIsXG4gIHJvc3licm93bjogXCJiYzhmOGZcIixcbiAgcm95YWxibHVlOiBcIjQxNjllMVwiLFxuICBzYWRkbGVicm93bjogXCI4YjQ1MTNcIixcbiAgc2FsbW9uOiBcImZhODA3MlwiLFxuICBzYW5keWJyb3duOiBcImY0YTQ2MFwiLFxuICBzZWFncmVlbjogXCIyZThiNTdcIixcbiAgc2Vhc2hlbGw6IFwiZmZmNWVlXCIsXG4gIHNpZW5uYTogXCJhMDUyMmRcIixcbiAgc2lsdmVyOiBcImMwYzBjMFwiLFxuICBza3libHVlOiBcIjg3Y2VlYlwiLFxuICBzbGF0ZWJsdWU6IFwiNmE1YWNkXCIsXG4gIHNsYXRlZ3JheTogXCI3MDgwOTBcIixcbiAgc2xhdGVncmV5OiBcIjcwODA5MFwiLFxuICBzbm93OiBcImZmZmFmYVwiLFxuICBzcHJpbmdncmVlbjogXCIwMGZmN2ZcIixcbiAgc3RlZWxibHVlOiBcIjQ2ODJiNFwiLFxuICB0YW46IFwiZDJiNDhjXCIsXG4gIHRlYWw6IFwiMDA4MDgwXCIsXG4gIHRoaXN0bGU6IFwiZDhiZmQ4XCIsXG4gIHRvbWF0bzogXCJmZjYzNDdcIixcbiAgdHVycXVvaXNlOiBcIjQwZTBkMFwiLFxuICB2aW9sZXQ6IFwiZWU4MmVlXCIsXG4gIHdoZWF0OiBcImY1ZGViM1wiLFxuICB3aGl0ZTogXCJmZmZcIixcbiAgd2hpdGVzbW9rZTogXCJmNWY1ZjVcIixcbiAgeWVsbG93OiBcImZmMFwiLFxuICB5ZWxsb3dncmVlbjogXCI5YWNkMzJcIlxufTtcblxudHJpbUxlZnQgPSAvXltcXHMsI10rLztcblxudHJpbVJpZ2h0ID0gL1xccyskLztcblxuZmxpcCA9IGZ1bmN0aW9uKG8pIHtcbiAgdmFyIGZsaXBwZWQsIGssIHY7XG4gIGZsaXBwZWQgPSB7fTtcbiAgZm9yIChrIGluIG8pIHtcbiAgICB2ID0gb1trXTtcbiAgICBmbGlwcGVkW3ZdID0gaztcbiAgfVxuICByZXR1cm4gZmxpcHBlZDtcbn07XG5cbmJvdW5kMDEgPSBmdW5jdGlvbihuLCBtYXgpIHtcbiAgdmFyIHByb2Nlc3NQZXJjZW50O1xuICBpZiAoaXNPbmVQb2ludFplcm8obikpIHtcbiAgICBuID0gXCIxMDAlXCI7XG4gIH1cbiAgcHJvY2Vzc1BlcmNlbnQgPSBpc1BlcmNlbnRhZ2Uobik7XG4gIG4gPSBNYXRoLm1pbihtYXgsIE1hdGgubWF4KDAsIHBhcnNlRmxvYXQobikpKTtcbiAgaWYgKHByb2Nlc3NQZXJjZW50KSB7XG4gICAgbiA9IHBhcnNlSW50KG4gKiBtYXgsIDEwKSAvIDEwMDtcbiAgfVxuICBpZiAoTWF0aC5hYnMobiAtIG1heCkgPCAwLjAwMDAwMSkge1xuICAgIHJldHVybiAxO1xuICB9XG4gIHJldHVybiAobiAlIG1heCkgLyBwYXJzZUZsb2F0KG1heCk7XG59O1xuXG5wYXJzZUhleCA9IGZ1bmN0aW9uKHZhbCkge1xuICByZXR1cm4gcGFyc2VJbnQodmFsLCAxNik7XG59O1xuXG5pc09uZVBvaW50WmVybyA9IGZ1bmN0aW9uKG4pIHtcbiAgcmV0dXJuIHR5cGVvZiBuID09PSBcInN0cmluZ1wiICYmIG4uaW5kZXhPZihcIi5cIikgIT09IC0xICYmIHBhcnNlRmxvYXQobikgPT09IDE7XG59O1xuXG5pc1BlcmNlbnRhZ2UgPSBmdW5jdGlvbihuKSB7XG4gIHJldHVybiB0eXBlb2YgbiA9PT0gXCJzdHJpbmdcIiAmJiBuLmluZGV4T2YoXCIlXCIpICE9PSAtMTtcbn07XG5cbnBhZDIgPSBmdW5jdGlvbihjKSB7XG4gIGlmIChjLmxlbmd0aCA9PT0gMSkge1xuICAgIHJldHVybiBcIjBcIiArIGM7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIFwiXCIgKyBjO1xuICB9XG59O1xuXG5jb252ZXJ0VG9QZXJjZW50YWdlID0gZnVuY3Rpb24obikge1xuICBpZiAobiA8PSAxKSB7XG4gICAgbiA9IChuICogMTAwKSArIFwiJVwiO1xuICB9XG4gIHJldHVybiBuO1xufTtcblxuQ09MT1JfTkFNRVNfRiA9IGZsaXAoQ09MT1JfTkFNRVMpO1xuXG5DU1NfSU5URUdFUiA9IFwiWy1cXFxcK10/XFxcXGQrJT9cIjtcblxuQ1NTX05VTUJFUiA9IFwiWy1cXFxcK10/XFxcXGQqXFxcXC5cXFxcZCslP1wiO1xuXG5DU1NfVU5JVCA9IFwiKD86XCIgKyBDU1NfTlVNQkVSICsgXCIpfCg/OlwiICsgQ1NTX0lOVEVHRVIgKyBcIilcIjtcblxuUEVSTUlTU0lWRV9NQVRDSDMgPSBcIltcXFxcc3xcXFxcKF0rKFwiICsgQ1NTX1VOSVQgKyBcIilbLHxcXFxcc10rKFwiICsgQ1NTX1VOSVQgKyBcIilbLHxcXFxcc10rKFwiICsgQ1NTX1VOSVQgKyBcIilcXFxccypcXFxcKT9cIjtcblxuUEVSTUlTU0lWRV9NQVRDSDQgPSBcIltcXFxcc3xcXFxcKF0rKFwiICsgQ1NTX1VOSVQgKyBcIilbLHxcXFxcc10rKFwiICsgQ1NTX1VOSVQgKyBcIilbLHxcXFxcc10rKFwiICsgQ1NTX1VOSVQgKyBcIilbLHxcXFxcc10rKFwiICsgQ1NTX1VOSVQgKyBcIilcXFxccypcXFxcKT9cIjtcblxubWF0Y2hlcnMgPSB7XG4gIHJnYjogbmV3IFJlZ0V4cChcInJnYlwiICsgUEVSTUlTU0lWRV9NQVRDSDMpLFxuICByZ2JhOiBuZXcgUmVnRXhwKFwicmdiYVwiICsgUEVSTUlTU0lWRV9NQVRDSDQpLFxuICBoc2w6IG5ldyBSZWdFeHAoXCJoc2xcIiArIFBFUk1JU1NJVkVfTUFUQ0gzKSxcbiAgaHNsYTogbmV3IFJlZ0V4cChcImhzbGFcIiArIFBFUk1JU1NJVkVfTUFUQ0g0KSxcbiAgaHN2OiBuZXcgUmVnRXhwKFwiaHN2XCIgKyBQRVJNSVNTSVZFX01BVENIMyksXG4gIGhleDM6IC9eKFswLTlhLWZBLUZdezF9KShbMC05YS1mQS1GXXsxfSkoWzAtOWEtZkEtRl17MX0pJC8sXG4gIGhleDY6IC9eKFswLTlhLWZBLUZdezJ9KShbMC05YS1mQS1GXXsyfSkoWzAtOWEtZkEtRl17Mn0pJC9cbn07XG5cbi8qXG5Db2xvciBvcGVyYXRpb25zXG5cbkBub3RlIEdhbWVDb3JlLmV4cG9ydHMudXRpbHMuQ29sb3JcbiovXG5cblxuQ29sb3IgPSAoZnVuY3Rpb24oKSB7XG4gIC8qXG4gIEBwYXJhbSB7U3RyaW5nIHwgQ29sb3J9IGhleCBjb2xvciBzdHJpbmcgb3IgY29sb3IgbmFtZSBvciBDb2xvciBpbnN0YW5jZVxuICBAcGFyYW0ge09iamVjdH0gb3B0aW9uc1xuICAqL1xuXG4gIGZ1bmN0aW9uIENvbG9yKGNvbG9yLCBvcHRzKSB7XG4gICAgdmFyIGZvcm1hdCwgcmdiO1xuICAgIGlmIChjb2xvciA9PSBudWxsKSB7XG4gICAgICBjb2xvciA9IFwiXCI7XG4gICAgfVxuICAgIGlmIChvcHRzID09IG51bGwpIHtcbiAgICAgIG9wdHMgPSB7fTtcbiAgICB9XG4gICAgcmdiID0gQ29sb3IuaW5wdXRUb1JHQihjb2xvcik7XG4gICAgdGhpcy5yID0gcmdiLnI7XG4gICAgdGhpcy5nID0gcmdiLmc7XG4gICAgdGhpcy5iID0gcmdiLmI7XG4gICAgdGhpcy5hID0gcmdiLmE7XG4gICAgdGhpcy5yb3VuZEEgPSBNYXRoLnJvdW5kKDEwMCAqIHRoaXMuYSkgLyAxMDA7XG4gICAgZm9ybWF0ID0gb3B0cy5mb3JtYXQgfHwgcmdiLmZvcm1hdCB8fCBmYWxzZTtcbiAgICBpZiAodGhpcy5yIDwgMSkge1xuICAgICAgdGhpcy5yID0gTWF0aC5yb3VuZCh0aGlzLnIpO1xuICAgIH1cbiAgICBpZiAodGhpcy5nIDwgMSkge1xuICAgICAgdGhpcy5nID0gTWF0aC5yb3VuZCh0aGlzLmcpO1xuICAgIH1cbiAgICBpZiAodGhpcy5iIDwgMSkge1xuICAgICAgdGhpcy5iID0gTWF0aC5yb3VuZCh0aGlzLmIpO1xuICAgIH1cbiAgfVxuXG4gIC8qXG4gIEBtZXRob2QgdG9Ic3ZcbiAgQHJldHVybiB7T2JqZWN0fSB7aCxzLHYsYX1cbiAgKi9cblxuXG4gIENvbG9yLnByb3RvdHlwZS50b0hzdiA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBoc3Y7XG4gICAgaHN2ID0gQ29sb3IucmdiVG9Ic3YodGhpcy5yLCB0aGlzLmcsIHRoaXMuYik7XG4gICAgcmV0dXJuIHtcbiAgICAgIGg6IGhzdi5oICogMzYwLFxuICAgICAgczogaHN2LnMsXG4gICAgICB2OiBoc3YudixcbiAgICAgIGE6IHRoaXMuYVxuICAgIH07XG4gIH07XG5cbiAgLypcbiAgQG1ldGhvZCB0b0hzdlN0cmluZ1xuICBAcmV0dXJuIHtTdHJpbmd9XG4gICovXG5cblxuICBDb2xvci5wcm90b3R5cGUudG9Ic3ZTdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaCwgaHN2LCBzLCB2O1xuICAgIGhzdiA9IENvbG9yLnJnYlRvSHN2KHRoaXMuciwgdGhpcy5nLCB0aGlzLmIpO1xuICAgIGggPSBNYXRoLnJvdW5kKGhzdi5oICogMzYwKTtcbiAgICBzID0gTWF0aC5yb3VuZChoc3YucyAqIDEwMCk7XG4gICAgdiA9IE1hdGgucm91bmQoaHN2LnYgKiAxMDApO1xuICAgIGlmICh0aGlzLmEgPT09IDEpIHtcbiAgICAgIHJldHVybiBcImhzdihcIiArIGggKyBcIiwgXCIgKyBzICsgXCIlLCBcIiArIHYgKyBcIiUpXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBcImhzdmEoXCIgKyBoICsgXCIsIFwiICsgcyArIFwiJSwgXCIgKyB2ICsgXCIlLCBcIiArIHRoaXMucm91bmRBICsgXCIpXCI7XG4gICAgfVxuICB9O1xuXG4gIC8qXG4gIEBtZXRob2QgdG9Ic2xcbiAgQHJldHVybiB7T2JqZWN0fSB7aCxzLGwsYX1cbiAgKi9cblxuXG4gIENvbG9yLnByb3RvdHlwZS50b0hzbCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBoc2w7XG4gICAgaHNsID0gQ29sb3IucmdiVG9Ic2wodGhpcy5yLCB0aGlzLmcsIHRoaXMuYik7XG4gICAgcmV0dXJuIHtcbiAgICAgIGg6IGhzbC5oICogMzYwLFxuICAgICAgczogaHNsLnMsXG4gICAgICBsOiBoc2wubCxcbiAgICAgIGE6IHRoaXMuYVxuICAgIH07XG4gIH07XG5cbiAgLypcbiAgQG1ldGhvZCB0b0hzbFN0cmluZ1xuICBAcmV0dXJuIHtTdHJpbmd9XG4gICovXG5cblxuICBDb2xvci5wcm90b3R5cGUudG9Ic2xTdHJpbmcgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgaCwgaHNsLCBsLCBzO1xuICAgIGhzbCA9IENvbG9yLnJnYlRvSHNsKHRoaXMuciwgdGhpcy5nLCB0aGlzLmIpO1xuICAgIGggPSBNYXRoLnJvdW5kKGhzbC5oICogMzYwKTtcbiAgICBzID0gTWF0aC5yb3VuZChoc2wucyAqIDEwMCk7XG4gICAgbCA9IE1hdGgucm91bmQoaHNsLmwgKiAxMDApO1xuICAgIGlmICh0aGlzLmEgPT09IDEpIHtcbiAgICAgIHJldHVybiBcImhzbChcIiArIGggKyBcIiwgXCIgKyBzICsgXCIlLCBcIiArIGwgKyBcIiUpXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBcImhzbGEoXCIgKyBoICsgXCIsIFwiICsgcyArIFwiJSwgXCIgKyBsICsgXCIlLCBcIiArIHRoaXMucm91bmRBICsgXCIpXCI7XG4gICAgfVxuICB9O1xuXG4gIC8qXG4gIEBtZXRob2QgdG9IZXhcbiAgQHBhcmFtIHtCb29sZWFufSBhbGxvdzNDaGFyIGRlZmF1bHRzPWZhbHNlXG4gIEByZXR1cm4ge1N0cmluZ31cbiAgKi9cblxuXG4gIENvbG9yLnByb3RvdHlwZS50b0hleCA9IGZ1bmN0aW9uKGFsbG93M0NoYXIpIHtcbiAgICBpZiAoYWxsb3czQ2hhciA9PSBudWxsKSB7XG4gICAgICBhbGxvdzNDaGFyID0gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiBDb2xvci5yZ2JUb0hleCh0aGlzLnIsIHRoaXMuZywgdGhpcy5iLCBhbGxvdzNDaGFyKTtcbiAgfTtcblxuICAvKlxuICBAbWV0aG9kIHRvSGV4U3RyaW5nXG4gIEBwYXJhbSB7Qm9vbGVhbn0gYWxsb3czQ2hhciBkZWZhdWx0cz1mYWxzZVxuICBAcmV0dXJuIHtTdHJpbmd9ICMgKyB0b0hleCgpXG4gICovXG5cblxuICBDb2xvci5wcm90b3R5cGUudG9IZXhTdHJpbmcgPSBmdW5jdGlvbihhbGxvdzNDaGFyKSB7XG4gICAgaWYgKGFsbG93M0NoYXIgPT0gbnVsbCkge1xuICAgICAgYWxsb3czQ2hhciA9IGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gXCIjXCIgKyB0aGlzLnRvSGV4KGFsbG93M0NoYXIpO1xuICB9O1xuXG4gIC8qXG4gIEBtZXRob2QgdG9SZ2JcbiAgQHJldHVybiB7T2JqZWN0fSB7cixnLGIsYX1cbiAgKi9cblxuXG4gIENvbG9yLnByb3RvdHlwZS50b1JnYiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICByOiBNYXRoLnJvdW5kKHRoaXMuciksXG4gICAgICBnOiBNYXRoLnJvdW5kKHRoaXMuZyksXG4gICAgICBiOiBNYXRoLnJvdW5kKHRoaXMuYiksXG4gICAgICBhOiB0aGlzLmFcbiAgICB9O1xuICB9O1xuXG4gIC8qXG4gIEBtZXRob2QgdG9SZ2JTdHJpbmdcbiAgQHJldHVybiB7U3RyaW5nfVxuICAqL1xuXG5cbiAgQ29sb3IucHJvdG90eXBlLnRvUmdiU3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuYSA9PT0gMSkge1xuICAgICAgcmV0dXJuIFwicmdiKFwiICsgTWF0aC5yb3VuZCh0aGlzLnIpICsgXCIsIFwiICsgTWF0aC5yb3VuZCh0aGlzLmcpICsgXCIsIFwiICsgTWF0aC5yb3VuZCh0aGlzLmIpICsgXCIpXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBcInJnYmEoXCIgKyBNYXRoLnJvdW5kKHRoaXMucikgKyBcIiwgXCIgKyBNYXRoLnJvdW5kKHRoaXMuZykgKyBcIiwgXCIgKyBNYXRoLnJvdW5kKHRoaXMuYikgKyBcIiwgXCIgKyB0aGlzLnJvdW5kQSArIFwiKVwiO1xuICAgIH1cbiAgfTtcblxuICBDb2xvci5wcm90b3R5cGUudG9QZXJjZW50YWdlUmdiID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHI6IE1hdGgucm91bmQoYm91bmQwMSh0aGlzLnIsIDI1NSkgKiAxMDApICsgXCIlXCIsXG4gICAgICBnOiBNYXRoLnJvdW5kKGJvdW5kMDEodGhpcy5nLCAyNTUpICogMTAwKSArIFwiJVwiLFxuICAgICAgYjogTWF0aC5yb3VuZChib3VuZDAxKHRoaXMuYiwgMjU1KSAqIDEwMCkgKyBcIiVcIixcbiAgICAgIGE6IHRoaXMuYVxuICAgIH07XG4gIH07XG5cbiAgQ29sb3IucHJvdG90eXBlLnRvUGVyY2VudGFnZVJnYlN0cmluZyA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmEgPT09IDEpIHtcbiAgICAgIHJldHVybiBcInJnYihcIiArIE1hdGgucm91bmQoYm91bmQwMSh0aGlzLnIsIDI1NSkgKiAxMDApICsgXCIlLCBcIiArIE1hdGgucm91bmQoYm91bmQwMSh0aGlzLmcsIDI1NSkgKiAxMDApICsgXCIlLCBcIiArIE1hdGgucm91bmQoYm91bmQwMSh0aGlzLmIsIDI1NSkgKiAxMDApICsgXCIlKVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gXCJyZ2JhKFwiICsgTWF0aC5yb3VuZChib3VuZDAxKHRoaXMuciwgMjU1KSAqIDEwMCkgKyBcIiUsIFwiICsgTWF0aC5yb3VuZChib3VuZDAxKHRoaXMuZywgMjU1KSAqIDEwMCkgKyBcIiUsIFwiICsgTWF0aC5yb3VuZChib3VuZDAxKHRoaXMuYiwgMjU1KSAqIDEwMCkgKyBcIiUsIFwiICsgdGhpcy5hICsgXCIpXCI7XG4gICAgfVxuICB9O1xuXG4gIENvbG9yLnByb3RvdHlwZS50b05hbWUgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5hID09PSAwKSB7XG4gICAgICByZXR1cm4gXCJ0cmFuc3BhcmVudFwiO1xuICAgIH1cbiAgICByZXR1cm4gQ09MT1JfTkFNRVNfRltDb2xvci5yZ2JUb0hleCh0aGlzLnIsIHRoaXMuZywgdGhpcy5iLCB0cnVlKV0gfHwgZmFsc2U7XG4gIH07XG5cbiAgLypcbiAgT3V0cHV0aW5nIGN1cnJlbnQgY29sb3IgYXMgc3RyaW5nXG4gICovXG5cblxuICBDb2xvci5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbihmb3JtYXQpIHtcbiAgICB2YXIgZm9ybWF0U2V0LCBmb3JtYXRXaXRoQWxwaGEsIGZvcm1hdHRlZFN0cmluZywgaGFzQWxwaGFBbmRGb3JtYXROb3RTZXQ7XG4gICAgZm9ybWF0U2V0ID0gISFmb3JtYXQ7XG4gICAgZm9ybWF0ID0gZm9ybWF0IHx8IHRoaXMuZm9ybWF0O1xuICAgIGZvcm1hdHRlZFN0cmluZyA9IGZhbHNlO1xuICAgIGhhc0FscGhhQW5kRm9ybWF0Tm90U2V0ID0gIWZvcm1hdFNldCAmJiB0aGlzLmEgPCAxICYmIHRoaXMuYSA+IDA7XG4gICAgZm9ybWF0V2l0aEFscGhhID0gaGFzQWxwaGFBbmRGb3JtYXROb3RTZXQgJiYgKGZvcm1hdCA9PT0gXCJoZXhcIiB8fCBmb3JtYXQgPT09IFwiaGV4NlwiIHx8IGZvcm1hdCA9PT0gXCJoZXgzXCIgfHwgZm9ybWF0ID09PSBcIm5hbWVcIik7XG4gICAgaWYgKGZvcm1hdCA9PT0gXCJyZ2JcIikge1xuICAgICAgZm9ybWF0dGVkU3RyaW5nID0gdGhpcy50b1JnYlN0cmluZygpO1xuICAgIH1cbiAgICBpZiAoZm9ybWF0ID09PSBcInByZ2JcIikge1xuICAgICAgZm9ybWF0dGVkU3RyaW5nID0gdGhpcy50b1BlcmNlbnRhZ2VSZ2JTdHJpbmcoKTtcbiAgICB9XG4gICAgaWYgKGZvcm1hdCA9PT0gXCJoZXhcIiB8fCBmb3JtYXQgPT09IFwiaGV4NlwiKSB7XG4gICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvSGV4U3RyaW5nKCk7XG4gICAgfVxuICAgIGlmIChmb3JtYXQgPT09IFwiaGV4M1wiKSB7XG4gICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvSGV4U3RyaW5nKHRydWUpO1xuICAgIH1cbiAgICBpZiAoZm9ybWF0ID09PSBcIm5hbWVcIikge1xuICAgICAgZm9ybWF0dGVkU3RyaW5nID0gdGhpcy50b05hbWUoKTtcbiAgICB9XG4gICAgaWYgKGZvcm1hdCA9PT0gXCJoc2xcIikge1xuICAgICAgZm9ybWF0dGVkU3RyaW5nID0gdGhpcy50b0hzbFN0cmluZygpO1xuICAgIH1cbiAgICBpZiAoZm9ybWF0ID09PSBcImhzdlwiKSB7XG4gICAgICBmb3JtYXR0ZWRTdHJpbmcgPSB0aGlzLnRvSHN2U3RyaW5nKCk7XG4gICAgfVxuICAgIGlmIChmb3JtYXRXaXRoQWxwaGEpIHtcbiAgICAgIHJldHVybiB0aGlzLnRvUmdiU3RyaW5nKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBmb3JtYXR0ZWRTdHJpbmcgfHwgdGhpcy50b0hleFN0cmluZygpO1xuICAgIH1cbiAgfTtcblxuICAvKlxuICBJZiBpbnB1dCBpcyBhbiBvYmplY3QsIGZvcmNlIDEgaW50byBcIjEuMFwiIHRvIGhhbmRsZSByYXRpb3MgcHJvcGVybHlcbiAgU3RyaW5nIGlucHV0IHJlcXVpcmVzIFwiMS4wXCIgYXMgaW5wdXQsIHNvIDEgd2lsbCBiZSB0cmVhdGVkIGFzIDFcbiAgXG4gIEdpdmVuIGEgc3RyaW5nIG9yIG9iamVjdCwgY29udmVydCB0aGF0IGlucHV0IHRvIFJHQlxuICBQb3NzaWJsZSBzdHJpbmcgaW5wdXRzOlxuICBcbiAgXCJyZWRcIlxuICBcIiNmMDBcIiBvciBcImYwMFwiXG4gIFwiI2ZmMDAwMFwiIG9yIFwiZmYwMDAwXCJcbiAgXCJyZ2IgMjU1IDAgMFwiIG9yIFwicmdiICgyNTUsIDAsIDApXCJcbiAgXCJyZ2IgMS4wIDAgMFwiIG9yIFwicmdiICgxLCAwLCAwKVwiXG4gIFwicmdiYSAoMjU1LCAwLCAwLCAxKVwiIG9yIFwicmdiYSAyNTUsIDAsIDAsIDFcIlxuICBcInJnYmEgKDEuMCwgMCwgMCwgMSlcIiBvciBcInJnYmEgMS4wLCAwLCAwLCAxXCJcbiAgXCJoc2woMCwgMTAwJSwgNTAlKVwiIG9yIFwiaHNsIDAgMTAwJSA1MCVcIlxuICBcImhzbGEoMCwgMTAwJSwgNTAlLCAxKVwiIG9yIFwiaHNsYSAwIDEwMCUgNTAlLCAxXCJcbiAgXCJoc3YoMCwgMTAwJSwgMTAwJSlcIiBvciBcImhzdiAwIDEwMCUgMTAwJVwiXG4gIFxuICBAcGFyYW0ge1N0cmluZyB8IENvbG9yfSBjb2xvclxuICAqL1xuXG5cbiAgQ29sb3IuaW5wdXRUb1JHQiA9IGZ1bmN0aW9uKGNvbG9yKSB7XG4gICAgdmFyIGEsIGZvcm1hdCwgb2ssIHJnYjtcbiAgICByZ2IgPSB7XG4gICAgICByOiAwLFxuICAgICAgZzogMCxcbiAgICAgIGI6IDBcbiAgICB9O1xuICAgIGEgPSAxO1xuICAgIG9rID0gZmFsc2U7XG4gICAgZm9ybWF0ID0gZmFsc2U7XG4gICAgaWYgKHR5cGVvZiBjb2xvciA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgY29sb3IgPSBzdHJpbmdJbnB1dFRvT2JqZWN0KGNvbG9yKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBjb2xvciA9PT0gXCJvYmplY3RcIikge1xuICAgICAgaWYgKGNvbG9yLmhhc093blByb3BlcnR5KFwiclwiKSAmJiBjb2xvci5oYXNPd25Qcm9wZXJ0eShcImdcIikgJiYgY29sb3IuaGFzT3duUHJvcGVydHkoXCJiXCIpKSB7XG4gICAgICAgIHJnYiA9IENvbG9yLnJnYlRvUmdiKGNvbG9yLnIsIGNvbG9yLmcsIGNvbG9yLmIpO1xuICAgICAgICBvayA9IHRydWU7XG4gICAgICAgIGZvcm1hdCA9IChTdHJpbmcoY29sb3Iucikuc3Vic3RyKC0xKSA9PT0gXCIlXCIgPyBcInByZ2JcIiA6IFwicmdiXCIpO1xuICAgICAgfSBlbHNlIGlmIChjb2xvci5oYXNPd25Qcm9wZXJ0eShcImhcIikgJiYgY29sb3IuaGFzT3duUHJvcGVydHkoXCJzXCIpICYmIGNvbG9yLmhhc093blByb3BlcnR5KFwidlwiKSkge1xuICAgICAgICBjb2xvci5zID0gY29udmVydFRvUGVyY2VudGFnZShjb2xvci5zKTtcbiAgICAgICAgY29sb3IudiA9IGNvbnZlcnRUb1BlcmNlbnRhZ2UoY29sb3Iudik7XG4gICAgICAgIHJnYiA9IENvbG9yLmhzdlRvUmdiKGNvbG9yLmgsIGNvbG9yLnMsIGNvbG9yLnYpO1xuICAgICAgICBvayA9IHRydWU7XG4gICAgICAgIGZvcm1hdCA9IFwiaHN2XCI7XG4gICAgICB9IGVsc2UgaWYgKGNvbG9yLmhhc093blByb3BlcnR5KFwiaFwiKSAmJiBjb2xvci5oYXNPd25Qcm9wZXJ0eShcInNcIikgJiYgY29sb3IuaGFzT3duUHJvcGVydHkoXCJsXCIpKSB7XG4gICAgICAgIGNvbG9yLnMgPSBjb252ZXJ0VG9QZXJjZW50YWdlKGNvbG9yLnMpO1xuICAgICAgICBjb2xvci5sID0gY29udmVydFRvUGVyY2VudGFnZShjb2xvci5sKTtcbiAgICAgICAgcmdiID0gQ29sb3IuaHNsVG9SZ2IoY29sb3IuaCwgY29sb3IucywgY29sb3IubCk7XG4gICAgICAgIG9rID0gdHJ1ZTtcbiAgICAgICAgZm9ybWF0ID0gXCJoc2xcIjtcbiAgICAgIH1cbiAgICAgIGlmIChjb2xvci5oYXNPd25Qcm9wZXJ0eShcImFcIikpIHtcbiAgICAgICAgYSA9IGNvbG9yLmE7XG4gICAgICB9XG4gICAgfVxuICAgIGEgPSBwYXJzZUZsb2F0KGEpO1xuICAgIGlmIChpc05hTihhKSB8fCBhIDwgMCB8fCBhID4gMSkge1xuICAgICAgYSA9IDE7XG4gICAgfVxuICAgIHJldHVybiB7XG4gICAgICBvazogb2ssXG4gICAgICBmb3JtYXQ6IGNvbG9yLmZvcm1hdCB8fCBmb3JtYXQsXG4gICAgICByOiBNYXRoLm1pbigyNTUsIE1hdGgubWF4KHJnYi5yLCAwKSksXG4gICAgICBnOiBNYXRoLm1pbigyNTUsIE1hdGgubWF4KHJnYi5nLCAwKSksXG4gICAgICBiOiBNYXRoLm1pbigyNTUsIE1hdGgubWF4KHJnYi5iLCAwKSksXG4gICAgICBhOiBhXG4gICAgfTtcbiAgfTtcblxuICAvKlxuICBIYW5kbGUgYm91bmRzIC8gcGVyY2VudGFnZSBjaGVja2luZyB0byBjb25mb3JtIHRvIENTUyBjb2xvciBzcGVjXG4gIDxodHRwOi8vd3d3LnczLm9yZy9UUi9jc3MzLWNvbG9yLz5cbiAgXG4gIEBtZXRob2QgcmdiVG9SZ2JcbiAgXG4gIEBwYXJhbSB7SW50ZWdlcn0gciBpbiAwLi4yNTUgb3IgMC4uMVxuICBAcGFyYW0ge0ludGVnZXJ9IGcgaW4gMC4uMjU1IG9yIDAuLjFcbiAgQHBhcmFtIHtJbnRlZ2VyfSBiIGluIDAuLjI1NSBvciAwLi4xXG4gIFxuICBAcmV0dXJuIHtPYmplY3R9IHsgciwgZywgYiB9IGluIDAuLjI1NVxuICAqL1xuXG5cbiAgQ29sb3IucmdiVG9SZ2IgPSBmdW5jdGlvbihyLCBnLCBiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHI6IGJvdW5kMDEociwgMjU1KSAqIDI1NSxcbiAgICAgIGc6IGJvdW5kMDEoZywgMjU1KSAqIDI1NSxcbiAgICAgIGI6IGJvdW5kMDEoYiwgMjU1KSAqIDI1NVxuICAgIH07XG4gIH07XG5cbiAgLypcbiAgQ29udmVydHMgYW4gUkdCIGNvbG9yIHZhbHVlIHRvIEhTTC5cbiAgXG4gIEBtZXRob2QgcmdiVG9Ic2xcbiAgXG4gIEBwYXJhbSB7SW50ZWdlcn0gciBpbiAwLi4yNTUgb3IgMC4uMVxuICBAcGFyYW0ge0ludGVnZXJ9IGcgaW4gMC4uMjU1IG9yIDAuLjFcbiAgQHBhcmFtIHtJbnRlZ2VyfSBiIGluIDAuLjI1NSBvciAwLi4xXG4gIFxuICBAcmV0dXJuIHtPYmplY3R9IHsgaCwgcywgbCB9IGluIDAuLjFcbiAgKi9cblxuXG4gIENvbG9yLnJnYlRvSHNsID0gZnVuY3Rpb24ociwgZywgYikge1xuICAgIHZhciBkLCBoLCBsLCBtYXgsIG1pbiwgcztcbiAgICByID0gYm91bmQwMShyLCAyNTUpO1xuICAgIGcgPSBib3VuZDAxKGcsIDI1NSk7XG4gICAgYiA9IGJvdW5kMDEoYiwgMjU1KTtcbiAgICBtYXggPSBNYXRoLm1heChyLCBnLCBiKTtcbiAgICBtaW4gPSBNYXRoLm1pbihyLCBnLCBiKTtcbiAgICBoID0gdm9pZCAwO1xuICAgIHMgPSB2b2lkIDA7XG4gICAgbCA9IChtYXggKyBtaW4pIC8gMjtcbiAgICBpZiAobWF4ID09PSBtaW4pIHtcbiAgICAgIGggPSBzID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgZCA9IG1heCAtIG1pbjtcbiAgICAgIHMgPSAobCA+IDAuNSA/IGQgLyAoMiAtIG1heCAtIG1pbikgOiBkIC8gKG1heCArIG1pbikpO1xuICAgICAgc3dpdGNoIChtYXgpIHtcbiAgICAgICAgY2FzZSByOlxuICAgICAgICAgIGggPSAoZyAtIGIpIC8gZCArIChnIDwgYiA/IDYgOiAwKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBnOlxuICAgICAgICAgIGggPSAoYiAtIHIpIC8gZCArIDI7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgYjpcbiAgICAgICAgICBoID0gKHIgLSBnKSAvIGQgKyA0O1xuICAgICAgfVxuICAgICAgaCAvPSA2O1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgaDogaCxcbiAgICAgIHM6IHMsXG4gICAgICBsOiBsXG4gICAgfTtcbiAgfTtcblxuICAvKlxuICBDb252ZXJ0cyBhbiBIU0wgY29sb3IgdmFsdWUgdG8gUkdCLlxuICBcbiAgQG1ldGhvZCBoc2xUb1JnYlxuICBAcGFyYW0ge0ludGVnZXJ9IGggaW4gMC4uMzYwIG9yIDAuLjFcbiAgQHBhcmFtIHtJbnRlZ2VyfSBzIGluIDAuLjEwMCBvciAwLi4xXG4gIEBwYXJhbSB7SW50ZWdlcn0gbCBpbiAwLi4xMDAgb3IgMC4uMVxuICBAcmV0dXJuIHtPYmplY3R9IHsgciwgZywgYiB9IGluIDAuLjI1NVxuICAqL1xuXG5cbiAgQ29sb3IuaHNsVG9SZ2IgPSBmdW5jdGlvbihoLCBzLCBsKSB7XG4gICAgdmFyIGIsIGcsIGh1ZTJyZ2IsIHAsIHEsIHI7XG4gICAgaHVlMnJnYiA9IGZ1bmN0aW9uKHAsIHEsIHQpIHtcbiAgICAgIGlmICh0IDwgMCkge1xuICAgICAgICB0ICs9IDE7XG4gICAgICB9XG4gICAgICBpZiAodCA+IDEpIHtcbiAgICAgICAgdCAtPSAxO1xuICAgICAgfVxuICAgICAgaWYgKHQgPCAxIC8gNikge1xuICAgICAgICByZXR1cm4gcCArIChxIC0gcCkgKiA2ICogdDtcbiAgICAgIH1cbiAgICAgIGlmICh0IDwgMSAvIDIpIHtcbiAgICAgICAgcmV0dXJuIHE7XG4gICAgICB9XG4gICAgICBpZiAodCA8IDIgLyAzKSB7XG4gICAgICAgIHJldHVybiBwICsgKHEgLSBwKSAqICgyIC8gMyAtIHQpICogNjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwO1xuICAgIH07XG4gICAgciA9IHZvaWQgMDtcbiAgICBnID0gdm9pZCAwO1xuICAgIGIgPSB2b2lkIDA7XG4gICAgaCA9IGJvdW5kMDEoaCwgMzYwKTtcbiAgICBzID0gYm91bmQwMShzLCAxMDApO1xuICAgIGwgPSBib3VuZDAxKGwsIDEwMCk7XG4gICAgaWYgKHMgPT09IDApIHtcbiAgICAgIHIgPSBnID0gYiA9IGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIHEgPSAobCA8IDAuNSA/IGwgKiAoMSArIHMpIDogbCArIHMgLSBsICogcyk7XG4gICAgICBwID0gMiAqIGwgLSBxO1xuICAgICAgciA9IGh1ZTJyZ2IocCwgcSwgaCArIDEgLyAzKTtcbiAgICAgIGcgPSBodWUycmdiKHAsIHEsIGgpO1xuICAgICAgYiA9IGh1ZTJyZ2IocCwgcSwgaCAtIDEgLyAzKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIHI6IHIgKiAyNTUsXG4gICAgICBnOiBnICogMjU1LFxuICAgICAgYjogYiAqIDI1NVxuICAgIH07XG4gIH07XG5cbiAgLypcbiAgQ29udmVydHMgYW4gUkdCIGNvbG9yIHZhbHVlIHRvIEhTVlxuICBcbiAgQG1ldGhvZCByZ2JUb0hzdlxuICBAcGFyYW0ge0ludGVnZXJ9IHIgaW4gMC4uMjU1IG9yIDAuLjFcbiAgQHBhcmFtIHtJbnRlZ2VyfSBnIGluIDAuLjI1NSBvciAwLi4xXG4gIEBwYXJhbSB7SW50ZWdlcn0gYiBpbiAwLi4yNTUgb3IgMC4uMVxuICBAcmV0dXJuIHtPYmplY3R9IHsgaCwgcywgdiB9IGluIDAuLjFcbiAgKi9cblxuXG4gIENvbG9yLnJnYlRvSHN2ID0gZnVuY3Rpb24ociwgZywgYikge1xuICAgIHZhciBkLCBoLCBtYXgsIG1pbiwgcywgdjtcbiAgICByID0gYm91bmQwMShyLCAyNTUpO1xuICAgIGcgPSBib3VuZDAxKGcsIDI1NSk7XG4gICAgYiA9IGJvdW5kMDEoYiwgMjU1KTtcbiAgICBtYXggPSBNYXRoLm1heChyLCBnLCBiKTtcbiAgICBtaW4gPSBNYXRoLm1pbihyLCBnLCBiKTtcbiAgICBoID0gdm9pZCAwO1xuICAgIHMgPSB2b2lkIDA7XG4gICAgdiA9IG1heDtcbiAgICBkID0gbWF4IC0gbWluO1xuICAgIHMgPSAobWF4ID09PSAwID8gMCA6IGQgLyBtYXgpO1xuICAgIGlmIChtYXggPT09IG1pbikge1xuICAgICAgaCA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHN3aXRjaCAobWF4KSB7XG4gICAgICAgIGNhc2UgcjpcbiAgICAgICAgICBoID0gKGcgLSBiKSAvIGQgKyAoZyA8IGIgPyA2IDogMCk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgZzpcbiAgICAgICAgICBoID0gKGIgLSByKSAvIGQgKyAyO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIGI6XG4gICAgICAgICAgaCA9IChyIC0gZykgLyBkICsgNDtcbiAgICAgIH1cbiAgICAgIGggLz0gNjtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGg6IGgsXG4gICAgICBzOiBzLFxuICAgICAgdjogdlxuICAgIH07XG4gIH07XG5cbiAgLypcbiAgQ29udmVydHMgYW4gSFNWIGNvbG9yIHZhbHVlIHRvIFJHQi5cbiAgXG4gIEBtZXRob2QgaHN2VG9SZ2JcbiAgQHBhcmFtIHtJbnRlZ2VyfSBoIGluIDAuLjM2MCBvciAwLi4xXG4gIEBwYXJhbSB7SW50ZWdlcn0gcyBpbiAwLi4xMDAgb3IgMC4uMVxuICBAcGFyYW0ge0ludGVnZXJ9IHYgaW4gMC4uMTAwIG9yIDAuLjFcbiAgQHJldHVybiB7T2JqZWN0fSB7IHIsIGcsIGIgfSBpbiAwLi4yNTVcbiAgKi9cblxuXG4gIENvbG9yLmhzdlRvUmdiID0gZnVuY3Rpb24oaCwgcywgdikge1xuICAgIHZhciBiLCBmLCBnLCBpLCBtb2QsIHAsIHEsIHIsIHQ7XG4gICAgaCA9IGJvdW5kMDEoaCwgMzYwKSAqIDY7XG4gICAgcyA9IGJvdW5kMDEocywgMTAwKTtcbiAgICB2ID0gYm91bmQwMSh2LCAxMDApO1xuICAgIGkgPSBNYXRoLmZsb29yKGgpO1xuICAgIGYgPSBoIC0gaTtcbiAgICBwID0gdiAqICgxIC0gcyk7XG4gICAgcSA9IHYgKiAoMSAtIGYgKiBzKTtcbiAgICB0ID0gdiAqICgxIC0gKDEgLSBmKSAqIHMpO1xuICAgIG1vZCA9IGkgJSA2O1xuICAgIHIgPSBbdiwgcSwgcCwgcCwgdCwgdl1bbW9kXTtcbiAgICBnID0gW3QsIHYsIHYsIHEsIHAsIHBdW21vZF07XG4gICAgYiA9IFtwLCBwLCB0LCB2LCB2LCBxXVttb2RdO1xuICAgIHJldHVybiB7XG4gICAgICByOiByICogMjU1LFxuICAgICAgZzogZyAqIDI1NSxcbiAgICAgIGI6IGIgKiAyNTVcbiAgICB9O1xuICB9O1xuXG4gIC8qXG4gIENvbnZlcnRzIGFuIFJHQiBjb2xvciB0byBoZXhcbiAgXG4gIEBtZXRob2QgcmdiVG9IZXhcbiAgQHBhcmFtIHtJbnRlZ2VyfSByIGluIDAuLjI1NVxuICBAcGFyYW0ge0ludGVnZXJ9IGcgaW4gMC4uMjU1XG4gIEBwYXJhbSB7SW50ZWdlcn0gYiBpbiAwLi4yNTVcbiAgQHBhcmFtIHtCb29sZWFufSBhbGxvdzNDaGFyXG4gIEByZXR1cm4ge1N0cmluZ30gMyBvciA2IGNoYXJhY3RlciBoZXhcbiAgKi9cblxuXG4gIENvbG9yLnJnYlRvSGV4ID0gZnVuY3Rpb24ociwgZywgYiwgYWxsb3czQ2hhcikge1xuICAgIHZhciBoZXg7XG4gICAgaWYgKGFsbG93M0NoYXIgPT0gbnVsbCkge1xuICAgICAgYWxsb3czQ2hhciA9IGZhbHNlO1xuICAgIH1cbiAgICBoZXggPSBbcGFkMihNYXRoLnJvdW5kKHIpLnRvU3RyaW5nKDE2KSksIHBhZDIoTWF0aC5yb3VuZChnKS50b1N0cmluZygxNikpLCBwYWQyKE1hdGgucm91bmQoYikudG9TdHJpbmcoMTYpKV07XG4gICAgaWYgKGFsbG93M0NoYXIgJiYgaGV4WzBdLmNoYXJBdCgwKSA9PT0gaGV4WzBdLmNoYXJBdCgxKSAmJiBoZXhbMV0uY2hhckF0KDApID09PSBoZXhbMV0uY2hhckF0KDEpICYmIGhleFsyXS5jaGFyQXQoMCkgPT09IGhleFsyXS5jaGFyQXQoMSkpIHtcbiAgICAgIHJldHVybiBoZXhbMF0uY2hhckF0KDApICsgaGV4WzFdLmNoYXJBdCgwKSArIGhleFsyXS5jaGFyQXQoMCk7XG4gICAgfVxuICAgIHJldHVybiBoZXguam9pbihcIlwiKTtcbiAgfTtcblxuICByZXR1cm4gQ29sb3I7XG5cbn0pKCk7XG5cbi8qXG5QZXJtaXNzaXZlIHN0cmluZyBwYXJzaW5nLiBUYWtlIGluIGEgbnVtYmVyIG9mIGZvcm1hdHMsIGFuZCBvdXRwdXQgYW4gb2JqZWN0XG5iYXNlZCBvbiBkZXRlY3RlZCBmb3JtYXQuXG5AbWV0aG9kIHN0cmluZ0lucHV0VG9PYmplY3RcbkBwYXJhbSB7U3RyaW5nIHwgQ29sb3J9IGNvbG9yXG5AcmV0dXJuIHtPYmplY3R9IGB7IHIsIGcsIGIgfWAgb3IgYHsgaCwgcywgbCB9YCBvciBgeyBoLCBzLCB2fWBcbiovXG5cblxuc3RyaW5nSW5wdXRUb09iamVjdCA9IGZ1bmN0aW9uKGNvbG9yKSB7XG4gIHZhciBtYXRjaCwgbmFtZWQ7XG4gIGNvbG9yID0gY29sb3IucmVwbGFjZSh0cmltTGVmdCwgXCJcIikucmVwbGFjZSh0cmltUmlnaHQsIFwiXCIpLnRvTG93ZXJDYXNlKCk7XG4gIG5hbWVkID0gZmFsc2U7XG4gIGlmIChDT0xPUl9OQU1FU1tjb2xvcl0pIHtcbiAgICBjb2xvciA9IENPTE9SX05BTUVTW2NvbG9yXTtcbiAgICBuYW1lZCA9IHRydWU7XG4gIH0gZWxzZSBpZiAoY29sb3IgPT09IFwidHJhbnNwYXJlbnRcIikge1xuICAgICh7XG4gICAgICByOiAwLFxuICAgICAgZzogMCxcbiAgICAgIGI6IDAsXG4gICAgICBhOiAwLFxuICAgICAgZm9ybWF0OiBcIm5hbWVcIlxuICAgIH0pO1xuICB9XG4gIG1hdGNoID0gdm9pZCAwO1xuICBpZiAobWF0Y2ggPSBtYXRjaGVycy5yZ2IuZXhlYyhjb2xvcikpIHtcbiAgICByZXR1cm4ge1xuICAgICAgcjogbWF0Y2hbMV0sXG4gICAgICBnOiBtYXRjaFsyXSxcbiAgICAgIGI6IG1hdGNoWzNdXG4gICAgfTtcbiAgfVxuICBpZiAobWF0Y2ggPSBtYXRjaGVycy5yZ2JhLmV4ZWMoY29sb3IpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHI6IG1hdGNoWzFdLFxuICAgICAgZzogbWF0Y2hbMl0sXG4gICAgICBiOiBtYXRjaFszXSxcbiAgICAgIGE6IG1hdGNoWzRdXG4gICAgfTtcbiAgfVxuICBpZiAobWF0Y2ggPSBtYXRjaGVycy5oc2wuZXhlYyhjb2xvcikpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaDogbWF0Y2hbMV0sXG4gICAgICBzOiBtYXRjaFsyXSxcbiAgICAgIGw6IG1hdGNoWzNdXG4gICAgfTtcbiAgfVxuICBpZiAobWF0Y2ggPSBtYXRjaGVycy5oc2xhLmV4ZWMoY29sb3IpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGg6IG1hdGNoWzFdLFxuICAgICAgczogbWF0Y2hbMl0sXG4gICAgICBsOiBtYXRjaFszXSxcbiAgICAgIGE6IG1hdGNoWzRdXG4gICAgfTtcbiAgfVxuICBpZiAobWF0Y2ggPSBtYXRjaGVycy5oc3YuZXhlYyhjb2xvcikpIHtcbiAgICByZXR1cm4ge1xuICAgICAgaDogbWF0Y2hbMV0sXG4gICAgICBzOiBtYXRjaFsyXSxcbiAgICAgIHY6IG1hdGNoWzNdXG4gICAgfTtcbiAgfVxuICBpZiAobWF0Y2ggPSBtYXRjaGVycy5oZXg2LmV4ZWMoY29sb3IpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHI6IHBhcnNlSGV4KG1hdGNoWzFdKSxcbiAgICAgIGc6IHBhcnNlSGV4KG1hdGNoWzJdKSxcbiAgICAgIGI6IHBhcnNlSGV4KG1hdGNoWzNdKSxcbiAgICAgIGZvcm1hdDogKG5hbWVkID8gXCJuYW1lXCIgOiBcImhleFwiKVxuICAgIH07XG4gIH1cbiAgaWYgKG1hdGNoID0gbWF0Y2hlcnMuaGV4My5leGVjKGNvbG9yKSkge1xuICAgIHJldHVybiB7XG4gICAgICByOiBwYXJzZUhleChtYXRjaFsxXSArIFwiXCIgKyBtYXRjaFsxXSksXG4gICAgICBnOiBwYXJzZUhleChtYXRjaFsyXSArIFwiXCIgKyBtYXRjaFsyXSksXG4gICAgICBiOiBwYXJzZUhleChtYXRjaFszXSArIFwiXCIgKyBtYXRjaFszXSksXG4gICAgICBmb3JtYXQ6IChuYW1lZCA/IFwibmFtZVwiIDogXCJoZXhcIilcbiAgICB9O1xuICB9XG4gIHJldHVybiBmYWxzZTtcbn07XG5cbkNvbG9yLmZyb21SYXRpbyA9IGZ1bmN0aW9uKGNvbG9yLCBvcHRzKSB7XG4gIHZhciBpLCBuZXdDb2xvcjtcbiAgaWYgKG9wdHMgPT0gbnVsbCkge1xuICAgIG9wdHMgPSB7fTtcbiAgfVxuICBpZiAodHlwZW9mIGNvbG9yID09PSBcIm9iamVjdFwiKSB7XG4gICAgbmV3Q29sb3IgPSB7fTtcbiAgICBmb3IgKGkgaW4gY29sb3IpIHtcbiAgICAgIGlmIChjb2xvci5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICBpZiAoaSA9PT0gXCJhXCIpIHtcbiAgICAgICAgICBuZXdDb2xvcltpXSA9IGNvbG9yW2ldO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld0NvbG9yW2ldID0gY29udmVydFRvUGVyY2VudGFnZShjb2xvcltpXSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgY29sb3IgPSBuZXdDb2xvcjtcbiAgfVxuICByZXR1cm4gbmV3IENvbG9yKGNvbG9yLCBvcHRzKTtcbn07XG5cbkNvbG9yLmVxdWFscyA9IGZ1bmN0aW9uKGNvbG9yMSwgY29sb3IyKSB7XG4gIGlmICghY29sb3IxIHx8ICFjb2xvcjIpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIChuZXcgQ29sb3IoY29sb3IxKSkudG9SZ2JTdHJpbmcoKSA9PT0gKG5ldyBDb2xvcihjb2xvcjIpKS50b1JnYlN0cmluZygpO1xufTtcblxuQ29sb3IucmFuZG9tID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBDb2xvci5mcm9tUmF0aW8oe1xuICAgIHI6IE1hdGgucmFuZG9tKCksXG4gICAgZzogTWF0aC5yYW5kb20oKSxcbiAgICBiOiBNYXRoLnJhbmRvbSgpXG4gIH0pO1xufTtcblxuQ29sb3IuZGVzYXR1cmF0ZSA9IGZ1bmN0aW9uKGNvbG9yLCBhbW91bnQpIHtcbiAgdmFyIGhzbDtcbiAgaWYgKGFtb3VudCA9PSBudWxsKSB7XG4gICAgYW1vdW50ID0gMTA7XG4gIH1cbiAgaHNsID0gKG5ldyBDb2xvcihjb2xvcikpLnRvSHNsKCk7XG4gIGhzbC5zIC09IGFtb3VudCAvIDEwMDtcbiAgaHNsLnMgPSBNYXRoZW1hdGljLmNsYW1wMDEoaHNsLnMpO1xuICByZXR1cm4gbmV3IENvbG9yKGhzbCk7XG59O1xuXG5Db2xvci5zYXR1cmF0ZSA9IGZ1bmN0aW9uKGNvbG9yLCBhbW91bnQpIHtcbiAgdmFyIGhzbDtcbiAgaWYgKGFtb3VudCA9PSBudWxsKSB7XG4gICAgYW1vdW50ID0gMTA7XG4gIH1cbiAgaHNsID0gKG5ldyBDb2xvcihjb2xvcikpLnRvSHNsKCk7XG4gIGhzbC5zICs9IGFtb3VudCAvIDEwMDtcbiAgaHNsLnMgPSBNYXRoZW1hdGljLmNsYW1wMDEoaHNsLnMpO1xuICByZXR1cm4gbmV3IENvbG9yKGhzbCk7XG59O1xuXG5Db2xvci5ncmV5c2NhbGUgPSBmdW5jdGlvbihjb2xvcikge1xuICByZXR1cm4gQ29sb3IuZGVzYXR1cmF0ZShjb2xvciwgMTAwKTtcbn07XG5cbkNvbG9yLmxpZ2h0ZW4gPSBmdW5jdGlvbihjb2xvciwgYW1vdW50KSB7XG4gIHZhciBoc2w7XG4gIGlmIChhbW91bnQgPT0gbnVsbCkge1xuICAgIGFtb3VudCA9IDEwO1xuICB9XG4gIGhzbCA9IChuZXcgQ29sb3IoY29sb3IpKS50b0hzbCgpO1xuICBoc2wubCArPSBhbW91bnQgLyAxMDA7XG4gIGhzbC5sID0gTWF0aGVtYXRpYy5jbGFtcDAxKGhzbC5sKTtcbiAgcmV0dXJuIG5ldyBDb2xvcihoc2wpO1xufTtcblxuQ29sb3IuZGFya2VuID0gZnVuY3Rpb24oY29sb3IsIGFtb3VudCkge1xuICB2YXIgaHNsO1xuICBpZiAoYW1vdW50ID09IG51bGwpIHtcbiAgICBhbW91bnQgPSAxMDtcbiAgfVxuICBoc2wgPSAobmV3IENvbG9yKGNvbG9yKSkudG9Ic2woKTtcbiAgaHNsLmwgLT0gYW1vdW50IC8gMTAwO1xuICBoc2wubCA9IE1hdGhlbWF0aWMuY2xhbXAwMShoc2wubCk7XG4gIHJldHVybiBuZXcgQ29sb3IoaHNsKTtcbn07XG5cbkNvbG9yLmNvbXBsZW1lbnQgPSBmdW5jdGlvbihjb2xvcikge1xuICB2YXIgaHNsO1xuICBoc2wgPSAobmV3IENvbG9yKGNvbG9yKSkudG9Ic2woKTtcbiAgaHNsLmggPSAoaHNsLmggKyAxODApICUgMzYwO1xuICByZXR1cm4gbmV3IENvbG9yKGhzbCk7XG59O1xuXG5Db2xvci50cmlhZCA9IGZ1bmN0aW9uKGNvbG9yKSB7XG4gIHZhciBoLCBoc2w7XG4gIGhzbCA9IChuZXcgQ29sb3IoY29sb3IpKS50b0hzbCgpO1xuICBoID0gaHNsLmg7XG4gIHJldHVybiBbXG4gICAgbmV3IENvbG9yKGNvbG9yKSwgbmV3IENvbG9yKHtcbiAgICAgIGg6IChoICsgMTIwKSAlIDM2MCxcbiAgICAgIHM6IGhzbC5zLFxuICAgICAgbDogaHNsLmxcbiAgICB9KSwgbmV3IENvbG9yKHtcbiAgICAgIGg6IChoICsgMjQwKSAlIDM2MCxcbiAgICAgIHM6IGhzbC5zLFxuICAgICAgbDogaHNsLmxcbiAgICB9KVxuICBdO1xufTtcblxuQ29sb3IudGV0cmFkID0gZnVuY3Rpb24oY29sb3IpIHtcbiAgdmFyIGgsIGhzbDtcbiAgaHNsID0gKG5ldyBDb2xvcihjb2xvcikpLnRvSHNsKCk7XG4gIGggPSBoc2wuaDtcbiAgcmV0dXJuIFtcbiAgICBuZXcgQ29sb3IoY29sb3IpLCBuZXcgQ29sb3Ioe1xuICAgICAgaDogKGggKyA5MCkgJSAzNjAsXG4gICAgICBzOiBoc2wucyxcbiAgICAgIGw6IGhzbC5sXG4gICAgfSksIG5ldyBDb2xvcih7XG4gICAgICBoOiAoaCArIDE4MCkgJSAzNjAsXG4gICAgICBzOiBoc2wucyxcbiAgICAgIGw6IGhzbC5sXG4gICAgfSksIG5ldyBDb2xvcih7XG4gICAgICBoOiAoaCArIDI3MCkgJSAzNjAsXG4gICAgICBzOiBoc2wucyxcbiAgICAgIGw6IGhzbC5sXG4gICAgfSlcbiAgXTtcbn07XG5cbkNvbG9yLnNwbGl0Y29tcGxlbWVudCA9IGZ1bmN0aW9uKGNvbG9yKSB7XG4gIHZhciBoLCBoc2w7XG4gIGhzbCA9IChuZXcgQ29sb3IoY29sb3IpKS50b0hzbCgpO1xuICBoID0gaHNsLmg7XG4gIHJldHVybiBbXG4gICAgbmV3IENvbG9yKGNvbG9yKSwgbmV3IENvbG9yKHtcbiAgICAgIGg6IChoICsgNzIpICUgMzYwLFxuICAgICAgczogaHNsLnMsXG4gICAgICBsOiBoc2wubFxuICAgIH0pLCBuZXcgQ29sb3Ioe1xuICAgICAgaDogKGggKyAyMTYpICUgMzYwLFxuICAgICAgczogaHNsLnMsXG4gICAgICBsOiBoc2wubFxuICAgIH0pXG4gIF07XG59O1xuXG5Db2xvci5hbmFsb2dvdXMgPSBmdW5jdGlvbihjb2xvciwgcmVzdWx0cywgc2xpY2VzKSB7XG4gIHZhciBoc2wsIHBhcnQsIHJldDtcbiAgaWYgKHJlc3VsdHMgPT0gbnVsbCkge1xuICAgIHJlc3VsdHMgPSA2O1xuICB9XG4gIGlmIChzbGljZXMgPT0gbnVsbCkge1xuICAgIHNsaWNlcyA9IDMwO1xuICB9XG4gIGhzbCA9IChuZXcgQ29sb3IoY29sb3IpKS50b0hzbCgpO1xuICBwYXJ0ID0gMzYwIC8gc2xpY2VzO1xuICByZXQgPSBbbmV3IENvbG9yKGNvbG9yKV07XG4gIGhzbC5oID0gKChoc2wuaCAtIChwYXJ0ICogcmVzdWx0cyA+PiAxKSkgKyA3MjApICUgMzYwO1xuICB3aGlsZSAoLS1yZXN1bHRzKSB7XG4gICAgaHNsLmggPSAoaHNsLmggKyBwYXJ0KSAlIDM2MDtcbiAgICByZXQucHVzaChuZXcgQ29sb3IoaHNsKSk7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn07XG5cbkNvbG9yLm1vbm9jaHJvbWF0aWMgPSBmdW5jdGlvbihjb2xvciwgcmVzdWx0cykge1xuICB2YXIgaCwgaHN2LCBtb2RpZmljYXRpb24sIHJldCwgcywgdjtcbiAgaWYgKHJlc3VsdHMgPT0gbnVsbCkge1xuICAgIHJlc3VsdHMgPSA2O1xuICB9XG4gIGhzdiA9IChuZXcgQ29sb3IoY29sb3IpKS50b0hzdigpO1xuICBoID0gaHN2Lmg7XG4gIHMgPSBoc3YucztcbiAgdiA9IGhzdi52O1xuICByZXQgPSBbXTtcbiAgbW9kaWZpY2F0aW9uID0gMSAvIHJlc3VsdHM7XG4gIHdoaWxlIChyZXN1bHRzLS0pIHtcbiAgICByZXQucHVzaChDb2xvcih7XG4gICAgICBoOiBoLFxuICAgICAgczogcyxcbiAgICAgIHY6IHZcbiAgICB9KSk7XG4gICAgdiA9ICh2ICsgbW9kaWZpY2F0aW9uKSAlIDE7XG4gIH1cbiAgcmV0dXJuIHJldDtcbn07XG5cbkNvbG9yLnJlYWRhYmlsaXR5ID0gZnVuY3Rpb24oY29sb3IxLCBjb2xvcjIpIHtcbiAgdmFyIGEsIGIsIGJyaWdodG5lc3NBLCBicmlnaHRuZXNzQiwgY29sb3JEaWZmO1xuICBhID0gKG5ldyBDb2xvcihjb2xvcjEpKS50b1JnYigpO1xuICBiID0gKG5ldyBDb2xvcihjb2xvcjIpKS50b1JnYigpO1xuICBicmlnaHRuZXNzQSA9IChhLnIgKiAyOTkgKyBhLmcgKiA1ODcgKyBhLmIgKiAxMTQpIC8gMTAwMDtcbiAgYnJpZ2h0bmVzc0IgPSAoYi5yICogMjk5ICsgYi5nICogNTg3ICsgYi5iICogMTE0KSAvIDEwMDA7XG4gIGNvbG9yRGlmZiA9IE1hdGgubWF4KGEuciwgYi5yKSAtIE1hdGgubWluKGEuciwgYi5yKSArIE1hdGgubWF4KGEuZywgYi5nKSAtIE1hdGgubWluKGEuZywgYi5nKSArIE1hdGgubWF4KGEuYiwgYi5iKSAtIE1hdGgubWluKGEuYiwgYi5iKTtcbiAgcmV0dXJuIHtcbiAgICBicmlnaHRuZXNzOiBNYXRoLmFicyhicmlnaHRuZXNzQSAtIGJyaWdodG5lc3NCKSxcbiAgICBjb2xvcjogY29sb3JEaWZmXG4gIH07XG59O1xuXG5Db2xvci5yZWFkYWJsZSA9IGZ1bmN0aW9uKGNvbG9yMSwgY29sb3IyKSB7XG4gIHZhciByZWFkYWJpbGl0eTtcbiAgcmVhZGFiaWxpdHkgPSBDb2xvci5yZWFkYWJpbGl0eShjb2xvcjEsIGNvbG9yMik7XG4gIHJldHVybiByZWFkYWJpbGl0eS5icmlnaHRuZXNzID4gMTI1ICYmIHJlYWRhYmlsaXR5LmNvbG9yID4gNTAwO1xufTtcblxuQ29sb3IubW9zdFJlYWRhYmxlID0gZnVuY3Rpb24oYmFzZUNvbG9yLCBjb2xvckxpc3QpIHtcbiAgdmFyIGJlc3RDb2xvciwgYmVzdElzUmVhZGFibGUsIGJlc3RTY29yZSwgaSwgcmVhZGFiaWxpdHksIHJlYWRhYmxlLCBzY29yZTtcbiAgYmVzdENvbG9yID0gbnVsbDtcbiAgYmVzdFNjb3JlID0gMDtcbiAgYmVzdElzUmVhZGFibGUgPSBmYWxzZTtcbiAgaSA9IDA7XG4gIHdoaWxlIChpIDwgY29sb3JMaXN0Lmxlbmd0aCkge1xuICAgIHJlYWRhYmlsaXR5ID0gQ29sb3IucmVhZGFiaWxpdHkoYmFzZUNvbG9yLCBjb2xvckxpc3RbaV0pO1xuICAgIHJlYWRhYmxlID0gcmVhZGFiaWxpdHkuYnJpZ2h0bmVzcyA+IDEyNSAmJiByZWFkYWJpbGl0eS5jb2xvciA+IDUwMDtcbiAgICBzY29yZSA9IDMgKiAocmVhZGFiaWxpdHkuYnJpZ2h0bmVzcyAvIDEyNSkgKyAocmVhZGFiaWxpdHkuY29sb3IgLyA1MDApO1xuICAgIGlmICgocmVhZGFibGUgJiYgIWJlc3RJc1JlYWRhYmxlKSB8fCAocmVhZGFibGUgJiYgYmVzdElzUmVhZGFibGUgJiYgc2NvcmUgPiBiZXN0U2NvcmUpIHx8ICgoIXJlYWRhYmxlKSAmJiAoIWJlc3RJc1JlYWRhYmxlKSAmJiBzY29yZSA+IGJlc3RTY29yZSkpIHtcbiAgICAgIGJlc3RJc1JlYWRhYmxlID0gcmVhZGFibGU7XG4gICAgICBiZXN0U2NvcmUgPSBzY29yZTtcbiAgICAgIGJlc3RDb2xvciA9IG5ldyBDb2xvcihjb2xvckxpc3RbaV0pO1xuICAgIH1cbiAgICBpKys7XG4gIH1cbiAgcmV0dXJuIGJlc3RDb2xvcjtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQ29sb3I7XG5cbi8qXG4vL0Agc291cmNlTWFwcGluZ1VSTD1jb2xvci5tYXBcbiovXG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4zXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgQ29sb3I6IHJlcXVpcmUoXCIuL2NvbG9yXCIpLFxuICBGb250OiByZXF1aXJlKFwiLi9mb250XCIpXG59O1xuXG4vKlxuLy9AIHNvdXJjZU1hcHBpbmdVUkw9ZXhwb3J0cy5tYXBcbiovXG4iLCIvLyBHZW5lcmF0ZWQgYnkgQ29mZmVlU2NyaXB0IDEuNi4zXG4vKlxuSW5zcGlyZWQgYnkgRm9udC5qcyBieSAgTWlrZSBcIlBvbWF4XCIgS2FtZXJtYW5zXG5Ac2VlIGh0dHA6Ly9naXRodWIuY29tL1BvbWF4L0ZvbnQuanNcbiovXG5cbnZhciBGT05UX0NBQ0hFLCBGb250LCBNYXRobWV0aWNzO1xuXG5NYXRobWV0aWNzID0gcmVxdWlyZShcIi4uL21hdGgvbWF0aFwiKTtcblxuRk9OVF9DQUNIRSA9IHt9O1xuXG4vKlxuRm9udCBtYW5pcHVsYXRpb25zIGFuZCBtZWFzdXJlbWVudFxuXG5Abm90ZSBHYW1lQ29yZS5leHBvcnRzLlV0aWxzLkZvbnRcbiovXG5cblxuRm9udCA9IChmdW5jdGlvbigpIHtcbiAgZnVuY3Rpb24gRm9udCgpIHtcbiAgICB0aGlzLmZvbnRGYW1pbHkgPSBcImZvbnRcIiArIE1hdGhtZXRpY3MucmFuZG9tSW50KDAsIDk5OTk5OSk7XG4gIH1cblxuICByZXR1cm4gRm9udDtcblxufSkoKTtcblxuLypcbi8vQCBzb3VyY2VNYXBwaW5nVVJMPWZvbnQubWFwXG4qL1xuIl19
;